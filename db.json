{"meta":{"version":1,"warehouse":"2.2.0"},"models":{"Asset":[{"_id":"source/images/github-commits.png","path":"images/github-commits.png","modified":0,"renderable":0},{"_id":"themes/typing/source/css/source.css","path":"css/source.css","modified":0,"renderable":1},{"_id":"themes/typing/source/fancybox/blank.gif","path":"fancybox/blank.gif","modified":0,"renderable":1},{"_id":"themes/typing/source/js/typing.js","path":"js/typing.js","modified":0,"renderable":1},{"_id":"themes/typing/source/css/typing.css","path":"css/typing.css","modified":0,"renderable":1},{"_id":"themes/typing/source/fancybox/fancybox_overlay.png","path":"fancybox/fancybox_overlay.png","modified":0,"renderable":1},{"_id":"themes/typing/source/fancybox/fancybox_loading.gif","path":"fancybox/fancybox_loading.gif","modified":0,"renderable":1},{"_id":"themes/typing/source/fancybox/fancybox_sprite.png","path":"fancybox/fancybox_sprite.png","modified":0,"renderable":1},{"_id":"themes/typing/source/fancybox/fancybox_loading@2x.gif","path":"fancybox/fancybox_loading@2x.gif","modified":0,"renderable":1},{"_id":"themes/typing/source/fancybox/fancybox_sprite@2x.png","path":"fancybox/fancybox_sprite@2x.png","modified":0,"renderable":1},{"_id":"themes/typing/source/fancybox/jquery.fancybox.css","path":"fancybox/jquery.fancybox.css","modified":0,"renderable":1},{"_id":"themes/typing/source/fancybox/jquery.fancybox.pack.js","path":"fancybox/jquery.fancybox.pack.js","modified":0,"renderable":1},{"_id":"themes/typing/source/fancybox/jquery.fancybox.js","path":"fancybox/jquery.fancybox.js","modified":0,"renderable":1},{"_id":"themes/typing/source/fancybox/helpers/jquery.fancybox-buttons.css","path":"fancybox/helpers/jquery.fancybox-buttons.css","modified":0,"renderable":1},{"_id":"themes/typing/source/fancybox/helpers/fancybox_buttons.png","path":"fancybox/helpers/fancybox_buttons.png","modified":0,"renderable":1},{"_id":"themes/typing/source/fancybox/helpers/jquery.fancybox-buttons.js","path":"fancybox/helpers/jquery.fancybox-buttons.js","modified":0,"renderable":1},{"_id":"themes/typing/source/fancybox/helpers/jquery.fancybox-media.js","path":"fancybox/helpers/jquery.fancybox-media.js","modified":0,"renderable":1},{"_id":"themes/typing/source/fancybox/helpers/jquery.fancybox-thumbs.css","path":"fancybox/helpers/jquery.fancybox-thumbs.css","modified":0,"renderable":1},{"_id":"themes/typing/source/fancybox/helpers/jquery.fancybox-thumbs.js","path":"fancybox/helpers/jquery.fancybox-thumbs.js","modified":0,"renderable":1}],"Cache":[{"_id":"themes/typing/LICENSE","hash":"e4bf48251989dd666899d2d22b351b8db4764992","modified":1479275139000},{"_id":"themes/typing/README.md","hash":"c439580128aa5dda19e06db9f25f1e37f286063a","modified":1479275139000},{"_id":"themes/typing/_config.yml","hash":"299fa6819b9f0fc01170c8e70ba70e752a382d80","modified":1478769920000},{"_id":"themes/typing/makefile","hash":"5c63c52a6c85ce3d88ad41d4772f228899c1f504","modified":1479275139000},{"_id":"themes/typing/package.json","hash":"262a12df885c9eb894560d7f0cf7ca6315821953","modified":1479275139000},{"_id":"source/_posts/.Ulysses-Group.plist","hash":"e9130f5581fcbc18cd203de33148dd4e9a1b9ab5","modified":1481115234000},{"_id":"source/_posts/.Ulysses-favorites.plist","hash":"37829bb1864d5ed0da879929024e84ea638b3c0a","modified":1481115234000},{"_id":"source/_posts/ä¸‡åœ£èŠ‚ä¸‹çš„github.md","hash":"4f3e90a887ff7dbd581dc903245cead1a6a4f997","modified":1482818984000},{"_id":"source/_posts/git-diffä½¿ç”¨.md","hash":"2990019226b435229fcee31550440f6e662b4617","modified":1479274800000},{"_id":"source/_posts/ä¸€ä¸ªæœ‰è¶£çš„thisæŒ‡å‘é—®é¢˜.md","hash":"bab318a2c399ec3c3bd7d2e282b2257491c70e0c","modified":1479274800000},{"_id":"source/_posts/JavaScript-Array-sort.md","hash":"ff4ce8796790aa4b73c7fbf8693bc4ffa3bb7e1e","modified":1481115236000},{"_id":"source/_posts/vimå¯åŠ¨å¤±è´¥.md","hash":"67e69593170f358db2fbd56e3da13058a016dbb8","modified":1479274800000},{"_id":"source/images/github-commits.png","hash":"4d3d06878f58d72faecb540aefadd44050a8fbf9","modified":1482029623000},{"_id":"source/_posts/æŸ¯é‡ŒåŒ–çš„æ„ä¹‰.md","hash":"a0654751662b0b15e695345119a9d36691ab963c","modified":1479274800000},{"_id":"source/_posts/ä»€ä¹ˆæ˜¯æ¨¡å—.md","hash":"fdbf0d01a30608349d0d01eed9ed8d99dc89f448","modified":1479274800000},{"_id":"themes/typing/layout/layout.ejs","hash":"595a9150e0184ae221589ca6b454f3a9475591c6","modified":1481433106000},{"_id":"themes/typing/layout/index.ejs","hash":"18aaf3d920f7cae080932a909640754d69bbee1b","modified":1479275139000},{"_id":"themes/typing/layout/archive.ejs","hash":"1326b972ea3dcdc23a453e3c61709ffe561ed931","modified":1479275139000},{"_id":"themes/typing/layout/category.ejs","hash":"a6f14dc7f869d6cd0663fef8747c708cdbb18fe7","modified":1479275139000},{"_id":"themes/typing/languages/default.yml","hash":"bd8e9329c5636b85bc554b76f06830269869864d","modified":1479275139000},{"_id":"themes/typing/layout/post.ejs","hash":"a05fd1a27e1c54c9dbab9e69a257a299b0f549cc","modified":1479275139000},{"_id":"themes/typing/layout/tag.ejs","hash":"b9558a0789e3549d6bbcaf86544af9bd3a7a472a","modified":1479275139000},{"_id":"themes/typing/layout/page.ejs","hash":"a05fd1a27e1c54c9dbab9e69a257a299b0f549cc","modified":1479275139000},{"_id":"themes/typing/languages/fr.yml","hash":"559b094ef6b9d02506c33044be8b50ebeda28a70","modified":1479275139000},{"_id":"themes/typing/languages/ru.yml","hash":"3d45b446862c8a305823533b868556f6111308fe","modified":1479275139000},{"_id":"themes/typing/languages/es.yml","hash":"23dc21c62927062829e31fcfd6c5d2c7e9257844","modified":1479275139000},{"_id":"themes/typing/languages/nl.yml","hash":"95fc8003c34e1353f73f6315291d0cb10b5d7e73","modified":1479275139000},{"_id":"themes/typing/languages/no.yml","hash":"53ba8ffd6353262138016bd1b4c3a65a113e6c52","modified":1479275139000},{"_id":"themes/typing/languages/zh-CN.yml","hash":"4f227318cce98303496e423d85de28b79fb01f00","modified":1479275139000},{"_id":"themes/typing/languages/zh-TW.yml","hash":"b68f12091eeae30b56847997d059f5ce29f086ac","modified":1479275139000},{"_id":"themes/typing/preview/preview.png","hash":"33b39c8a626db45ee473ce3e3d0e37ebd9fb83d3","modified":1479275139000},{"_id":"themes/typing/source/css/source.css","hash":"93078434d298038b963c165b31a497cc517b0baf","modified":1479275139000},{"_id":"themes/typing/source/fancybox/blank.gif","hash":"2daeaa8b5f19f0bc209d976c02bd6acb51b00b0a","modified":1479275139000},{"_id":"themes/typing/source/js/typing.js","hash":"e1de54745c5df13cc207ca4bd2e4e02b2e5a31be","modified":1479275139000},{"_id":"themes/typing/source/css/typing.css","hash":"eab2f172f9fb44d460babc971b42dca92eef3e3b","modified":1479275139000},{"_id":"themes/typing/source/fancybox/fancybox_overlay.png","hash":"b3a4ee645ba494f52840ef8412015ba0f465dbe0","modified":1479275139000},{"_id":"themes/typing/source/fancybox/fancybox_loading.gif","hash":"1a755fb2599f3a313cc6cfdb14df043f8c14a99c","modified":1479275139000},{"_id":"themes/typing/source/fancybox/fancybox_sprite.png","hash":"17df19f97628e77be09c352bf27425faea248251","modified":1479275139000},{"_id":"themes/typing/source/fancybox/fancybox_loading@2x.gif","hash":"273b123496a42ba45c3416adb027cd99745058b0","modified":1479275139000},{"_id":"themes/typing/source/fancybox/fancybox_sprite@2x.png","hash":"30c58913f327e28f466a00f4c1ac8001b560aed8","modified":1479275139000},{"_id":"themes/typing/source/fancybox/jquery.fancybox.css","hash":"aaa582fb9eb4b7092dc69fcb2d5b1c20cca58ab6","modified":1479275139000},{"_id":"themes/typing/source/fancybox/jquery.fancybox.pack.js","hash":"9e0d51ca1dbe66f6c0c7aefd552dc8122e694a6e","modified":1479275139000},{"_id":"themes/typing/layout/_partial/archive.ejs","hash":"9665ed77377c8eb15d94c04a33905d26704f2e13","modified":1479275139000},{"_id":"themes/typing/layout/_partial/archive-post.ejs","hash":"877b0b79538a63f1ae73407e372ee041f8b65e1b","modified":1479275139000},{"_id":"themes/typing/source/fancybox/jquery.fancybox.js","hash":"d08b03a42d5c4ba456ef8ba33116fdbb7a9cabed","modified":1479275139000},{"_id":"themes/typing/layout/_partial/after-footer.ejs","hash":"7737fd36dffa21abdc1894413d4063d36edba5e7","modified":1479275139000},{"_id":"themes/typing/layout/_partial/google-analytics.ejs","hash":"f921e7f9223d7c95165e0f835f353b2938e40c45","modified":1479275139000},{"_id":"themes/typing/layout/_partial/article.ejs","hash":"a7b3a3c51f8b089c752f475c2cb393d3fa73c010","modified":1479275139000},{"_id":"themes/typing/layout/_partial/gauges-analytics.ejs","hash":"aad6312ac197d6c5aaf2104ac863d7eba46b772a","modified":1479275139000},{"_id":"themes/typing/layout/_partial/baidu_tongji.ejs","hash":"998936b5bf3fcef3b2de5e21fe24e956afa43f59","modified":1479275139000},{"_id":"themes/typing/layout/_partial/head.ejs","hash":"04133fd540fb4af025b57dcc9032c4b3db6058e4","modified":1479275139000},{"_id":"themes/typing/layout/_partial/header.ejs","hash":"6c23f09fc807e2b3779d5f252503fd60edb77892","modified":1485698319000},{"_id":"themes/typing/layout/_partial/footer.ejs","hash":"9562eeb5a57d0a5115329f28f2fa0044c63f71f6","modified":1485698268000},{"_id":"themes/typing/source/fancybox/helpers/jquery.fancybox-buttons.css","hash":"1a9d8e5c22b371fcc69d4dbbb823d9c39f04c0c8","modified":1479275139000},{"_id":"themes/typing/source/fancybox/helpers/fancybox_buttons.png","hash":"e385b139516c6813dcd64b8fc431c364ceafe5f3","modified":1479275139000},{"_id":"themes/typing/source/fancybox/helpers/jquery.fancybox-buttons.js","hash":"dc3645529a4bf72983a39fa34c1eb9146e082019","modified":1479275139000},{"_id":"themes/typing/source/fancybox/helpers/jquery.fancybox-media.js","hash":"294420f9ff20f4e3584d212b0c262a00a96ecdb3","modified":1479275139000},{"_id":"themes/typing/source/fancybox/helpers/jquery.fancybox-thumbs.css","hash":"4ac329c16a5277592fc12a37cca3d72ca4ec292f","modified":1479275139000},{"_id":"themes/typing/source/fancybox/helpers/jquery.fancybox-thumbs.js","hash":"47da1ae5401c24b5c17cc18e2730780f5c1a7a0c","modified":1479275139000},{"_id":"themes/typing/layout/_partial/post/date.ejs","hash":"38affd429d5ed376b349219f3094a7d530c58a70","modified":1479275139000},{"_id":"themes/typing/layout/_partial/post/gallery.ejs","hash":"3d9d81a3c693ff2378ef06ddb6810254e509de5b","modified":1479275139000},{"_id":"themes/typing/layout/_partial/post/category.ejs","hash":"6cd9c85b105db04a74678d0a6c5440e51d9d84f7","modified":1479275139000},{"_id":"themes/typing/layout/_partial/post/nav.ejs","hash":"93e594128978c0e7310c9aef3e150effbf549f0e","modified":1479275139000},{"_id":"themes/typing/layout/_partial/post/tag.ejs","hash":"90209686eabc6c3e7a6a7ef2defd0b84611d9f41","modified":1479275139000},{"_id":"themes/typing/layout/_partial/post/title.ejs","hash":"2f275739b6f1193c123646a5a31f37d48644c667","modified":1479275139000},{"_id":"public/2016/10/09/git-diffä½¿ç”¨/index.html","hash":"2e9fc0ff1b93df6055b7158c0219f710b6da5d3c","modified":1485698368744},{"_id":"public/archives/index.html","hash":"06471d79747c26383ceaed38cfa463a2e4b67425","modified":1485698368745},{"_id":"public/2016/07/27/ä¸€ä¸ªæœ‰è¶£çš„thisæŒ‡å‘é—®é¢˜/index.html","hash":"b83ffbf9fd290aa5e90db79e56acecccec41b9d2","modified":1485698368745},{"_id":"public/2016/06/15/vimå¯åŠ¨å¤±è´¥/index.html","hash":"0e2caa7cb938edad291f140bce72a0fbc31582be","modified":1485698368745},{"_id":"public/2016/11/12/æŸ¯é‡ŒåŒ–çš„æ„ä¹‰/index.html","hash":"02ff8f566e989c72be0fa52075f1d3b6e3a54149","modified":1485698368747},{"_id":"public/2016/11/07/ä»€ä¹ˆæ˜¯æ¨¡å—/index.html","hash":"3cc0b96060e06eefd45859f990aca2d466dc554c","modified":1485698368746},{"_id":"public/2016/12/18/ä¸‡åœ£èŠ‚ä¸‹çš„github/index.html","hash":"2ad59caf88fbf247f788b13c375f69ead5d4c084","modified":1485698368745},{"_id":"public/2016/11/25/JavaScript-Array-sort/index.html","hash":"7d6d11ffaef626c8019254cf4c3b4f9156dacef1","modified":1485698368744},{"_id":"public/archives/2016/index.html","hash":"ec22f8f2c02740701bca33b47e8e34dea284a806","modified":1485698368745},{"_id":"public/archives/2016/10/index.html","hash":"60a1ec603e43dec9c4eed68ff7d67a4742f01cdb","modified":1485698368745},{"_id":"public/archives/2016/06/index.html","hash":"acad20638d18c7a07e1936e0c9fd65eb33f1058e","modified":1485698368745},{"_id":"public/archives/2016/11/index.html","hash":"ef299f99503c5eff63486ecd6f7e72a3c575057d","modified":1485698368745},{"_id":"public/index.html","hash":"be01bc938f21c09cd93eda30294b494bdf87a930","modified":1485698368746},{"_id":"public/archives/2016/07/index.html","hash":"ef1fcaaa98b7dcb8e2c08f368e2a5146bed219a2","modified":1485698368746},{"_id":"public/archives/2016/12/index.html","hash":"bc8651f5cb1aad69005fb2bfb7de839892de8b65","modified":1485698368746},{"_id":"public/images/github-commits.png","hash":"4d3d06878f58d72faecb540aefadd44050a8fbf9","modified":1485693423224},{"_id":"source/.DS_Store","hash":"b48c4f7d61a5928be717d4bd654481ff1eab36ee","modified":1485163607000},{"_id":"themes/typing/.gitignore","hash":"d83e98433e68316c1ba1260e46463447ad71aaa1","modified":1475108186000},{"_id":"source/_drafts/redisæ“ä½œä¸­çš„åŸå­æ€§é—®é¢˜.md","hash":"d61d14317a527c018b3616dc5eb55612c6af9b1f","modified":1485256247000},{"_id":"source/_drafts/ä¸“æ³¨ä¸€ç‚¹.md","hash":"32a46063c27b8371177a5dbefd5614d2950dcf4f","modified":1485399548000},{"_id":"source/_posts/é¢è¯•ä¸­çš„é—®é¢˜.md","hash":"8156083c67184d22b8e1ef87aa9a5e6cd99f22fb","modified":1485693102000},{"_id":"public/2017/01/29/é¢è¯•ä¸­çš„é—®é¢˜/index.html","hash":"65af4e9bfd1841d4458dc0be4a4df0fbc149f7a7","modified":1485698368747},{"_id":"public/archives/2017/01/index.html","hash":"019dad1e10ad4391e6223e29106f181020e5c8f5","modified":1485698368745},{"_id":"public/archives/2017/index.html","hash":"af063098a7c9de110dd93da26e2114441f4f7f67","modified":1485698368746},{"_id":"themes/typing/layout/_partial/.header.ejs.swp","hash":"77f80decfdd54ae23f97eb9da80db1b702075e57","modified":1485698144000},{"_id":"public/atom.xml","hash":"a425a6897230b132c9a833ce4aebcdf89278596a","modified":1485698368746}],"Category":[],"Data":[],"Page":[],"Post":[{"title":"ä¸‡åœ£èŠ‚ä¸‹çš„github","date":"2016-12-18T02:50:10.000Z","_content":"\n![](/images/github-commits.png)\n\næ˜¨å¤©èµ·å…¬å¸ä¸å†ä½¿ç”¨githubåšä»£ç æ‰˜ç®¡ï¼Œè°¨ä»¥ä¸‡åœ£èŠ‚ä¸‹çš„è¿™å¼ æˆªå›¾åˆå½±ç•™å¿µã€‚\n","source":"_posts/ä¸‡åœ£èŠ‚ä¸‹çš„github.md","raw":"---\ntitle: ä¸‡åœ£èŠ‚ä¸‹çš„github\ndate: 2016-12-18 10:50:10\ntags:\n---\n\n![](/images/github-commits.png)\n\næ˜¨å¤©èµ·å…¬å¸ä¸å†ä½¿ç”¨githubåšä»£ç æ‰˜ç®¡ï¼Œè°¨ä»¥ä¸‡åœ£èŠ‚ä¸‹çš„è¿™å¼ æˆªå›¾åˆå½±ç•™å¿µã€‚\n","slug":"ä¸‡åœ£èŠ‚ä¸‹çš„github","published":1,"updated":"2016-12-27T06:09:44.000Z","_id":"ciwu2eol600004n9kzseesmko","comments":1,"layout":"post","photos":[],"link":"","content":"<p><img src=\"/images/github-commits.png\" alt=\"\"></p>\n<p>æ˜¨å¤©èµ·å…¬å¸ä¸å†ä½¿ç”¨githubåšä»£ç æ‰˜ç®¡ï¼Œè°¨ä»¥ä¸‡åœ£èŠ‚ä¸‹çš„è¿™å¼ æˆªå›¾åˆå½±ç•™å¿µã€‚</p>\n","excerpt":"","more":"<p><img src=\"/images/github-commits.png\" alt=\"\"></p>\n<p>æ˜¨å¤©èµ·å…¬å¸ä¸å†ä½¿ç”¨githubåšä»£ç æ‰˜ç®¡ï¼Œè°¨ä»¥ä¸‡åœ£èŠ‚ä¸‹çš„è¿™å¼ æˆªå›¾åˆå½±ç•™å¿µã€‚</p>\n"},{"title":"git diffä½¿ç”¨","date":"2016-10-09T03:02:24.000Z","_content":"\nâ€‹ diffå‘½ä»¤å¹³æ—¶æ²¡å°‘ç”¨ï¼Œä½†ä¸€ç›´ä½¿ç”¨çš„åªæœ‰ä¸‹é¢ä¸¤æ¡ï¼š\n\n* æ¯”è¾ƒåˆ†æ”¯ï¼š`git diff master..another`\n\n\n* æŸ¥çœ‹ç›®å‰ä¿®æ”¹äº†çš„å†…å®¹ï¼šä»…è¾“å…¥`git diff`\n\n\n  å®é™…ä¸Šï¼Œdiffæ˜¯ä¸ªå¾ˆå¼ºå¤§çš„å‘½ä»¤ï¼Œèƒ½å¤Ÿæ‰¾å‡ºé¡¹ç›®é‡Œä»»æ„ä¸¤æ¬¡æäº¤ä¹‹é—´çš„æ”¹åŠ¨ã€‚\n\n  \\#\\# å·²ç»æ·»åŠ åˆ°æš‚å­˜åŒºçš„ä¿®æ”¹\n\n  `git diff --cached`\n\n  æ²¡æœ‰`--cached`é€‰é¡¹çš„å‘½ä»¤æŸ¥çœ‹å·¥ä½œåŒºä¿®æ”¹ï¼Œè€Œä¸Šé¢çš„å‘½ä»¤ç”¨æˆ·æŸ¥çœ‹æš‚å­˜åŒºçš„ä¿®æ”¹å’Œæœ¬åœ°å½“å‰ç´¢å¼•é—´çš„å·®å¼‚ï¼Œä¸éš¾ç†è§£ï¼Œåœ¨ä¸‹ä¸€æ¬¡commitæ—¶æäº¤çš„å°±æ˜¯è¿™äº›å†…å®¹ã€‚\n\n  \\#\\# å½“å‰ç´¢å¼•ä¸ä¸Šä¸€æ¬¡æäº¤ä¹‹é—´çš„å·®åˆ«\n\n  `git diff HEAD`\n\n  \\#\\# å½“å‰æ–‡ä»¶ç›®å½•ä¸å¦ä¸€ä¸ªåˆ†æ”¯ä¹‹é—´çš„å·®åˆ«\n\n  `git diff branchname`\n\n  \\#\\# è·¯å¾„é™å®šç¬¦`â€”`\n\n  `git diff â€” app.js`ï¼Œ`git diff -- xxx`\n\n  ä¸Šé¢ç¬¬ä¸€ä¸ªå‘½ä»¤æ˜¾ç¤ºäº†æˆ‘å¯¹app.jsæ–‡ä»¶çš„ä¿®æ”¹ã€‚ç¬¬äºŒä¸ªå‘½ä»¤æ˜¾ç¤ºäº†xxxç›®å½•ä¸‹(å¦‚æœxxxæ˜¯ç›®å½•åçš„è¯)æ‰€æœ‰æ–‡ä»¶çš„ä¿®æ”¹ã€‚\n\n  \\#\\# ç»¼åˆä½¿ç”¨\n\n  ç»“åˆä»¥ä¸Šå‘½ä»¤ï¼Œå¦‚æœæœ‰è¿™æ ·çš„éœ€æ±‚ï¼šæŸ¥çœ‹æ ¹ç›®å½•app.jsæ–‡ä»¶åœ¨åˆ†æ”¯Aå’Œåˆ†æ”¯Bæœ‰ä»€ä¹ˆä¸åŒï¼Œå°±å¯ä»¥ç”¨ä¸‹é¢è¿™ä¸ªå‘½ä»¤ã€‚\n\n  `git diff A..B -- app.js`\n\n","source":"_posts/git-diffä½¿ç”¨.md","raw":"---\ntitle: git diffä½¿ç”¨\ndate: 2016-10-09 11:02:24\ntags:\n---\n\nâ€‹ diffå‘½ä»¤å¹³æ—¶æ²¡å°‘ç”¨ï¼Œä½†ä¸€ç›´ä½¿ç”¨çš„åªæœ‰ä¸‹é¢ä¸¤æ¡ï¼š\n\n* æ¯”è¾ƒåˆ†æ”¯ï¼š`git diff master..another`\n\n\n* æŸ¥çœ‹ç›®å‰ä¿®æ”¹äº†çš„å†…å®¹ï¼šä»…è¾“å…¥`git diff`\n\n\n  å®é™…ä¸Šï¼Œdiffæ˜¯ä¸ªå¾ˆå¼ºå¤§çš„å‘½ä»¤ï¼Œèƒ½å¤Ÿæ‰¾å‡ºé¡¹ç›®é‡Œä»»æ„ä¸¤æ¬¡æäº¤ä¹‹é—´çš„æ”¹åŠ¨ã€‚\n\n  \\#\\# å·²ç»æ·»åŠ åˆ°æš‚å­˜åŒºçš„ä¿®æ”¹\n\n  `git diff --cached`\n\n  æ²¡æœ‰`--cached`é€‰é¡¹çš„å‘½ä»¤æŸ¥çœ‹å·¥ä½œåŒºä¿®æ”¹ï¼Œè€Œä¸Šé¢çš„å‘½ä»¤ç”¨æˆ·æŸ¥çœ‹æš‚å­˜åŒºçš„ä¿®æ”¹å’Œæœ¬åœ°å½“å‰ç´¢å¼•é—´çš„å·®å¼‚ï¼Œä¸éš¾ç†è§£ï¼Œåœ¨ä¸‹ä¸€æ¬¡commitæ—¶æäº¤çš„å°±æ˜¯è¿™äº›å†…å®¹ã€‚\n\n  \\#\\# å½“å‰ç´¢å¼•ä¸ä¸Šä¸€æ¬¡æäº¤ä¹‹é—´çš„å·®åˆ«\n\n  `git diff HEAD`\n\n  \\#\\# å½“å‰æ–‡ä»¶ç›®å½•ä¸å¦ä¸€ä¸ªåˆ†æ”¯ä¹‹é—´çš„å·®åˆ«\n\n  `git diff branchname`\n\n  \\#\\# è·¯å¾„é™å®šç¬¦`â€”`\n\n  `git diff â€” app.js`ï¼Œ`git diff -- xxx`\n\n  ä¸Šé¢ç¬¬ä¸€ä¸ªå‘½ä»¤æ˜¾ç¤ºäº†æˆ‘å¯¹app.jsæ–‡ä»¶çš„ä¿®æ”¹ã€‚ç¬¬äºŒä¸ªå‘½ä»¤æ˜¾ç¤ºäº†xxxç›®å½•ä¸‹(å¦‚æœxxxæ˜¯ç›®å½•åçš„è¯)æ‰€æœ‰æ–‡ä»¶çš„ä¿®æ”¹ã€‚\n\n  \\#\\# ç»¼åˆä½¿ç”¨\n\n  ç»“åˆä»¥ä¸Šå‘½ä»¤ï¼Œå¦‚æœæœ‰è¿™æ ·çš„éœ€æ±‚ï¼šæŸ¥çœ‹æ ¹ç›®å½•app.jsæ–‡ä»¶åœ¨åˆ†æ”¯Aå’Œåˆ†æ”¯Bæœ‰ä»€ä¹ˆä¸åŒï¼Œå°±å¯ä»¥ç”¨ä¸‹é¢è¿™ä¸ªå‘½ä»¤ã€‚\n\n  `git diff A..B -- app.js`\n\n","slug":"git-diffä½¿ç”¨","published":1,"updated":"2016-11-16T05:40:00.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ciwu2eola00014n9kn1eoilb8","content":"<p>â€‹ diffå‘½ä»¤å¹³æ—¶æ²¡å°‘ç”¨ï¼Œä½†ä¸€ç›´ä½¿ç”¨çš„åªæœ‰ä¸‹é¢ä¸¤æ¡ï¼š</p>\n<ul>\n<li>æ¯”è¾ƒåˆ†æ”¯ï¼š<code>git diff master..another</code></li>\n</ul>\n<ul>\n<li>æŸ¥çœ‹ç›®å‰ä¿®æ”¹äº†çš„å†…å®¹ï¼šä»…è¾“å…¥<code>git diff</code></li>\n</ul>\n<p>  å®é™…ä¸Šï¼Œdiffæ˜¯ä¸ªå¾ˆå¼ºå¤§çš„å‘½ä»¤ï¼Œèƒ½å¤Ÿæ‰¾å‡ºé¡¹ç›®é‡Œä»»æ„ä¸¤æ¬¡æäº¤ä¹‹é—´çš„æ”¹åŠ¨ã€‚</p>\n<p>  ## å·²ç»æ·»åŠ åˆ°æš‚å­˜åŒºçš„ä¿®æ”¹</p>\n<p>  <code>git diff --cached</code></p>\n<p>  æ²¡æœ‰<code>--cached</code>é€‰é¡¹çš„å‘½ä»¤æŸ¥çœ‹å·¥ä½œåŒºä¿®æ”¹ï¼Œè€Œä¸Šé¢çš„å‘½ä»¤ç”¨æˆ·æŸ¥çœ‹æš‚å­˜åŒºçš„ä¿®æ”¹å’Œæœ¬åœ°å½“å‰ç´¢å¼•é—´çš„å·®å¼‚ï¼Œä¸éš¾ç†è§£ï¼Œåœ¨ä¸‹ä¸€æ¬¡commitæ—¶æäº¤çš„å°±æ˜¯è¿™äº›å†…å®¹ã€‚</p>\n<p>  ## å½“å‰ç´¢å¼•ä¸ä¸Šä¸€æ¬¡æäº¤ä¹‹é—´çš„å·®åˆ«</p>\n<p>  <code>git diff HEAD</code></p>\n<p>  ## å½“å‰æ–‡ä»¶ç›®å½•ä¸å¦ä¸€ä¸ªåˆ†æ”¯ä¹‹é—´çš„å·®åˆ«</p>\n<p>  <code>git diff branchname</code></p>\n<p>  ## è·¯å¾„é™å®šç¬¦<code>â€”</code></p>\n<p>  <code>git diff â€” app.js</code>ï¼Œ<code>git diff -- xxx</code></p>\n<p>  ä¸Šé¢ç¬¬ä¸€ä¸ªå‘½ä»¤æ˜¾ç¤ºäº†æˆ‘å¯¹app.jsæ–‡ä»¶çš„ä¿®æ”¹ã€‚ç¬¬äºŒä¸ªå‘½ä»¤æ˜¾ç¤ºäº†xxxç›®å½•ä¸‹(å¦‚æœxxxæ˜¯ç›®å½•åçš„è¯)æ‰€æœ‰æ–‡ä»¶çš„ä¿®æ”¹ã€‚</p>\n<p>  ## ç»¼åˆä½¿ç”¨</p>\n<p>  ç»“åˆä»¥ä¸Šå‘½ä»¤ï¼Œå¦‚æœæœ‰è¿™æ ·çš„éœ€æ±‚ï¼šæŸ¥çœ‹æ ¹ç›®å½•app.jsæ–‡ä»¶åœ¨åˆ†æ”¯Aå’Œåˆ†æ”¯Bæœ‰ä»€ä¹ˆä¸åŒï¼Œå°±å¯ä»¥ç”¨ä¸‹é¢è¿™ä¸ªå‘½ä»¤ã€‚</p>\n<p>  <code>git diff A..B -- app.js</code></p>\n","excerpt":"","more":"<p>â€‹ diffå‘½ä»¤å¹³æ—¶æ²¡å°‘ç”¨ï¼Œä½†ä¸€ç›´ä½¿ç”¨çš„åªæœ‰ä¸‹é¢ä¸¤æ¡ï¼š</p>\n<ul>\n<li>æ¯”è¾ƒåˆ†æ”¯ï¼š<code>git diff master..another</code></li>\n</ul>\n<ul>\n<li>æŸ¥çœ‹ç›®å‰ä¿®æ”¹äº†çš„å†…å®¹ï¼šä»…è¾“å…¥<code>git diff</code></li>\n</ul>\n<p>  å®é™…ä¸Šï¼Œdiffæ˜¯ä¸ªå¾ˆå¼ºå¤§çš„å‘½ä»¤ï¼Œèƒ½å¤Ÿæ‰¾å‡ºé¡¹ç›®é‡Œä»»æ„ä¸¤æ¬¡æäº¤ä¹‹é—´çš„æ”¹åŠ¨ã€‚</p>\n<p>  ## å·²ç»æ·»åŠ åˆ°æš‚å­˜åŒºçš„ä¿®æ”¹</p>\n<p>  <code>git diff --cached</code></p>\n<p>  æ²¡æœ‰<code>--cached</code>é€‰é¡¹çš„å‘½ä»¤æŸ¥çœ‹å·¥ä½œåŒºä¿®æ”¹ï¼Œè€Œä¸Šé¢çš„å‘½ä»¤ç”¨æˆ·æŸ¥çœ‹æš‚å­˜åŒºçš„ä¿®æ”¹å’Œæœ¬åœ°å½“å‰ç´¢å¼•é—´çš„å·®å¼‚ï¼Œä¸éš¾ç†è§£ï¼Œåœ¨ä¸‹ä¸€æ¬¡commitæ—¶æäº¤çš„å°±æ˜¯è¿™äº›å†…å®¹ã€‚</p>\n<p>  ## å½“å‰ç´¢å¼•ä¸ä¸Šä¸€æ¬¡æäº¤ä¹‹é—´çš„å·®åˆ«</p>\n<p>  <code>git diff HEAD</code></p>\n<p>  ## å½“å‰æ–‡ä»¶ç›®å½•ä¸å¦ä¸€ä¸ªåˆ†æ”¯ä¹‹é—´çš„å·®åˆ«</p>\n<p>  <code>git diff branchname</code></p>\n<p>  ## è·¯å¾„é™å®šç¬¦<code>â€”</code></p>\n<p>  <code>git diff â€” app.js</code>ï¼Œ<code>git diff -- xxx</code></p>\n<p>  ä¸Šé¢ç¬¬ä¸€ä¸ªå‘½ä»¤æ˜¾ç¤ºäº†æˆ‘å¯¹app.jsæ–‡ä»¶çš„ä¿®æ”¹ã€‚ç¬¬äºŒä¸ªå‘½ä»¤æ˜¾ç¤ºäº†xxxç›®å½•ä¸‹(å¦‚æœxxxæ˜¯ç›®å½•åçš„è¯)æ‰€æœ‰æ–‡ä»¶çš„ä¿®æ”¹ã€‚</p>\n<p>  ## ç»¼åˆä½¿ç”¨</p>\n<p>  ç»“åˆä»¥ä¸Šå‘½ä»¤ï¼Œå¦‚æœæœ‰è¿™æ ·çš„éœ€æ±‚ï¼šæŸ¥çœ‹æ ¹ç›®å½•app.jsæ–‡ä»¶åœ¨åˆ†æ”¯Aå’Œåˆ†æ”¯Bæœ‰ä»€ä¹ˆä¸åŒï¼Œå°±å¯ä»¥ç”¨ä¸‹é¢è¿™ä¸ªå‘½ä»¤ã€‚</p>\n<p>  <code>git diff A..B -- app.js</code></p>\n"},{"title":"ä¸€ä¸ªæœ‰è¶£çš„thisæŒ‡å‘é—®é¢˜","date":"2016-07-27T02:39:55.000Z","_content":"\tlet obj = {\n\t\ttest: ()=>{\n\t\t\tconsole.log(this)\n\t\t}\n\t}\n\tobj.test() // this -> ï¼Ÿ\n\t(obj.test = obj.test)() // this -> ï¼Ÿ\n\t(false || obj.test)() // this -> ï¼Ÿ\n\nè¿™é‡Œè€ƒå¯Ÿäº†å¤šä¸ªçŸ¥è¯†ç‚¹ã€‚\n\n* è°è°ƒç”¨äº†thiså°±æŒ‡å‘è°\n* åŒ¿åå‡½æ•°thisæŒ‡å‘windowï¼ˆç‰¹æŒ‡åœ¨æµè§ˆå™¨ä¸­ï¼‰\n* èµ‹å€¼è¯­å¥è¿”å›__å³å€¼__\n* é€»è¾‘æˆ–è¯­å¥è¿”å›ä»å·¦åˆ°å³ç¬¬ä¸€ä¸ªçœŸå€¼ï¼Œå¦åˆ™è¿”å›æœ€åä¸€ä¸ªå€¼\n\nç†è§£äº†è¿™å‡ æ¡å†å›å¤´çœ‹é—®é¢˜å°±å¾ˆç®€å•äº†ã€‚\n\nä¸‰ä¸ªthisåˆ†åˆ«æŒ‡å‘obj, window, window\n","source":"_posts/ä¸€ä¸ªæœ‰è¶£çš„thisæŒ‡å‘é—®é¢˜.md","raw":"---\ntitle: ä¸€ä¸ªæœ‰è¶£çš„thisæŒ‡å‘é—®é¢˜\ndate: 2016-07-27 10:39:55\ntags:\n---\n\tlet obj = {\n\t\ttest: ()=>{\n\t\t\tconsole.log(this)\n\t\t}\n\t}\n\tobj.test() // this -> ï¼Ÿ\n\t(obj.test = obj.test)() // this -> ï¼Ÿ\n\t(false || obj.test)() // this -> ï¼Ÿ\n\nè¿™é‡Œè€ƒå¯Ÿäº†å¤šä¸ªçŸ¥è¯†ç‚¹ã€‚\n\n* è°è°ƒç”¨äº†thiså°±æŒ‡å‘è°\n* åŒ¿åå‡½æ•°thisæŒ‡å‘windowï¼ˆç‰¹æŒ‡åœ¨æµè§ˆå™¨ä¸­ï¼‰\n* èµ‹å€¼è¯­å¥è¿”å›__å³å€¼__\n* é€»è¾‘æˆ–è¯­å¥è¿”å›ä»å·¦åˆ°å³ç¬¬ä¸€ä¸ªçœŸå€¼ï¼Œå¦åˆ™è¿”å›æœ€åä¸€ä¸ªå€¼\n\nç†è§£äº†è¿™å‡ æ¡å†å›å¤´çœ‹é—®é¢˜å°±å¾ˆç®€å•äº†ã€‚\n\nä¸‰ä¸ªthisåˆ†åˆ«æŒ‡å‘obj, window, window\n","slug":"ä¸€ä¸ªæœ‰è¶£çš„thisæŒ‡å‘é—®é¢˜","published":1,"updated":"2016-11-16T05:40:00.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ciwu2eolc00024n9kegexiuew","content":"<pre><code>let obj = {\n    test: ()=&gt;{\n        console.log(this)\n    }\n}\nobj.test() // this -&gt; ï¼Ÿ\n(obj.test = obj.test)() // this -&gt; ï¼Ÿ\n(false || obj.test)() // this -&gt; ï¼Ÿ\n</code></pre><p>è¿™é‡Œè€ƒå¯Ÿäº†å¤šä¸ªçŸ¥è¯†ç‚¹ã€‚</p>\n<ul>\n<li>è°è°ƒç”¨äº†thiså°±æŒ‡å‘è°</li>\n<li>åŒ¿åå‡½æ•°thisæŒ‡å‘windowï¼ˆç‰¹æŒ‡åœ¨æµè§ˆå™¨ä¸­ï¼‰</li>\n<li>èµ‹å€¼è¯­å¥è¿”å›<strong>å³å€¼</strong></li>\n<li>é€»è¾‘æˆ–è¯­å¥è¿”å›ä»å·¦åˆ°å³ç¬¬ä¸€ä¸ªçœŸå€¼ï¼Œå¦åˆ™è¿”å›æœ€åä¸€ä¸ªå€¼</li>\n</ul>\n<p>ç†è§£äº†è¿™å‡ æ¡å†å›å¤´çœ‹é—®é¢˜å°±å¾ˆç®€å•äº†ã€‚</p>\n<p>ä¸‰ä¸ªthisåˆ†åˆ«æŒ‡å‘obj, window, window</p>\n","excerpt":"","more":"<pre><code>let obj = {\n    test: ()=&gt;{\n        console.log(this)\n    }\n}\nobj.test() // this -&gt; ï¼Ÿ\n(obj.test = obj.test)() // this -&gt; ï¼Ÿ\n(false || obj.test)() // this -&gt; ï¼Ÿ\n</code></pre><p>è¿™é‡Œè€ƒå¯Ÿäº†å¤šä¸ªçŸ¥è¯†ç‚¹ã€‚</p>\n<ul>\n<li>è°è°ƒç”¨äº†thiså°±æŒ‡å‘è°</li>\n<li>åŒ¿åå‡½æ•°thisæŒ‡å‘windowï¼ˆç‰¹æŒ‡åœ¨æµè§ˆå™¨ä¸­ï¼‰</li>\n<li>èµ‹å€¼è¯­å¥è¿”å›<strong>å³å€¼</strong></li>\n<li>é€»è¾‘æˆ–è¯­å¥è¿”å›ä»å·¦åˆ°å³ç¬¬ä¸€ä¸ªçœŸå€¼ï¼Œå¦åˆ™è¿”å›æœ€åä¸€ä¸ªå€¼</li>\n</ul>\n<p>ç†è§£äº†è¿™å‡ æ¡å†å›å¤´çœ‹é—®é¢˜å°±å¾ˆç®€å•äº†ã€‚</p>\n<p>ä¸‰ä¸ªthisåˆ†åˆ«æŒ‡å‘obj, window, window</p>\n"},{"title":"JavaScript Array.sort","date":"2016-11-25T13:45:04.000Z","_content":"\nä»Šå¤©ç”¨jsé‡æ¸©äº†å‡ ç§æ’åºç®—æ³•ï¼Œå‘ç°ä¸ªå¾ˆæœ‰æ„æ€çš„ç½‘ç«™ï¼š[å‡ ç§æ’åºç®—æ³•çš„åŠ¨ç”»æ¼”ç¤º](http://jsdo.it/norahiko/oxIy/fullscreen)\n\nä¸€ç›´ä»¥æ¥å¯¹`Array.sort`æœ‰ä¸ªä¸ç—›ä¸ç—’çš„è¯¯è§£ï¼Œè®¤ä¸ºå®ƒåº•å±‚ç”¨äº†å¿«é€Ÿæ’åºã€‚å®é™…ä¸Šå‘¢ï¼Œè¿™ä¸ªapiæœ‰æ—¶å€™ç”¨äº†å¿«é€Ÿæ’åºã€æœ‰æ—¶å€™ç”¨äº†å½’å¹¶æ’åºã€è¿˜æœ‰æ—¶å€™ç”¨äº†é€‰æ‹©æ’åºï¼Œå–å†³äºä½œç”¨çš„æ•°ç»„å¯¹è±¡ï¼Œä»¥åŠå¼•æ“ã€‚\n\nä¹‹æ‰€ä»¥å¼•æ“ä¼šæœ‰ä¸åŒçš„å®ç°ï¼Œ æ˜¯å› ä¸ºECMAscriptå‹æ ¹æ²¡è§„å®šè¦ç”¨ä»€ä¹ˆç®—æ³•å®ç°ã€‚å¥½å¥‡å¿ƒé©±ä½¿æ£€ç´¢äº†ä¸€ä¼šã€‚\n\n---\n\nåªæ‰€ä»¥æœ‰ä¹‹å‰çš„è¯¯è§£æ˜¯å› ä¸ºï¼Œæ—¢ç„¶å¿«é€Ÿæ’åºè¢«è®¤å¯ä¸ºå·²çŸ¥çš„æ’åºç®—æ³•ä¸­æœ€å¿«çš„ï¼Œæœ‰ä»€ä¹ˆç†ç”±ä¸ç”¨å‘¢ã€‚åè¿‡æ¥æƒ³ï¼Œä¹Ÿè®¸ä¸ç”¨çš„ç†ç”±ä¹Ÿå¾ˆç®€å•ï¼Œå¤§æ¦‚å’Œå¿«é€Ÿæ’åºæœ¬èº«æ˜¯ä¸ç¨³å®šç®—æ³•æœ‰å…³ã€‚\n\n\n\nåœ¨v8ï¼ˆchromeï¼‰é‡Œï¼Œä½œç”¨åœ¨é•¿åº¦å°äº23çš„æ•°ç»„ä¸Šç”¨çš„æ˜¯æ’å…¥æ’åºï¼Œè€Œå¤§äº23çš„é‡‡ç”¨çš„æ˜¯å¿«é€Ÿæ’åºã€‚\n\nå¿«æ’çš„ä¸ç¨³å®šåœ¨äºåŸºå‡†å…ƒç´ çš„é€‰æ‹©å’Œæ¯”è¾ƒçš„æ–¹å¼ï¼Œå¯èƒ½é€ æˆå€¼ç›¸åŒçš„å…ƒç´ åœ¨æ’åºåç›¸å¯¹ä½ç½®å‘ç”Ÿäº†å˜åŒ–ï¼ŒSafariã€Firefoxè¿™ä¸¤çš„å¼•æ“è¡¨ç¤ºä¸èƒ½æ¥å—ï¼Œé€‰æ‹©äº†ç”¨å½’å¹¶æ’åºæ¥å®ç°ã€‚\n\n> ```\n> The array is sorted on the key correctly, but where there are duplicate values\n> for the key, the original order is NOT preserved.\n> ```\n\næ¥è‡ªå¤šå¹´å‰Bugzillaä¸Šçš„è¿™ç¯‡[report](https://bugzilla.mozilla.org/show_bug.cgi?id=224128)ã€‚ä¸€ä¸ªå«*Martin Thomson*çš„äººæå‡ºçš„bugã€‚\n\nIEçš„å®ç°åˆ™åŒæ ·æ˜¯ç¨³å®šæ’åºï¼ˆæµ‹è¯•å¦‚æ­¤ï¼‰ï¼Œä¸è¿‡å¹¶æ²¡æœ‰æ‰¾åˆ°ç”¨äº†ä»€ä¹ˆæ’åºæ–¹æ³•ã€‚\n\n---\n\nå¼•æ“èƒŒåçš„å®ç°å…¶å®ä¸å¿…å¤ªå…³å¿ƒã€‚\n\nsortçš„ä½¿ç”¨æ¥å¤ä¹ ä¸€éã€‚åˆ—ä¸€ä¸ªå¾ˆå¤šä¸ç†Ÿæ‚‰Apiçš„ç¨‹åºå‘˜å¸¸çŠ¯çš„é”™è¯¯ï¼Œå”¯ä¸€çš„ä¸€ä¸ªå¯é€‰çš„å‚æ•°å¹¶ä¸æ˜¯æ–­è¨€ï¼Œè¯¥å‡½æ•°éœ€è¦è¿”å›ä¸‰ä¸ªå¯èƒ½çš„å€¼ï¼Œä¾‹ï¼š\n\n```Javascript\nfoo.sort((a, b)=>{return a -  b})\n```\n\n* è‹¥è¿”å›å€¼å¤§äº0ï¼Œaåœ¨bå\n* è‹¥è¿”å›å€¼ç­‰äº0ï¼Œä½ç½®ä¸å˜\n* è‹¥è¿”å›å€¼å°äº0ï¼Œaåœ¨bå‰\n\nå¦‚æœä¼ å…¥æ–­è¨€ï¼Œè¿”å›å€¼åªå¯èƒ½å¤§äº0æˆ–ç­‰äº0ï¼Œæ˜¾ç„¶å¾—ä¸åˆ°æƒ³è¦çš„ç»“æœã€‚\n\nå¹¶ä¸”è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œæ¯”è¾ƒçš„æ˜¯æ•°ç»„å…ƒç´ çš„unicodeç¼–ç ï¼Œå¿½ç•¥è¿™ä¸€ç‚¹ä¼šå¯¹ä¸‹é¢è¿™ä¸ªæ•°ç»„çš„æ’åºç–‘æƒ‘ï¼ˆå¹¶ä¸æ˜¯æƒ³åƒä¸­çš„ä»å°åˆ°å¤§æ’åºï¼‰ã€‚\n\n```Javascript\n[2,1,10].sort() // [1,10,2]\n```\n\nï¼ˆå®Œï¼‰","source":"_posts/JavaScript-Array-sort.md","raw":"---\ntitle: JavaScript Array.sort\ndate: 2016-11-25 21:45:04\ntags:\n---\n\nä»Šå¤©ç”¨jsé‡æ¸©äº†å‡ ç§æ’åºç®—æ³•ï¼Œå‘ç°ä¸ªå¾ˆæœ‰æ„æ€çš„ç½‘ç«™ï¼š[å‡ ç§æ’åºç®—æ³•çš„åŠ¨ç”»æ¼”ç¤º](http://jsdo.it/norahiko/oxIy/fullscreen)\n\nä¸€ç›´ä»¥æ¥å¯¹`Array.sort`æœ‰ä¸ªä¸ç—›ä¸ç—’çš„è¯¯è§£ï¼Œè®¤ä¸ºå®ƒåº•å±‚ç”¨äº†å¿«é€Ÿæ’åºã€‚å®é™…ä¸Šå‘¢ï¼Œè¿™ä¸ªapiæœ‰æ—¶å€™ç”¨äº†å¿«é€Ÿæ’åºã€æœ‰æ—¶å€™ç”¨äº†å½’å¹¶æ’åºã€è¿˜æœ‰æ—¶å€™ç”¨äº†é€‰æ‹©æ’åºï¼Œå–å†³äºä½œç”¨çš„æ•°ç»„å¯¹è±¡ï¼Œä»¥åŠå¼•æ“ã€‚\n\nä¹‹æ‰€ä»¥å¼•æ“ä¼šæœ‰ä¸åŒçš„å®ç°ï¼Œ æ˜¯å› ä¸ºECMAscriptå‹æ ¹æ²¡è§„å®šè¦ç”¨ä»€ä¹ˆç®—æ³•å®ç°ã€‚å¥½å¥‡å¿ƒé©±ä½¿æ£€ç´¢äº†ä¸€ä¼šã€‚\n\n---\n\nåªæ‰€ä»¥æœ‰ä¹‹å‰çš„è¯¯è§£æ˜¯å› ä¸ºï¼Œæ—¢ç„¶å¿«é€Ÿæ’åºè¢«è®¤å¯ä¸ºå·²çŸ¥çš„æ’åºç®—æ³•ä¸­æœ€å¿«çš„ï¼Œæœ‰ä»€ä¹ˆç†ç”±ä¸ç”¨å‘¢ã€‚åè¿‡æ¥æƒ³ï¼Œä¹Ÿè®¸ä¸ç”¨çš„ç†ç”±ä¹Ÿå¾ˆç®€å•ï¼Œå¤§æ¦‚å’Œå¿«é€Ÿæ’åºæœ¬èº«æ˜¯ä¸ç¨³å®šç®—æ³•æœ‰å…³ã€‚\n\n\n\nåœ¨v8ï¼ˆchromeï¼‰é‡Œï¼Œä½œç”¨åœ¨é•¿åº¦å°äº23çš„æ•°ç»„ä¸Šç”¨çš„æ˜¯æ’å…¥æ’åºï¼Œè€Œå¤§äº23çš„é‡‡ç”¨çš„æ˜¯å¿«é€Ÿæ’åºã€‚\n\nå¿«æ’çš„ä¸ç¨³å®šåœ¨äºåŸºå‡†å…ƒç´ çš„é€‰æ‹©å’Œæ¯”è¾ƒçš„æ–¹å¼ï¼Œå¯èƒ½é€ æˆå€¼ç›¸åŒçš„å…ƒç´ åœ¨æ’åºåç›¸å¯¹ä½ç½®å‘ç”Ÿäº†å˜åŒ–ï¼ŒSafariã€Firefoxè¿™ä¸¤çš„å¼•æ“è¡¨ç¤ºä¸èƒ½æ¥å—ï¼Œé€‰æ‹©äº†ç”¨å½’å¹¶æ’åºæ¥å®ç°ã€‚\n\n> ```\n> The array is sorted on the key correctly, but where there are duplicate values\n> for the key, the original order is NOT preserved.\n> ```\n\næ¥è‡ªå¤šå¹´å‰Bugzillaä¸Šçš„è¿™ç¯‡[report](https://bugzilla.mozilla.org/show_bug.cgi?id=224128)ã€‚ä¸€ä¸ªå«*Martin Thomson*çš„äººæå‡ºçš„bugã€‚\n\nIEçš„å®ç°åˆ™åŒæ ·æ˜¯ç¨³å®šæ’åºï¼ˆæµ‹è¯•å¦‚æ­¤ï¼‰ï¼Œä¸è¿‡å¹¶æ²¡æœ‰æ‰¾åˆ°ç”¨äº†ä»€ä¹ˆæ’åºæ–¹æ³•ã€‚\n\n---\n\nå¼•æ“èƒŒåçš„å®ç°å…¶å®ä¸å¿…å¤ªå…³å¿ƒã€‚\n\nsortçš„ä½¿ç”¨æ¥å¤ä¹ ä¸€éã€‚åˆ—ä¸€ä¸ªå¾ˆå¤šä¸ç†Ÿæ‚‰Apiçš„ç¨‹åºå‘˜å¸¸çŠ¯çš„é”™è¯¯ï¼Œå”¯ä¸€çš„ä¸€ä¸ªå¯é€‰çš„å‚æ•°å¹¶ä¸æ˜¯æ–­è¨€ï¼Œè¯¥å‡½æ•°éœ€è¦è¿”å›ä¸‰ä¸ªå¯èƒ½çš„å€¼ï¼Œä¾‹ï¼š\n\n```Javascript\nfoo.sort((a, b)=>{return a -  b})\n```\n\n* è‹¥è¿”å›å€¼å¤§äº0ï¼Œaåœ¨bå\n* è‹¥è¿”å›å€¼ç­‰äº0ï¼Œä½ç½®ä¸å˜\n* è‹¥è¿”å›å€¼å°äº0ï¼Œaåœ¨bå‰\n\nå¦‚æœä¼ å…¥æ–­è¨€ï¼Œè¿”å›å€¼åªå¯èƒ½å¤§äº0æˆ–ç­‰äº0ï¼Œæ˜¾ç„¶å¾—ä¸åˆ°æƒ³è¦çš„ç»“æœã€‚\n\nå¹¶ä¸”è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œæ¯”è¾ƒçš„æ˜¯æ•°ç»„å…ƒç´ çš„unicodeç¼–ç ï¼Œå¿½ç•¥è¿™ä¸€ç‚¹ä¼šå¯¹ä¸‹é¢è¿™ä¸ªæ•°ç»„çš„æ’åºç–‘æƒ‘ï¼ˆå¹¶ä¸æ˜¯æƒ³åƒä¸­çš„ä»å°åˆ°å¤§æ’åºï¼‰ã€‚\n\n```Javascript\n[2,1,10].sort() // [1,10,2]\n```\n\nï¼ˆå®Œï¼‰","slug":"JavaScript-Array-sort","published":1,"updated":"2016-12-07T12:53:56.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ciwu2eolf00034n9ks4gp5jwo","content":"<p>ä»Šå¤©ç”¨jsé‡æ¸©äº†å‡ ç§æ’åºç®—æ³•ï¼Œå‘ç°ä¸ªå¾ˆæœ‰æ„æ€çš„ç½‘ç«™ï¼š<a href=\"http://jsdo.it/norahiko/oxIy/fullscreen\" target=\"_blank\" rel=\"external\">å‡ ç§æ’åºç®—æ³•çš„åŠ¨ç”»æ¼”ç¤º</a></p>\n<p>ä¸€ç›´ä»¥æ¥å¯¹<code>Array.sort</code>æœ‰ä¸ªä¸ç—›ä¸ç—’çš„è¯¯è§£ï¼Œè®¤ä¸ºå®ƒåº•å±‚ç”¨äº†å¿«é€Ÿæ’åºã€‚å®é™…ä¸Šå‘¢ï¼Œè¿™ä¸ªapiæœ‰æ—¶å€™ç”¨äº†å¿«é€Ÿæ’åºã€æœ‰æ—¶å€™ç”¨äº†å½’å¹¶æ’åºã€è¿˜æœ‰æ—¶å€™ç”¨äº†é€‰æ‹©æ’åºï¼Œå–å†³äºä½œç”¨çš„æ•°ç»„å¯¹è±¡ï¼Œä»¥åŠå¼•æ“ã€‚</p>\n<p>ä¹‹æ‰€ä»¥å¼•æ“ä¼šæœ‰ä¸åŒçš„å®ç°ï¼Œ æ˜¯å› ä¸ºECMAscriptå‹æ ¹æ²¡è§„å®šè¦ç”¨ä»€ä¹ˆç®—æ³•å®ç°ã€‚å¥½å¥‡å¿ƒé©±ä½¿æ£€ç´¢äº†ä¸€ä¼šã€‚</p>\n<hr>\n<p>åªæ‰€ä»¥æœ‰ä¹‹å‰çš„è¯¯è§£æ˜¯å› ä¸ºï¼Œæ—¢ç„¶å¿«é€Ÿæ’åºè¢«è®¤å¯ä¸ºå·²çŸ¥çš„æ’åºç®—æ³•ä¸­æœ€å¿«çš„ï¼Œæœ‰ä»€ä¹ˆç†ç”±ä¸ç”¨å‘¢ã€‚åè¿‡æ¥æƒ³ï¼Œä¹Ÿè®¸ä¸ç”¨çš„ç†ç”±ä¹Ÿå¾ˆç®€å•ï¼Œå¤§æ¦‚å’Œå¿«é€Ÿæ’åºæœ¬èº«æ˜¯ä¸ç¨³å®šç®—æ³•æœ‰å…³ã€‚</p>\n<p>åœ¨v8ï¼ˆchromeï¼‰é‡Œï¼Œä½œç”¨åœ¨é•¿åº¦å°äº23çš„æ•°ç»„ä¸Šç”¨çš„æ˜¯æ’å…¥æ’åºï¼Œè€Œå¤§äº23çš„é‡‡ç”¨çš„æ˜¯å¿«é€Ÿæ’åºã€‚</p>\n<p>å¿«æ’çš„ä¸ç¨³å®šåœ¨äºåŸºå‡†å…ƒç´ çš„é€‰æ‹©å’Œæ¯”è¾ƒçš„æ–¹å¼ï¼Œå¯èƒ½é€ æˆå€¼ç›¸åŒçš„å…ƒç´ åœ¨æ’åºåç›¸å¯¹ä½ç½®å‘ç”Ÿäº†å˜åŒ–ï¼ŒSafariã€Firefoxè¿™ä¸¤çš„å¼•æ“è¡¨ç¤ºä¸èƒ½æ¥å—ï¼Œé€‰æ‹©äº†ç”¨å½’å¹¶æ’åºæ¥å®ç°ã€‚</p>\n<blockquote>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">&gt; The array is sorted on the key correctly, but where there are duplicate values</div><div class=\"line\">&gt; for the key, the original order is NOT preserved.</div><div class=\"line\">&gt;</div></pre></td></tr></table></figure>\n</blockquote>\n<p>æ¥è‡ªå¤šå¹´å‰Bugzillaä¸Šçš„è¿™ç¯‡<a href=\"https://bugzilla.mozilla.org/show_bug.cgi?id=224128\" target=\"_blank\" rel=\"external\">report</a>ã€‚ä¸€ä¸ªå«<em>Martin Thomson</em>çš„äººæå‡ºçš„bugã€‚</p>\n<p>IEçš„å®ç°åˆ™åŒæ ·æ˜¯ç¨³å®šæ’åºï¼ˆæµ‹è¯•å¦‚æ­¤ï¼‰ï¼Œä¸è¿‡å¹¶æ²¡æœ‰æ‰¾åˆ°ç”¨äº†ä»€ä¹ˆæ’åºæ–¹æ³•ã€‚</p>\n<hr>\n<p>å¼•æ“èƒŒåçš„å®ç°å…¶å®ä¸å¿…å¤ªå…³å¿ƒã€‚</p>\n<p>sortçš„ä½¿ç”¨æ¥å¤ä¹ ä¸€éã€‚åˆ—ä¸€ä¸ªå¾ˆå¤šä¸ç†Ÿæ‚‰Apiçš„ç¨‹åºå‘˜å¸¸çŠ¯çš„é”™è¯¯ï¼Œå”¯ä¸€çš„ä¸€ä¸ªå¯é€‰çš„å‚æ•°å¹¶ä¸æ˜¯æ–­è¨€ï¼Œè¯¥å‡½æ•°éœ€è¦è¿”å›ä¸‰ä¸ªå¯èƒ½çš„å€¼ï¼Œä¾‹ï¼š</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">foo.sort(<span class=\"function\">(<span class=\"params\">a, b</span>)=&gt;</span>&#123;<span class=\"keyword\">return</span> a -  b&#125;)</div></pre></td></tr></table></figure>\n<ul>\n<li>è‹¥è¿”å›å€¼å¤§äº0ï¼Œaåœ¨bå</li>\n<li>è‹¥è¿”å›å€¼ç­‰äº0ï¼Œä½ç½®ä¸å˜</li>\n<li>è‹¥è¿”å›å€¼å°äº0ï¼Œaåœ¨bå‰</li>\n</ul>\n<p>å¦‚æœä¼ å…¥æ–­è¨€ï¼Œè¿”å›å€¼åªå¯èƒ½å¤§äº0æˆ–ç­‰äº0ï¼Œæ˜¾ç„¶å¾—ä¸åˆ°æƒ³è¦çš„ç»“æœã€‚</p>\n<p>å¹¶ä¸”è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œæ¯”è¾ƒçš„æ˜¯æ•°ç»„å…ƒç´ çš„unicodeç¼–ç ï¼Œå¿½ç•¥è¿™ä¸€ç‚¹ä¼šå¯¹ä¸‹é¢è¿™ä¸ªæ•°ç»„çš„æ’åºç–‘æƒ‘ï¼ˆå¹¶ä¸æ˜¯æƒ³åƒä¸­çš„ä»å°åˆ°å¤§æ’åºï¼‰ã€‚</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">[<span class=\"number\">2</span>,<span class=\"number\">1</span>,<span class=\"number\">10</span>].sort() <span class=\"comment\">// [1,10,2]</span></div></pre></td></tr></table></figure>\n<p>ï¼ˆå®Œï¼‰</p>\n","excerpt":"","more":"<p>ä»Šå¤©ç”¨jsé‡æ¸©äº†å‡ ç§æ’åºç®—æ³•ï¼Œå‘ç°ä¸ªå¾ˆæœ‰æ„æ€çš„ç½‘ç«™ï¼š<a href=\"http://jsdo.it/norahiko/oxIy/fullscreen\">å‡ ç§æ’åºç®—æ³•çš„åŠ¨ç”»æ¼”ç¤º</a></p>\n<p>ä¸€ç›´ä»¥æ¥å¯¹<code>Array.sort</code>æœ‰ä¸ªä¸ç—›ä¸ç—’çš„è¯¯è§£ï¼Œè®¤ä¸ºå®ƒåº•å±‚ç”¨äº†å¿«é€Ÿæ’åºã€‚å®é™…ä¸Šå‘¢ï¼Œè¿™ä¸ªapiæœ‰æ—¶å€™ç”¨äº†å¿«é€Ÿæ’åºã€æœ‰æ—¶å€™ç”¨äº†å½’å¹¶æ’åºã€è¿˜æœ‰æ—¶å€™ç”¨äº†é€‰æ‹©æ’åºï¼Œå–å†³äºä½œç”¨çš„æ•°ç»„å¯¹è±¡ï¼Œä»¥åŠå¼•æ“ã€‚</p>\n<p>ä¹‹æ‰€ä»¥å¼•æ“ä¼šæœ‰ä¸åŒçš„å®ç°ï¼Œ æ˜¯å› ä¸ºECMAscriptå‹æ ¹æ²¡è§„å®šè¦ç”¨ä»€ä¹ˆç®—æ³•å®ç°ã€‚å¥½å¥‡å¿ƒé©±ä½¿æ£€ç´¢äº†ä¸€ä¼šã€‚</p>\n<hr>\n<p>åªæ‰€ä»¥æœ‰ä¹‹å‰çš„è¯¯è§£æ˜¯å› ä¸ºï¼Œæ—¢ç„¶å¿«é€Ÿæ’åºè¢«è®¤å¯ä¸ºå·²çŸ¥çš„æ’åºç®—æ³•ä¸­æœ€å¿«çš„ï¼Œæœ‰ä»€ä¹ˆç†ç”±ä¸ç”¨å‘¢ã€‚åè¿‡æ¥æƒ³ï¼Œä¹Ÿè®¸ä¸ç”¨çš„ç†ç”±ä¹Ÿå¾ˆç®€å•ï¼Œå¤§æ¦‚å’Œå¿«é€Ÿæ’åºæœ¬èº«æ˜¯ä¸ç¨³å®šç®—æ³•æœ‰å…³ã€‚</p>\n<p>åœ¨v8ï¼ˆchromeï¼‰é‡Œï¼Œä½œç”¨åœ¨é•¿åº¦å°äº23çš„æ•°ç»„ä¸Šç”¨çš„æ˜¯æ’å…¥æ’åºï¼Œè€Œå¤§äº23çš„é‡‡ç”¨çš„æ˜¯å¿«é€Ÿæ’åºã€‚</p>\n<p>å¿«æ’çš„ä¸ç¨³å®šåœ¨äºåŸºå‡†å…ƒç´ çš„é€‰æ‹©å’Œæ¯”è¾ƒçš„æ–¹å¼ï¼Œå¯èƒ½é€ æˆå€¼ç›¸åŒçš„å…ƒç´ åœ¨æ’åºåç›¸å¯¹ä½ç½®å‘ç”Ÿäº†å˜åŒ–ï¼ŒSafariã€Firefoxè¿™ä¸¤çš„å¼•æ“è¡¨ç¤ºä¸èƒ½æ¥å—ï¼Œé€‰æ‹©äº†ç”¨å½’å¹¶æ’åºæ¥å®ç°ã€‚</p>\n<blockquote>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">&gt; The array is sorted on the key correctly, but where there are duplicate values</div><div class=\"line\">&gt; for the key, the original order is NOT preserved.</div><div class=\"line\">&gt;</div></pre></td></tr></table></figure>\n</blockquote>\n<p>æ¥è‡ªå¤šå¹´å‰Bugzillaä¸Šçš„è¿™ç¯‡<a href=\"https://bugzilla.mozilla.org/show_bug.cgi?id=224128\">report</a>ã€‚ä¸€ä¸ªå«<em>Martin Thomson</em>çš„äººæå‡ºçš„bugã€‚</p>\n<p>IEçš„å®ç°åˆ™åŒæ ·æ˜¯ç¨³å®šæ’åºï¼ˆæµ‹è¯•å¦‚æ­¤ï¼‰ï¼Œä¸è¿‡å¹¶æ²¡æœ‰æ‰¾åˆ°ç”¨äº†ä»€ä¹ˆæ’åºæ–¹æ³•ã€‚</p>\n<hr>\n<p>å¼•æ“èƒŒåçš„å®ç°å…¶å®ä¸å¿…å¤ªå…³å¿ƒã€‚</p>\n<p>sortçš„ä½¿ç”¨æ¥å¤ä¹ ä¸€éã€‚åˆ—ä¸€ä¸ªå¾ˆå¤šä¸ç†Ÿæ‚‰Apiçš„ç¨‹åºå‘˜å¸¸çŠ¯çš„é”™è¯¯ï¼Œå”¯ä¸€çš„ä¸€ä¸ªå¯é€‰çš„å‚æ•°å¹¶ä¸æ˜¯æ–­è¨€ï¼Œè¯¥å‡½æ•°éœ€è¦è¿”å›ä¸‰ä¸ªå¯èƒ½çš„å€¼ï¼Œä¾‹ï¼š</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">foo.sort(<span class=\"function\">(<span class=\"params\">a, b</span>)=&gt;</span>&#123;<span class=\"keyword\">return</span> a -  b&#125;)</div></pre></td></tr></table></figure>\n<ul>\n<li>è‹¥è¿”å›å€¼å¤§äº0ï¼Œaåœ¨bå</li>\n<li>è‹¥è¿”å›å€¼ç­‰äº0ï¼Œä½ç½®ä¸å˜</li>\n<li>è‹¥è¿”å›å€¼å°äº0ï¼Œaåœ¨bå‰</li>\n</ul>\n<p>å¦‚æœä¼ å…¥æ–­è¨€ï¼Œè¿”å›å€¼åªå¯èƒ½å¤§äº0æˆ–ç­‰äº0ï¼Œæ˜¾ç„¶å¾—ä¸åˆ°æƒ³è¦çš„ç»“æœã€‚</p>\n<p>å¹¶ä¸”è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œæ¯”è¾ƒçš„æ˜¯æ•°ç»„å…ƒç´ çš„unicodeç¼–ç ï¼Œå¿½ç•¥è¿™ä¸€ç‚¹ä¼šå¯¹ä¸‹é¢è¿™ä¸ªæ•°ç»„çš„æ’åºç–‘æƒ‘ï¼ˆå¹¶ä¸æ˜¯æƒ³åƒä¸­çš„ä»å°åˆ°å¤§æ’åºï¼‰ã€‚</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">[<span class=\"number\">2</span>,<span class=\"number\">1</span>,<span class=\"number\">10</span>].sort() <span class=\"comment\">// [1,10,2]</span></div></pre></td></tr></table></figure>\n<p>ï¼ˆå®Œï¼‰</p>\n"},{"title":"vimå¯åŠ¨å¤±è´¥`Library not loadedÂ `","date":"2016-06-15T04:06:26.000Z","_content":"\n## é—®é¢˜\n\n```\n`=\\> vim .vimrc\ndyld: Library not loaded: /usr/local/lib/libruby.2.2.0.dylib\n  Referenced from: /usr/local/bin/vim\n  Reason: image not found\n[1]()    85018 trace trap  vim .vimrc\n```\n\\`\n## è§£å†³åŠæ³•\n```\n`brew update\nbrew uninstall --force ruby\nbrew uninstall --force openssl\nbrew install openssl\nbrew link openssl --force\nbrew install rbenv\nrbenv install 2.2.0\nrbenv global 2.2.0\necho 'export PATH=/usr/local/bin:$PATH' \\>\\> /.zshrc\necho 'export PATH=$HOME/.rbenv/shims:$PATH' \\>\\> /.zshrc\nCONFIGURE_OPTS=\"--disable-install-rdoc --enable-shared\" rbenv install 2.2.0\nsudo ln -s /.rbenv/versions/2.2.0 /usr/local/opt/ruby\n```\n\\`\nå†é‡è£…vim\n\n`sudo brew install vim`\n\næ®è¯´`brew update`å¤±è´¥çš„è§£å†³åŠæ³•ä¹Ÿæ˜¯`brew update`ï¼ŒğŸ™„ï¸ã€‚\n","source":"_posts/vimå¯åŠ¨å¤±è´¥.md","raw":"---\ntitle: vimå¯åŠ¨å¤±è´¥`Library not loadedÂ `\ndate: 2016-06-15 12:06:26\ntags:\n---\n\n## é—®é¢˜\n\n```\n`=\\> vim .vimrc\ndyld: Library not loaded: /usr/local/lib/libruby.2.2.0.dylib\n  Referenced from: /usr/local/bin/vim\n  Reason: image not found\n[1]()    85018 trace trap  vim .vimrc\n```\n\\`\n## è§£å†³åŠæ³•\n```\n`brew update\nbrew uninstall --force ruby\nbrew uninstall --force openssl\nbrew install openssl\nbrew link openssl --force\nbrew install rbenv\nrbenv install 2.2.0\nrbenv global 2.2.0\necho 'export PATH=/usr/local/bin:$PATH' \\>\\> /.zshrc\necho 'export PATH=$HOME/.rbenv/shims:$PATH' \\>\\> /.zshrc\nCONFIGURE_OPTS=\"--disable-install-rdoc --enable-shared\" rbenv install 2.2.0\nsudo ln -s /.rbenv/versions/2.2.0 /usr/local/opt/ruby\n```\n\\`\nå†é‡è£…vim\n\n`sudo brew install vim`\n\næ®è¯´`brew update`å¤±è´¥çš„è§£å†³åŠæ³•ä¹Ÿæ˜¯`brew update`ï¼ŒğŸ™„ï¸ã€‚\n","slug":"vimå¯åŠ¨å¤±è´¥","published":1,"updated":"2016-11-16T05:40:00.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ciwu2eolg00044n9ktbtud9ec","content":"<h2 id=\"é—®é¢˜\"><a href=\"#é—®é¢˜\" class=\"headerlink\" title=\"é—®é¢˜\"></a>é—®é¢˜</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">`=\\&gt; vim .vimrc</div><div class=\"line\">dyld: Library not loaded: /usr/local/lib/libruby.2.2.0.dylib</div><div class=\"line\">  Referenced from: /usr/local/bin/vim</div><div class=\"line\">  Reason: image not found</div><div class=\"line\">[1]()    85018 trace trap  vim .vimrc</div></pre></td></tr></table></figure>\n<p>`</p>\n<h2 id=\"è§£å†³åŠæ³•\"><a href=\"#è§£å†³åŠæ³•\" class=\"headerlink\" title=\"è§£å†³åŠæ³•\"></a>è§£å†³åŠæ³•</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div></pre></td><td class=\"code\"><pre><div class=\"line\">`brew update</div><div class=\"line\">brew uninstall --force ruby</div><div class=\"line\">brew uninstall --force openssl</div><div class=\"line\">brew install openssl</div><div class=\"line\">brew link openssl --force</div><div class=\"line\">brew install rbenv</div><div class=\"line\">rbenv install 2.2.0</div><div class=\"line\">rbenv global 2.2.0</div><div class=\"line\">echo &apos;export PATH=/usr/local/bin:$PATH&apos; \\&gt;\\&gt; /.zshrc</div><div class=\"line\">echo &apos;export PATH=$HOME/.rbenv/shims:$PATH&apos; \\&gt;\\&gt; /.zshrc</div><div class=\"line\">CONFIGURE_OPTS=&quot;--disable-install-rdoc --enable-shared&quot; rbenv install 2.2.0</div><div class=\"line\">sudo ln -s /.rbenv/versions/2.2.0 /usr/local/opt/ruby</div></pre></td></tr></table></figure>\n<p>`<br>å†é‡è£…vim</p>\n<p><code>sudo brew install vim</code></p>\n<p>æ®è¯´<code>brew update</code>å¤±è´¥çš„è§£å†³åŠæ³•ä¹Ÿæ˜¯<code>brew update</code>ï¼ŒğŸ™„ï¸ã€‚</p>\n","excerpt":"","more":"<h2 id=\"é—®é¢˜\"><a href=\"#é—®é¢˜\" class=\"headerlink\" title=\"é—®é¢˜\"></a>é—®é¢˜</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">`=\\&gt; vim .vimrc</div><div class=\"line\">dyld: Library not loaded: /usr/local/lib/libruby.2.2.0.dylib</div><div class=\"line\">  Referenced from: /usr/local/bin/vim</div><div class=\"line\">  Reason: image not found</div><div class=\"line\">[1]()    85018 trace trap  vim .vimrc</div></pre></td></tr></table></figure>\n<p>`</p>\n<h2 id=\"è§£å†³åŠæ³•\"><a href=\"#è§£å†³åŠæ³•\" class=\"headerlink\" title=\"è§£å†³åŠæ³•\"></a>è§£å†³åŠæ³•</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div></pre></td><td class=\"code\"><pre><div class=\"line\">`brew update</div><div class=\"line\">brew uninstall --force ruby</div><div class=\"line\">brew uninstall --force openssl</div><div class=\"line\">brew install openssl</div><div class=\"line\">brew link openssl --force</div><div class=\"line\">brew install rbenv</div><div class=\"line\">rbenv install 2.2.0</div><div class=\"line\">rbenv global 2.2.0</div><div class=\"line\">echo &apos;export PATH=/usr/local/bin:$PATH&apos; \\&gt;\\&gt; /.zshrc</div><div class=\"line\">echo &apos;export PATH=$HOME/.rbenv/shims:$PATH&apos; \\&gt;\\&gt; /.zshrc</div><div class=\"line\">CONFIGURE_OPTS=&quot;--disable-install-rdoc --enable-shared&quot; rbenv install 2.2.0</div><div class=\"line\">sudo ln -s /.rbenv/versions/2.2.0 /usr/local/opt/ruby</div></pre></td></tr></table></figure>\n<p>`<br>å†é‡è£…vim</p>\n<p><code>sudo brew install vim</code></p>\n<p>æ®è¯´<code>brew update</code>å¤±è´¥çš„è§£å†³åŠæ³•ä¹Ÿæ˜¯<code>brew update</code>ï¼ŒğŸ™„ï¸ã€‚</p>\n"},{"title":"æŸ¯é‡ŒåŒ–çš„æ„ä¹‰","date":"2016-11-12T04:35:26.000Z","_content":"\næœ€è¿‘æŸä¸ªæŠ€æœ¯ç¾¤ä¸­æœ‰äººæ¿€è¿›çš„è¡¨è¾¾ç»ä¸ç”¨**lodash**ï¼Œç§°lodashä½œè€…æ€åº¦å‚²æ…¢ï¼Œè‡ªå·±åªç”¨**ramda**ï¼Œäºæ˜¯æˆ‘å¾ˆå¥½å¥‡ï¼Œç ”ç©¶äº†ä¸€ä¼šramdaï¼Œå¼•ç”³å‡ºä¸‹é¢çš„æ€è€ƒã€‚\n\nç²—ç•¥çœ‹ramdaå®˜æ–¹æ–‡æ¡£ä¸ä¼šè§‰å¾—ä¸lodashæœ‰ä»€ä¹ˆä¸åŒï¼Œä½†å®é™…ä¸Šè¿™ä¸¤è€…çš„è®¾è®¡ç†å¿µå¾ˆä¸ä¸€æ ·ï¼Œå¦‚æœæŠŠå¦ä¸€ä¸ªè‘—åçš„ç±»åº“underscoreä¹Ÿæ”¾åˆ°ä¸€èµ·å¯¹æ¯”ï¼Œå¤§å¤šæ•°äººçš„çœ‹æ³•æ˜¯è¿™æ ·çš„ï¼š\n\n> underscore < lodash < ramda\n\nramdaè¢«ä¸€äº›äººè®¤ä¸ºå¼ºäºlodashçš„ä¸€ä¸ªé‡è¦çš„åŸå› å°±æ˜¯å°†æŸ¯é‡ŒåŒ–çš„æ€æƒ³ä½“ç°åœ¨apiè®¾è®¡ä¸­ã€‚\n\nå®˜æ–¹æè¿°ramdaçš„ä¸»è¦ç‰¹æ€§ä¹Ÿè¯´åˆ°ï¼Œramdaå°±æ˜¯ä¸ºæ­¤è®¾è®¡çš„ï¼š\n\n>* Ramda emphasizes a purer functional style. Immutability and side-effect free functions are at the heart of its design philosophy. This can help you get the job done with simple, elegant code.\n>* Ramda functions are automatically curried. This allows you to easily build up new functions from old ones simply by not supplying the final parameters.\n>* The parameters to Ramda functions are arranged to make it convenient for currying. The data to be operated on is generally supplied last.\n>\n>The last two points together make it very easy to build functions as sequences of simpler functions, each of which transforms the data and passes it along to the next. Ramda is designed to support this style of coding.\n\n## ä»€ä¹ˆæ˜¯æŸ¯é‡ŒåŒ–\n\næŸ¯é‡ŒåŒ–å­˜åœ¨å‡½æ•°å¼ç¼–ç¨‹ä¸­ã€‚åœ¨æ”¯æŒé«˜é˜¶å‡½æ•°ï¼ˆå‚æ•°æˆ–è¿”å›å€¼åŒ…å«å‡½æ•°çš„å‡½æ•°ï¼‰çš„è¯­è¨€é‡Œï¼ˆå¦‚pythonï¼Œjavascriptï¼‰ï¼ŒæŸ¯é‡ŒåŒ–çš„äº§ç”Ÿæ˜¯è‡ªç„¶è€Œç„¶çš„ã€‚\n\næˆ‘ä»¬ç”¨å®ä¾‹æ¥è¯´æ˜ï¼Œè§‚å¯Ÿä»¥ä¸‹pythonä»£ç ï¼š\n\n```Python\na = map(lambda x: x*2, [1,2,3])\nb = map(lambda x: x*2, [4,5,6])\nc = map(lambda x: x*2, [7,8,9])\n```\n\næŠ½è±¡æ˜¯ç¨‹åºå‘˜çš„åŸºæœ¬ç´ å…»ï¼Œä¸Šé¢çš„ä»£ç lambdaå‡½æ•°å¤šæ¬¡ä½¿ç”¨ï¼Œä¸å¤Ÿä¼˜é›…åˆ‡ä¸æ˜“ç»´æŠ¤ï¼Œæˆ‘ä»¬ä¼šæƒ³åˆ°è¿™æ ·æ”¹è¿›ï¼š\n\n```python\ndouble = lambda x: x*2\n\na = map(double, [1,2,3])\nb = map(double, [4,5,6])\nc = map(double, [7,8,9])\n```\n\nå¦‚æ­¤ä¸€æ¥ï¼Œå½“ä¸šåŠ¡é€»è¾‘æœ‰å˜ï¼Œæˆ‘ä»¬åªéœ€è¦ä¿®æ”¹doubleå˜é‡ã€‚\n\nçœ‹ä¸Šå»å·²ç»è¶³å¤Ÿäº†ï¼Œä½†`map(double...`ä¸å¤Ÿè¯­ä¹‰åŒ–ï¼Œè¯•æƒ³åˆ«äººåœ¨è§£è¯»è¿™æ®µä»£ç çš„æ—¶å€™ä¼šè¿™æ ·æƒ³ï¼š\n\nâ€œéå†è¿™ä¸ªlistï¼Œå°†doubleå‡½æ•°ä½œç”¨åœ¨æ¯ä¸€ä¸ªå…ƒç´ ä¸Šï¼Œè¿”å›ä¸€ä¸ªæ–°çš„listã€‚â€\n\nè‹¥ä¸æ˜¯doubleå‡½æ•°åå·²ç»è¶³å¤Ÿè¯­ä¹‰åŒ–ï¼Œæˆ‘ä»¬è¿˜å¾—ç¿»çœ‹doubleå‡½æ•°çš„å®šä¹‰ï¼Œçœ‹çœ‹å®ƒåˆ°åº•åšäº†ä»€ä¹ˆã€‚æ˜¯å¦å¯ä»¥å†æŠ½è±¡ä¸€ç‚¹ï¼Œåƒä¸‹é¢è¿™æ ·è°ƒç”¨ï¼š \n\n```python\na = getEachItemDoubled([1,2,3])\nb = getEachItemDoubled([4,5,6])\nc = getEachItemDoubled([7,8,9])\n```\n\nå‡½æ•°åæ¸…æ™°æ˜ç¡®çš„è¡¨è¾¾äº†ä»£ç çš„æ„å›¾ï¼Œå³ä½¿æˆ‘ä»¬æ²¡æœ‰æ·»åŠ ä»»ä½•æ³¨é‡Šï¼Œè°éƒ½æ˜ç™½`getEachItemDoubled`åšäº†ä»€ä¹ˆã€‚\n\nè¿™æ ·çš„`getEachItemDoubled`å‡½æ•°è¯¥æ€ä¹ˆå®šä¹‰ï¼Ÿ\n\nè€ƒè™‘ä¸‹é¢çš„ä»£ç ã€‚\n\n```Python\ndef curredMap(fn):\n    def p(x):\n        return map(fn, x)\n\treturn p\n\ngetEachItemDoubled = curredMap(lambda x:x*2)\n```\n\n**curredMap**å’Œmapä¸€æ ·ä¹Ÿæ˜¯ä¸ªé«˜é˜¶å‡½æ•°ï¼Œåœ¨è¿™æ®µä»£ç ä¸­éå¸¸é‡è¦ã€‚å¦‚ä¸Šï¼Œç°åœ¨ä½ å¯ä»¥ç”¨ä½ å¸Œæœ›çš„æ–¹å¼ä½¿ç”¨æ›´è¯­ä¹‰çš„`getEachItemDoubled`ã€‚\n\næœ‰äº†`curredMap`å‡½æ•°ï¼Œä½ è¿˜å¯ä»¥è¿™æ ·ï¼š\n\n```python\n# å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºå°†listæ¯ä¸€ä¸ªå…ƒç´ ä¹˜ä»¥3\ngetEachItemTripled = curredMap(lambda x: x*3)\n\n# å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºå°†listæ¯ä¸ªå…ƒç´ å­—ç¬¦ä¸²åŒ–\nstrEachItem = curredMap(lambda x: str(x))\n\na = getEachItemTripled([1,2,3]) # [3, 6, 9]\nb = strEachItem([1,2,3]) # ['1', '2', '3']\n```\n\nçœ‹åˆ°è¿™ä½ å¤§æ¦‚æ˜ç™½äº†ï¼Œç®€è€Œè¨€ä¹‹ï¼ŒæŸ¯é‡ŒåŒ–å°±æ˜¯å‡½æ•°çš„**å±€éƒ¨è°ƒç”¨**ï¼Œä¹Ÿç§°**éƒ¨åˆ†æ±‚å€¼**ï¼Œä¸‹é¢ä¼šè¿›ä¸€æ­¥è§£é‡Šã€‚\n\n## æŸ¯é‡ŒåŒ–çš„æ„ä¹‰\n\nä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å¯¹pythonçš„å†…ç½®å‡½æ•°mapåšäº†**éƒ¨åˆ†æ±‚å€¼**å¾—åˆ°äº†æ›´åŠ æŠ½è±¡çš„`getEachItemDoubled`ã€`getEachItemTripled`ä»¥åŠ`strEachItem`ï¼Œå¤šå‚å‡½æ•°mapå˜æˆäº†ä¸€äº›å•å‚å‡½æ•°ã€‚\n\nåŸç”Ÿmapå‡½æ•°ä¾èµ–ä¸¤ä¸ªå‚æ•°ï¼Œæˆ‘ä»¬æ²¡æœ‰åŠæ³•è¿™æ ·ä½¿ç”¨ï¼š\n\n```python\ngetEachItemDoubled = map(lambda x:x*2)\n# TypeError: map() requires at least two args\n```\n\nç¼–è¯‘å™¨ä¼šæŠ›å‡ºTypeErroré”™è¯¯ã€‚ è¿™æ ·çš„è®¾è®¡åœ¨åˆå­¦è€…çœ‹æ¥éå¸¸ç—›è‹¦ï¼Œæˆ‘éœ€è¦è®°ä½æ¯ä¸€ä¸ªå‡½æ•°å¿…é¡»ä¼ é€’å‡ ä¸ªå‚æ•°å—ï¼Ÿ\n\næŠŠæœ€åˆçš„ä»£ç å’Œæœ€ç»ˆæŸ¯é‡ŒåŒ–åçš„ä»£ç æ”¾åˆ°ä¸€èµ·ï¼š\n\n```\na = map(lambda x: x*2, [1,2,3])\n\na = curredMap(lambda x: x*2)([1,2,3])\n```\n\nmapè¢«æˆ‘ä»¬åšäº†é™é˜¶å¤„ç†ï¼Œè¿™æ ·åšæœ‰ä»€ä¹ˆæ„ä¹‰ï¼Ÿ\n\nå°±ä¸Šé¢çš„ä¾‹å­è€Œè¨€ã€‚\n\n* å¯è¯»æ€§æ›´å¼ºã€‚\n\n\n* æ¥å£ç®€åŒ–ã€‚\n* å¤ç”¨æ€§æ›´é«˜ã€‚\n\næœ€é‡è¦çš„æ˜¯ï¼šä½ ä¸éœ€è¦åœ¨è„‘æµ·é‡Œè®°ä½mapå‡½æ•°å¿…é¡»ä¼ é€’ä¸¤ä¸ªå‚æ•°ï¼Œå°½ç®¡æ”¾å¿ƒä½¿ç”¨`curredMap`ã€‚\n\næˆ‘ä»¬ç°åœ¨å¯ä»¥è¿™ä¹ˆç†è§£**å±€éƒ¨è°ƒç”¨**ï¼šmapå‡½æ•°è¦æ±‚ä¸¤ä¸ªå‚æ•°ï¼Œä½†æˆ‘åªç»™äº†å®ƒä¸€ä¸ªå‚æ•°ï¼Œç†åº”è¿”å›ä¸€ä¸ªèƒ½å¤Ÿæ¥æ”¶ç¬¬äºŒä¸ªå‚æ•°çš„å‡½æ•°ï¼Œæ— è®ºæˆ‘ä½•æ—¶æƒ³è¦ä¼ é€’ç¬¬äºŒä¸ªå‚æ•°ï¼Œå®ƒéƒ½èƒ½æ­£å¸¸å·¥ä½œã€‚è¿™å°±æ˜¯æŸ¯é‡ŒåŒ–å‡ºç°çš„æ„ä¹‰ã€‚\n\nå†ç”¨ä¸€æ®µjsä»£ç æ¥è¯´æ˜ã€‚\n\n```Javascript\nfunction sum(a, b){\n  return a + b\n}\n\n\nfunction cu(x, y){\n  function fn(z){\n    return x + z\n  }\n  if(arguments.length === 1){\n    return fn\n  } \n  return x + y  \n}\n\nsum(1,2)\ncurredSum(1)(2)\n```\n\ncurredSumçœ‹ä¸Šå»å¹¶æ²¡æœ‰æ¯”sumå‡½æ•°å¯è¯»æ€§æ›´å¥½ï¼Œä¹Ÿä¸è§å¾—æ¥å£æ›´ç®€å•ï¼Œä¸¤è€…ä¼¼ä¹æ²¡ä»€ä¹ˆåŒºåˆ«ã€‚\n\nè€ŒcurredSumçš„çœŸæ­£ä¼˜åŠ¿ä½“ç°åœ¨ä¸‹é¢è¿™ç§æƒ…å½¢ä¸­ã€‚\n\n```javascript\n/* æ–¹å¼ä¸€ */\nsum(1,2,3,4)\nsum(1,2,3,7)\nsum(1,2,3,11,12)\nsum(1,2,3,11,12,14)\nsum(1,2,3,11,12,17)\n// ...\n\n/* æ–¹å¼äºŒ */\nvar sixPlus = curredSum(1+2+3)\nsixPlus(4)\nsixPlus(7)\nsixPlus(11)\nvar twentyNinePlus = curredSum(1+2+3+11+12)\ntwentyNinePlus(14)\ntwentyNinePlus(17)\n// ...\n```\n\nè‹¥å‚æ•°è¢«å¤šæ¬¡å¤ç”¨ï¼Œå°±åº”è¯¥æŠ½è±¡å‡ºæ¥ï¼Œæ— è®ºæ€ä¹ˆçœ‹ï¼ŒæŸ¯é‡ŒåŒ–åçš„ä»£ç éƒ½æ›´åŠ å®¹æ˜“ç»´æŠ¤å’Œæ‰©å±•ï¼Œå¹¶ä¸”ä¹Ÿä¸å¤±æ˜“è¯»æ€§ã€‚\n\næœ€åï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹ramdaä¸­çš„æŸ¯é‡ŒåŒ–ã€‚\n\n```javascript\nvar R = require('ramda')\n\nR.append('c', ['a','b']) // -> ['a','b','c']\n/* ä¸‹é¢çš„å‡½æ•°ä½œç”¨æ˜¯ä¸ºæ•°ç»„è¿½åŠ ä¸€ä¸ª'c' */\nvar appendC = R.append('c')\nappendC(['a','b']) // -> ['a','b','c']\nappendC([1,2,3]) // -> [1,2,3,'c']\n\nR.remove(1,2,[1,2,3,4,5]) // -> [1,4]\n/* ä¸‹é¢è¿™ä¸ªå‡½æ•°çš„ä½œç”¨æ˜¯ä»[1,2,3,4,5]å¼€å§‹ä½ç½®å»é™¤xä¸ªæ•°ï¼Œè¿”å›ä¸€ä¸ªæ–°çš„æ•°ç»„ */\n/* R.__åœ¨è¿™é‡Œä½œä¸ºå ä½ç¬¦ï¼Œè¡¨ç¤ºæŸ¯é‡ŒåŒ–åçš„å‡½æ•°å½¢å‚åº”è¯¥ä¼ é€’çš„ä½ç½® */\nvar removeXFromStart = R.remove(0,R.__,[1,2,3,4,5])\nremoveXFromStart(2) // -> [3,4,5]\nremoveXFromStart(4) // -> [5]\n\n/* ä¸‹é¢è¿™ä¸ªæ›´å¤æ‚ä¸€ç‚¹ */\n/* tå‡½æ•°çš„ä½œç”¨æ˜¯å–å‡ºå‚æ•°çš„xå±æ€§å€¼ï¼Œä¹˜2ï¼Œå–å */\nvar t = R.compose(R.negate, x => x*2, R.prop('x'))\nt({\n  x: 100,\n  y: 200,\n  z: 300\n}) // -> -200\nt({\n  x: 1,\n  y: 2\n}) // -> -2\n```\n\nå¦‚æœä½ ç”¨è¿‡lodashï¼Œä½ ä¸€å®šæ¸…æ¥šä¸Šé¢çš„ä¾‹å­å’Œlodashçš„åŒºåˆ«ï¼Œä½†lodashç”¨æˆ·æ˜¯å¦åº”è¯¥ä¸ºæ­¤å°±è¿‡æ¸¡åˆ°ramdaï¼Œæ¨èä½ çœ‹çœ‹Scott Sauyetå†™çš„[why ramda](http://fr.umio.us/why-ramda/)ï¼Œä»¥åŠgoogleä¸€ä¸‹ramdaå’Œlodashçš„æ›´å¤šå¯¹æ¯”å†åšå†³å®šã€‚\n\nå°½ç®¡ä»¥ä¸Šè¯´çš„éƒ½æ˜¯æŸ¯é‡ŒåŒ–ä¸ºå‡½æ•°å¼ç¼–ç¨‹å¸¦æ¥çš„å¥½å¤„ï¼Œæˆ‘è¿˜æ˜¯å¾—è¯´ï¼Œç†æ™ºçš„ç¨‹åºå‘˜è¿˜æ˜¯åº”è¯¥è°¨æ…ä½¿ç”¨è¿™ç§ç¼–ç¨‹æ–¹æ³•ã€‚\n\nä¸è¯¥ä½¿ç”¨æŸ¯é‡ŒåŒ–çš„åœºæ™¯ä¹‹ä¸€æ˜¯ï¼šå‡½æ•°çš„å‚æ•°æ€»æ˜¯éœ€è¦å¤šä¸ªåŒæ—¶ä¼ é€’ï¼Œå¦åˆ™å‡½æ•°æœ¬èº«çš„è¯­ä¹‰å°±ä¸æ˜ç¡®ï¼Œæˆ–è€…è¢«ç ´åã€‚ä¾‹å¦‚ä¸€ä¸ªå‡½æ•°å®šä¹‰ä¸ºæ ‡å‡ºåœ°å›¾ä¸Šçš„ç‚¹ï¼Œå¾€å¾€åœ¨ä½¿ç”¨å®ƒçš„æ—¶å€™ç»åº¦å’Œçº¬åº¦ä¼šåŒæ—¶ä¼ å…¥ï¼Œæ— è®ºä½ åªä¼ å…¥ç»åº¦è¿˜æ˜¯çº¬åº¦éƒ½æ˜¾å¾—å¾ˆåˆ«æ‰­ï¼ŒæŸ¯é‡ŒåŒ–è¿™æ ·çš„å‡½æ•°æ²¡æœ‰æ„ä¹‰ï¼Œçº¯ç²¹ç”»è›‡æ·»è¶³ã€‚\n\nå¦å¤–ï¼Œæˆ‘ä»¬åº”è¯¥æ€è€ƒï¼Œæ—¢ç„¶æŸ¯é‡ŒåŒ–è®©ä¸€åˆ‡é‚£ä¹ˆç¾å¥½ï¼Œå¾ˆå¤šè¯­è¨€è®¾è®¡ä¹‹åˆä¸ºä»€ä¹ˆè®©å‡½æ•°å¯ä»¥å®šä¹‰å¤šä¸ªå½¢å‚ï¼Œä¸ºä»€ä¹ˆåœ¨è¿™ä¹‹ä¸Šæ›´è¡ç”Ÿå‡ºäº†é»˜è®¤å‚æ•°ã€å¯å˜å‚æ•°ã€å…³é”®å­—å‚æ•°ï¼Ÿå‚æ•°å®šä¹‰å¦‚æ­¤çµæ´»æ˜¯å¥½æ˜¯åï¼Ÿ\n\npythonç”±äºtupleè¿™ç§æ•°æ®ç±»å‹çš„å­˜åœ¨ï¼Œä½¿å¾—å¤šå‚å‡½æ•°è½»æ˜“çš„æ¥å—ä¸€ä¸ªæ··åˆè¿‡åçš„tupleä½œä¸ºå‚æ•°ï¼Œå¹¶å°†å…¶å±•å¼€ä¸ºå¤šä¸ªå‚æ•°ï¼Œä»¿ä½›å‡½æ•°å®šä¹‰æ—¶çš„å‚æ•°ä¸ªæ•°æ¯«æ— çº¦æŸæ€§ï¼Œå¤šå‚å‡½æ•°ä»ç„¶å¯ä»¥åƒå•å‚å‡½æ•°ä¸€æ ·ä½¿ç”¨ï¼Œè€ƒé‡ä¸€ä¸ªå‡½æ•°åº”è¯¥å®šä¹‰å¤šå‚è¿˜æ˜¯å•å‚åœ¨pythoné‡Œä¼¼ä¹å¹¶ä¸é‡è¦äº†ï¼Œä¸ªäººçˆ±å¥½è¿™æ—¶å€™é«˜äºä¸€åˆ‡ã€‚ä»ç„¶æœ‰å¾ˆå¤šä½¿ç”¨å¤šå‚å‡½æ•°çš„åœºæ™¯ï¼Œå¤§å¤šæ•°äººå¯ä»¥ç†Ÿç»ƒçš„å°†å‚æ•°æå‰ç»„åˆï¼ŒæŸ¯é‡ŒåŒ–åªä¸è¿‡æŠŠæ­¥éª¤åˆ†è§£äº†ã€‚\n\nåœ¨æˆ‘çœ‹æ¥ï¼Œåº”ä¸åº”è¯¥æŸ¯é‡ŒåŒ–ï¼Œåªéœ€è€ƒé‡ä¸€ç‚¹ï¼Œå±€éƒ¨è°ƒç”¨è¿™ä¸ªå‡½æ•°æ˜¯å¦æ„ä¹‰æ›´æ˜ç¡®ã€‚\n\nå¼ºè¡ŒæŸ¯é‡ŒåŒ–ä¹Ÿå¯èƒ½æ˜¯ç¾éš¾ã€‚\n","source":"_posts/æŸ¯é‡ŒåŒ–çš„æ„ä¹‰.md","raw":"---\ntitle: æŸ¯é‡ŒåŒ–çš„æ„ä¹‰\ndate: 2016-11-12 12:35:26\ntags:\n---\n\næœ€è¿‘æŸä¸ªæŠ€æœ¯ç¾¤ä¸­æœ‰äººæ¿€è¿›çš„è¡¨è¾¾ç»ä¸ç”¨**lodash**ï¼Œç§°lodashä½œè€…æ€åº¦å‚²æ…¢ï¼Œè‡ªå·±åªç”¨**ramda**ï¼Œäºæ˜¯æˆ‘å¾ˆå¥½å¥‡ï¼Œç ”ç©¶äº†ä¸€ä¼šramdaï¼Œå¼•ç”³å‡ºä¸‹é¢çš„æ€è€ƒã€‚\n\nç²—ç•¥çœ‹ramdaå®˜æ–¹æ–‡æ¡£ä¸ä¼šè§‰å¾—ä¸lodashæœ‰ä»€ä¹ˆä¸åŒï¼Œä½†å®é™…ä¸Šè¿™ä¸¤è€…çš„è®¾è®¡ç†å¿µå¾ˆä¸ä¸€æ ·ï¼Œå¦‚æœæŠŠå¦ä¸€ä¸ªè‘—åçš„ç±»åº“underscoreä¹Ÿæ”¾åˆ°ä¸€èµ·å¯¹æ¯”ï¼Œå¤§å¤šæ•°äººçš„çœ‹æ³•æ˜¯è¿™æ ·çš„ï¼š\n\n> underscore < lodash < ramda\n\nramdaè¢«ä¸€äº›äººè®¤ä¸ºå¼ºäºlodashçš„ä¸€ä¸ªé‡è¦çš„åŸå› å°±æ˜¯å°†æŸ¯é‡ŒåŒ–çš„æ€æƒ³ä½“ç°åœ¨apiè®¾è®¡ä¸­ã€‚\n\nå®˜æ–¹æè¿°ramdaçš„ä¸»è¦ç‰¹æ€§ä¹Ÿè¯´åˆ°ï¼Œramdaå°±æ˜¯ä¸ºæ­¤è®¾è®¡çš„ï¼š\n\n>* Ramda emphasizes a purer functional style. Immutability and side-effect free functions are at the heart of its design philosophy. This can help you get the job done with simple, elegant code.\n>* Ramda functions are automatically curried. This allows you to easily build up new functions from old ones simply by not supplying the final parameters.\n>* The parameters to Ramda functions are arranged to make it convenient for currying. The data to be operated on is generally supplied last.\n>\n>The last two points together make it very easy to build functions as sequences of simpler functions, each of which transforms the data and passes it along to the next. Ramda is designed to support this style of coding.\n\n## ä»€ä¹ˆæ˜¯æŸ¯é‡ŒåŒ–\n\næŸ¯é‡ŒåŒ–å­˜åœ¨å‡½æ•°å¼ç¼–ç¨‹ä¸­ã€‚åœ¨æ”¯æŒé«˜é˜¶å‡½æ•°ï¼ˆå‚æ•°æˆ–è¿”å›å€¼åŒ…å«å‡½æ•°çš„å‡½æ•°ï¼‰çš„è¯­è¨€é‡Œï¼ˆå¦‚pythonï¼Œjavascriptï¼‰ï¼ŒæŸ¯é‡ŒåŒ–çš„äº§ç”Ÿæ˜¯è‡ªç„¶è€Œç„¶çš„ã€‚\n\næˆ‘ä»¬ç”¨å®ä¾‹æ¥è¯´æ˜ï¼Œè§‚å¯Ÿä»¥ä¸‹pythonä»£ç ï¼š\n\n```Python\na = map(lambda x: x*2, [1,2,3])\nb = map(lambda x: x*2, [4,5,6])\nc = map(lambda x: x*2, [7,8,9])\n```\n\næŠ½è±¡æ˜¯ç¨‹åºå‘˜çš„åŸºæœ¬ç´ å…»ï¼Œä¸Šé¢çš„ä»£ç lambdaå‡½æ•°å¤šæ¬¡ä½¿ç”¨ï¼Œä¸å¤Ÿä¼˜é›…åˆ‡ä¸æ˜“ç»´æŠ¤ï¼Œæˆ‘ä»¬ä¼šæƒ³åˆ°è¿™æ ·æ”¹è¿›ï¼š\n\n```python\ndouble = lambda x: x*2\n\na = map(double, [1,2,3])\nb = map(double, [4,5,6])\nc = map(double, [7,8,9])\n```\n\nå¦‚æ­¤ä¸€æ¥ï¼Œå½“ä¸šåŠ¡é€»è¾‘æœ‰å˜ï¼Œæˆ‘ä»¬åªéœ€è¦ä¿®æ”¹doubleå˜é‡ã€‚\n\nçœ‹ä¸Šå»å·²ç»è¶³å¤Ÿäº†ï¼Œä½†`map(double...`ä¸å¤Ÿè¯­ä¹‰åŒ–ï¼Œè¯•æƒ³åˆ«äººåœ¨è§£è¯»è¿™æ®µä»£ç çš„æ—¶å€™ä¼šè¿™æ ·æƒ³ï¼š\n\nâ€œéå†è¿™ä¸ªlistï¼Œå°†doubleå‡½æ•°ä½œç”¨åœ¨æ¯ä¸€ä¸ªå…ƒç´ ä¸Šï¼Œè¿”å›ä¸€ä¸ªæ–°çš„listã€‚â€\n\nè‹¥ä¸æ˜¯doubleå‡½æ•°åå·²ç»è¶³å¤Ÿè¯­ä¹‰åŒ–ï¼Œæˆ‘ä»¬è¿˜å¾—ç¿»çœ‹doubleå‡½æ•°çš„å®šä¹‰ï¼Œçœ‹çœ‹å®ƒåˆ°åº•åšäº†ä»€ä¹ˆã€‚æ˜¯å¦å¯ä»¥å†æŠ½è±¡ä¸€ç‚¹ï¼Œåƒä¸‹é¢è¿™æ ·è°ƒç”¨ï¼š \n\n```python\na = getEachItemDoubled([1,2,3])\nb = getEachItemDoubled([4,5,6])\nc = getEachItemDoubled([7,8,9])\n```\n\nå‡½æ•°åæ¸…æ™°æ˜ç¡®çš„è¡¨è¾¾äº†ä»£ç çš„æ„å›¾ï¼Œå³ä½¿æˆ‘ä»¬æ²¡æœ‰æ·»åŠ ä»»ä½•æ³¨é‡Šï¼Œè°éƒ½æ˜ç™½`getEachItemDoubled`åšäº†ä»€ä¹ˆã€‚\n\nè¿™æ ·çš„`getEachItemDoubled`å‡½æ•°è¯¥æ€ä¹ˆå®šä¹‰ï¼Ÿ\n\nè€ƒè™‘ä¸‹é¢çš„ä»£ç ã€‚\n\n```Python\ndef curredMap(fn):\n    def p(x):\n        return map(fn, x)\n\treturn p\n\ngetEachItemDoubled = curredMap(lambda x:x*2)\n```\n\n**curredMap**å’Œmapä¸€æ ·ä¹Ÿæ˜¯ä¸ªé«˜é˜¶å‡½æ•°ï¼Œåœ¨è¿™æ®µä»£ç ä¸­éå¸¸é‡è¦ã€‚å¦‚ä¸Šï¼Œç°åœ¨ä½ å¯ä»¥ç”¨ä½ å¸Œæœ›çš„æ–¹å¼ä½¿ç”¨æ›´è¯­ä¹‰çš„`getEachItemDoubled`ã€‚\n\næœ‰äº†`curredMap`å‡½æ•°ï¼Œä½ è¿˜å¯ä»¥è¿™æ ·ï¼š\n\n```python\n# å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºå°†listæ¯ä¸€ä¸ªå…ƒç´ ä¹˜ä»¥3\ngetEachItemTripled = curredMap(lambda x: x*3)\n\n# å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºå°†listæ¯ä¸ªå…ƒç´ å­—ç¬¦ä¸²åŒ–\nstrEachItem = curredMap(lambda x: str(x))\n\na = getEachItemTripled([1,2,3]) # [3, 6, 9]\nb = strEachItem([1,2,3]) # ['1', '2', '3']\n```\n\nçœ‹åˆ°è¿™ä½ å¤§æ¦‚æ˜ç™½äº†ï¼Œç®€è€Œè¨€ä¹‹ï¼ŒæŸ¯é‡ŒåŒ–å°±æ˜¯å‡½æ•°çš„**å±€éƒ¨è°ƒç”¨**ï¼Œä¹Ÿç§°**éƒ¨åˆ†æ±‚å€¼**ï¼Œä¸‹é¢ä¼šè¿›ä¸€æ­¥è§£é‡Šã€‚\n\n## æŸ¯é‡ŒåŒ–çš„æ„ä¹‰\n\nä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å¯¹pythonçš„å†…ç½®å‡½æ•°mapåšäº†**éƒ¨åˆ†æ±‚å€¼**å¾—åˆ°äº†æ›´åŠ æŠ½è±¡çš„`getEachItemDoubled`ã€`getEachItemTripled`ä»¥åŠ`strEachItem`ï¼Œå¤šå‚å‡½æ•°mapå˜æˆäº†ä¸€äº›å•å‚å‡½æ•°ã€‚\n\nåŸç”Ÿmapå‡½æ•°ä¾èµ–ä¸¤ä¸ªå‚æ•°ï¼Œæˆ‘ä»¬æ²¡æœ‰åŠæ³•è¿™æ ·ä½¿ç”¨ï¼š\n\n```python\ngetEachItemDoubled = map(lambda x:x*2)\n# TypeError: map() requires at least two args\n```\n\nç¼–è¯‘å™¨ä¼šæŠ›å‡ºTypeErroré”™è¯¯ã€‚ è¿™æ ·çš„è®¾è®¡åœ¨åˆå­¦è€…çœ‹æ¥éå¸¸ç—›è‹¦ï¼Œæˆ‘éœ€è¦è®°ä½æ¯ä¸€ä¸ªå‡½æ•°å¿…é¡»ä¼ é€’å‡ ä¸ªå‚æ•°å—ï¼Ÿ\n\næŠŠæœ€åˆçš„ä»£ç å’Œæœ€ç»ˆæŸ¯é‡ŒåŒ–åçš„ä»£ç æ”¾åˆ°ä¸€èµ·ï¼š\n\n```\na = map(lambda x: x*2, [1,2,3])\n\na = curredMap(lambda x: x*2)([1,2,3])\n```\n\nmapè¢«æˆ‘ä»¬åšäº†é™é˜¶å¤„ç†ï¼Œè¿™æ ·åšæœ‰ä»€ä¹ˆæ„ä¹‰ï¼Ÿ\n\nå°±ä¸Šé¢çš„ä¾‹å­è€Œè¨€ã€‚\n\n* å¯è¯»æ€§æ›´å¼ºã€‚\n\n\n* æ¥å£ç®€åŒ–ã€‚\n* å¤ç”¨æ€§æ›´é«˜ã€‚\n\næœ€é‡è¦çš„æ˜¯ï¼šä½ ä¸éœ€è¦åœ¨è„‘æµ·é‡Œè®°ä½mapå‡½æ•°å¿…é¡»ä¼ é€’ä¸¤ä¸ªå‚æ•°ï¼Œå°½ç®¡æ”¾å¿ƒä½¿ç”¨`curredMap`ã€‚\n\næˆ‘ä»¬ç°åœ¨å¯ä»¥è¿™ä¹ˆç†è§£**å±€éƒ¨è°ƒç”¨**ï¼šmapå‡½æ•°è¦æ±‚ä¸¤ä¸ªå‚æ•°ï¼Œä½†æˆ‘åªç»™äº†å®ƒä¸€ä¸ªå‚æ•°ï¼Œç†åº”è¿”å›ä¸€ä¸ªèƒ½å¤Ÿæ¥æ”¶ç¬¬äºŒä¸ªå‚æ•°çš„å‡½æ•°ï¼Œæ— è®ºæˆ‘ä½•æ—¶æƒ³è¦ä¼ é€’ç¬¬äºŒä¸ªå‚æ•°ï¼Œå®ƒéƒ½èƒ½æ­£å¸¸å·¥ä½œã€‚è¿™å°±æ˜¯æŸ¯é‡ŒåŒ–å‡ºç°çš„æ„ä¹‰ã€‚\n\nå†ç”¨ä¸€æ®µjsä»£ç æ¥è¯´æ˜ã€‚\n\n```Javascript\nfunction sum(a, b){\n  return a + b\n}\n\n\nfunction cu(x, y){\n  function fn(z){\n    return x + z\n  }\n  if(arguments.length === 1){\n    return fn\n  } \n  return x + y  \n}\n\nsum(1,2)\ncurredSum(1)(2)\n```\n\ncurredSumçœ‹ä¸Šå»å¹¶æ²¡æœ‰æ¯”sumå‡½æ•°å¯è¯»æ€§æ›´å¥½ï¼Œä¹Ÿä¸è§å¾—æ¥å£æ›´ç®€å•ï¼Œä¸¤è€…ä¼¼ä¹æ²¡ä»€ä¹ˆåŒºåˆ«ã€‚\n\nè€ŒcurredSumçš„çœŸæ­£ä¼˜åŠ¿ä½“ç°åœ¨ä¸‹é¢è¿™ç§æƒ…å½¢ä¸­ã€‚\n\n```javascript\n/* æ–¹å¼ä¸€ */\nsum(1,2,3,4)\nsum(1,2,3,7)\nsum(1,2,3,11,12)\nsum(1,2,3,11,12,14)\nsum(1,2,3,11,12,17)\n// ...\n\n/* æ–¹å¼äºŒ */\nvar sixPlus = curredSum(1+2+3)\nsixPlus(4)\nsixPlus(7)\nsixPlus(11)\nvar twentyNinePlus = curredSum(1+2+3+11+12)\ntwentyNinePlus(14)\ntwentyNinePlus(17)\n// ...\n```\n\nè‹¥å‚æ•°è¢«å¤šæ¬¡å¤ç”¨ï¼Œå°±åº”è¯¥æŠ½è±¡å‡ºæ¥ï¼Œæ— è®ºæ€ä¹ˆçœ‹ï¼ŒæŸ¯é‡ŒåŒ–åçš„ä»£ç éƒ½æ›´åŠ å®¹æ˜“ç»´æŠ¤å’Œæ‰©å±•ï¼Œå¹¶ä¸”ä¹Ÿä¸å¤±æ˜“è¯»æ€§ã€‚\n\næœ€åï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹ramdaä¸­çš„æŸ¯é‡ŒåŒ–ã€‚\n\n```javascript\nvar R = require('ramda')\n\nR.append('c', ['a','b']) // -> ['a','b','c']\n/* ä¸‹é¢çš„å‡½æ•°ä½œç”¨æ˜¯ä¸ºæ•°ç»„è¿½åŠ ä¸€ä¸ª'c' */\nvar appendC = R.append('c')\nappendC(['a','b']) // -> ['a','b','c']\nappendC([1,2,3]) // -> [1,2,3,'c']\n\nR.remove(1,2,[1,2,3,4,5]) // -> [1,4]\n/* ä¸‹é¢è¿™ä¸ªå‡½æ•°çš„ä½œç”¨æ˜¯ä»[1,2,3,4,5]å¼€å§‹ä½ç½®å»é™¤xä¸ªæ•°ï¼Œè¿”å›ä¸€ä¸ªæ–°çš„æ•°ç»„ */\n/* R.__åœ¨è¿™é‡Œä½œä¸ºå ä½ç¬¦ï¼Œè¡¨ç¤ºæŸ¯é‡ŒåŒ–åçš„å‡½æ•°å½¢å‚åº”è¯¥ä¼ é€’çš„ä½ç½® */\nvar removeXFromStart = R.remove(0,R.__,[1,2,3,4,5])\nremoveXFromStart(2) // -> [3,4,5]\nremoveXFromStart(4) // -> [5]\n\n/* ä¸‹é¢è¿™ä¸ªæ›´å¤æ‚ä¸€ç‚¹ */\n/* tå‡½æ•°çš„ä½œç”¨æ˜¯å–å‡ºå‚æ•°çš„xå±æ€§å€¼ï¼Œä¹˜2ï¼Œå–å */\nvar t = R.compose(R.negate, x => x*2, R.prop('x'))\nt({\n  x: 100,\n  y: 200,\n  z: 300\n}) // -> -200\nt({\n  x: 1,\n  y: 2\n}) // -> -2\n```\n\nå¦‚æœä½ ç”¨è¿‡lodashï¼Œä½ ä¸€å®šæ¸…æ¥šä¸Šé¢çš„ä¾‹å­å’Œlodashçš„åŒºåˆ«ï¼Œä½†lodashç”¨æˆ·æ˜¯å¦åº”è¯¥ä¸ºæ­¤å°±è¿‡æ¸¡åˆ°ramdaï¼Œæ¨èä½ çœ‹çœ‹Scott Sauyetå†™çš„[why ramda](http://fr.umio.us/why-ramda/)ï¼Œä»¥åŠgoogleä¸€ä¸‹ramdaå’Œlodashçš„æ›´å¤šå¯¹æ¯”å†åšå†³å®šã€‚\n\nå°½ç®¡ä»¥ä¸Šè¯´çš„éƒ½æ˜¯æŸ¯é‡ŒåŒ–ä¸ºå‡½æ•°å¼ç¼–ç¨‹å¸¦æ¥çš„å¥½å¤„ï¼Œæˆ‘è¿˜æ˜¯å¾—è¯´ï¼Œç†æ™ºçš„ç¨‹åºå‘˜è¿˜æ˜¯åº”è¯¥è°¨æ…ä½¿ç”¨è¿™ç§ç¼–ç¨‹æ–¹æ³•ã€‚\n\nä¸è¯¥ä½¿ç”¨æŸ¯é‡ŒåŒ–çš„åœºæ™¯ä¹‹ä¸€æ˜¯ï¼šå‡½æ•°çš„å‚æ•°æ€»æ˜¯éœ€è¦å¤šä¸ªåŒæ—¶ä¼ é€’ï¼Œå¦åˆ™å‡½æ•°æœ¬èº«çš„è¯­ä¹‰å°±ä¸æ˜ç¡®ï¼Œæˆ–è€…è¢«ç ´åã€‚ä¾‹å¦‚ä¸€ä¸ªå‡½æ•°å®šä¹‰ä¸ºæ ‡å‡ºåœ°å›¾ä¸Šçš„ç‚¹ï¼Œå¾€å¾€åœ¨ä½¿ç”¨å®ƒçš„æ—¶å€™ç»åº¦å’Œçº¬åº¦ä¼šåŒæ—¶ä¼ å…¥ï¼Œæ— è®ºä½ åªä¼ å…¥ç»åº¦è¿˜æ˜¯çº¬åº¦éƒ½æ˜¾å¾—å¾ˆåˆ«æ‰­ï¼ŒæŸ¯é‡ŒåŒ–è¿™æ ·çš„å‡½æ•°æ²¡æœ‰æ„ä¹‰ï¼Œçº¯ç²¹ç”»è›‡æ·»è¶³ã€‚\n\nå¦å¤–ï¼Œæˆ‘ä»¬åº”è¯¥æ€è€ƒï¼Œæ—¢ç„¶æŸ¯é‡ŒåŒ–è®©ä¸€åˆ‡é‚£ä¹ˆç¾å¥½ï¼Œå¾ˆå¤šè¯­è¨€è®¾è®¡ä¹‹åˆä¸ºä»€ä¹ˆè®©å‡½æ•°å¯ä»¥å®šä¹‰å¤šä¸ªå½¢å‚ï¼Œä¸ºä»€ä¹ˆåœ¨è¿™ä¹‹ä¸Šæ›´è¡ç”Ÿå‡ºäº†é»˜è®¤å‚æ•°ã€å¯å˜å‚æ•°ã€å…³é”®å­—å‚æ•°ï¼Ÿå‚æ•°å®šä¹‰å¦‚æ­¤çµæ´»æ˜¯å¥½æ˜¯åï¼Ÿ\n\npythonç”±äºtupleè¿™ç§æ•°æ®ç±»å‹çš„å­˜åœ¨ï¼Œä½¿å¾—å¤šå‚å‡½æ•°è½»æ˜“çš„æ¥å—ä¸€ä¸ªæ··åˆè¿‡åçš„tupleä½œä¸ºå‚æ•°ï¼Œå¹¶å°†å…¶å±•å¼€ä¸ºå¤šä¸ªå‚æ•°ï¼Œä»¿ä½›å‡½æ•°å®šä¹‰æ—¶çš„å‚æ•°ä¸ªæ•°æ¯«æ— çº¦æŸæ€§ï¼Œå¤šå‚å‡½æ•°ä»ç„¶å¯ä»¥åƒå•å‚å‡½æ•°ä¸€æ ·ä½¿ç”¨ï¼Œè€ƒé‡ä¸€ä¸ªå‡½æ•°åº”è¯¥å®šä¹‰å¤šå‚è¿˜æ˜¯å•å‚åœ¨pythoné‡Œä¼¼ä¹å¹¶ä¸é‡è¦äº†ï¼Œä¸ªäººçˆ±å¥½è¿™æ—¶å€™é«˜äºä¸€åˆ‡ã€‚ä»ç„¶æœ‰å¾ˆå¤šä½¿ç”¨å¤šå‚å‡½æ•°çš„åœºæ™¯ï¼Œå¤§å¤šæ•°äººå¯ä»¥ç†Ÿç»ƒçš„å°†å‚æ•°æå‰ç»„åˆï¼ŒæŸ¯é‡ŒåŒ–åªä¸è¿‡æŠŠæ­¥éª¤åˆ†è§£äº†ã€‚\n\nåœ¨æˆ‘çœ‹æ¥ï¼Œåº”ä¸åº”è¯¥æŸ¯é‡ŒåŒ–ï¼Œåªéœ€è€ƒé‡ä¸€ç‚¹ï¼Œå±€éƒ¨è°ƒç”¨è¿™ä¸ªå‡½æ•°æ˜¯å¦æ„ä¹‰æ›´æ˜ç¡®ã€‚\n\nå¼ºè¡ŒæŸ¯é‡ŒåŒ–ä¹Ÿå¯èƒ½æ˜¯ç¾éš¾ã€‚\n","slug":"æŸ¯é‡ŒåŒ–çš„æ„ä¹‰","published":1,"updated":"2016-11-16T05:40:00.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ciwu2eoll00054n9kvzjc5een","content":"<p>æœ€è¿‘æŸä¸ªæŠ€æœ¯ç¾¤ä¸­æœ‰äººæ¿€è¿›çš„è¡¨è¾¾ç»ä¸ç”¨<strong>lodash</strong>ï¼Œç§°lodashä½œè€…æ€åº¦å‚²æ…¢ï¼Œè‡ªå·±åªç”¨<strong>ramda</strong>ï¼Œäºæ˜¯æˆ‘å¾ˆå¥½å¥‡ï¼Œç ”ç©¶äº†ä¸€ä¼šramdaï¼Œå¼•ç”³å‡ºä¸‹é¢çš„æ€è€ƒã€‚</p>\n<p>ç²—ç•¥çœ‹ramdaå®˜æ–¹æ–‡æ¡£ä¸ä¼šè§‰å¾—ä¸lodashæœ‰ä»€ä¹ˆä¸åŒï¼Œä½†å®é™…ä¸Šè¿™ä¸¤è€…çš„è®¾è®¡ç†å¿µå¾ˆä¸ä¸€æ ·ï¼Œå¦‚æœæŠŠå¦ä¸€ä¸ªè‘—åçš„ç±»åº“underscoreä¹Ÿæ”¾åˆ°ä¸€èµ·å¯¹æ¯”ï¼Œå¤§å¤šæ•°äººçš„çœ‹æ³•æ˜¯è¿™æ ·çš„ï¼š</p>\n<blockquote>\n<p>underscore &lt; lodash &lt; ramda</p>\n</blockquote>\n<p>ramdaè¢«ä¸€äº›äººè®¤ä¸ºå¼ºäºlodashçš„ä¸€ä¸ªé‡è¦çš„åŸå› å°±æ˜¯å°†æŸ¯é‡ŒåŒ–çš„æ€æƒ³ä½“ç°åœ¨apiè®¾è®¡ä¸­ã€‚</p>\n<p>å®˜æ–¹æè¿°ramdaçš„ä¸»è¦ç‰¹æ€§ä¹Ÿè¯´åˆ°ï¼Œramdaå°±æ˜¯ä¸ºæ­¤è®¾è®¡çš„ï¼š</p>\n<blockquote>\n<ul>\n<li>Ramda emphasizes a purer functional style. Immutability and side-effect free functions are at the heart of its design philosophy. This can help you get the job done with simple, elegant code.</li>\n<li>Ramda functions are automatically curried. This allows you to easily build up new functions from old ones simply by not supplying the final parameters.</li>\n<li>The parameters to Ramda functions are arranged to make it convenient for currying. The data to be operated on is generally supplied last.</li>\n</ul>\n<p>The last two points together make it very easy to build functions as sequences of simpler functions, each of which transforms the data and passes it along to the next. Ramda is designed to support this style of coding.</p>\n</blockquote>\n<h2 id=\"ä»€ä¹ˆæ˜¯æŸ¯é‡ŒåŒ–\"><a href=\"#ä»€ä¹ˆæ˜¯æŸ¯é‡ŒåŒ–\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯æŸ¯é‡ŒåŒ–\"></a>ä»€ä¹ˆæ˜¯æŸ¯é‡ŒåŒ–</h2><p>æŸ¯é‡ŒåŒ–å­˜åœ¨å‡½æ•°å¼ç¼–ç¨‹ä¸­ã€‚åœ¨æ”¯æŒé«˜é˜¶å‡½æ•°ï¼ˆå‚æ•°æˆ–è¿”å›å€¼åŒ…å«å‡½æ•°çš„å‡½æ•°ï¼‰çš„è¯­è¨€é‡Œï¼ˆå¦‚pythonï¼Œjavascriptï¼‰ï¼ŒæŸ¯é‡ŒåŒ–çš„äº§ç”Ÿæ˜¯è‡ªç„¶è€Œç„¶çš„ã€‚</p>\n<p>æˆ‘ä»¬ç”¨å®ä¾‹æ¥è¯´æ˜ï¼Œè§‚å¯Ÿä»¥ä¸‹pythonä»£ç ï¼š</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">a = map(<span class=\"keyword\">lambda</span> x: x*<span class=\"number\">2</span>, [<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>])</div><div class=\"line\">b = map(<span class=\"keyword\">lambda</span> x: x*<span class=\"number\">2</span>, [<span class=\"number\">4</span>,<span class=\"number\">5</span>,<span class=\"number\">6</span>])</div><div class=\"line\">c = map(<span class=\"keyword\">lambda</span> x: x*<span class=\"number\">2</span>, [<span class=\"number\">7</span>,<span class=\"number\">8</span>,<span class=\"number\">9</span>])</div></pre></td></tr></table></figure>\n<p>æŠ½è±¡æ˜¯ç¨‹åºå‘˜çš„åŸºæœ¬ç´ å…»ï¼Œä¸Šé¢çš„ä»£ç lambdaå‡½æ•°å¤šæ¬¡ä½¿ç”¨ï¼Œä¸å¤Ÿä¼˜é›…åˆ‡ä¸æ˜“ç»´æŠ¤ï¼Œæˆ‘ä»¬ä¼šæƒ³åˆ°è¿™æ ·æ”¹è¿›ï¼š</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">double = <span class=\"keyword\">lambda</span> x: x*<span class=\"number\">2</span></div><div class=\"line\"></div><div class=\"line\">a = map(double, [<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>])</div><div class=\"line\">b = map(double, [<span class=\"number\">4</span>,<span class=\"number\">5</span>,<span class=\"number\">6</span>])</div><div class=\"line\">c = map(double, [<span class=\"number\">7</span>,<span class=\"number\">8</span>,<span class=\"number\">9</span>])</div></pre></td></tr></table></figure>\n<p>å¦‚æ­¤ä¸€æ¥ï¼Œå½“ä¸šåŠ¡é€»è¾‘æœ‰å˜ï¼Œæˆ‘ä»¬åªéœ€è¦ä¿®æ”¹doubleå˜é‡ã€‚</p>\n<p>çœ‹ä¸Šå»å·²ç»è¶³å¤Ÿäº†ï¼Œä½†<code>map(double...</code>ä¸å¤Ÿè¯­ä¹‰åŒ–ï¼Œè¯•æƒ³åˆ«äººåœ¨è§£è¯»è¿™æ®µä»£ç çš„æ—¶å€™ä¼šè¿™æ ·æƒ³ï¼š</p>\n<p>â€œéå†è¿™ä¸ªlistï¼Œå°†doubleå‡½æ•°ä½œç”¨åœ¨æ¯ä¸€ä¸ªå…ƒç´ ä¸Šï¼Œè¿”å›ä¸€ä¸ªæ–°çš„listã€‚â€</p>\n<p>è‹¥ä¸æ˜¯doubleå‡½æ•°åå·²ç»è¶³å¤Ÿè¯­ä¹‰åŒ–ï¼Œæˆ‘ä»¬è¿˜å¾—ç¿»çœ‹doubleå‡½æ•°çš„å®šä¹‰ï¼Œçœ‹çœ‹å®ƒåˆ°åº•åšäº†ä»€ä¹ˆã€‚æ˜¯å¦å¯ä»¥å†æŠ½è±¡ä¸€ç‚¹ï¼Œåƒä¸‹é¢è¿™æ ·è°ƒç”¨ï¼š </p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">a = getEachItemDoubled([<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>])</div><div class=\"line\">b = getEachItemDoubled([<span class=\"number\">4</span>,<span class=\"number\">5</span>,<span class=\"number\">6</span>])</div><div class=\"line\">c = getEachItemDoubled([<span class=\"number\">7</span>,<span class=\"number\">8</span>,<span class=\"number\">9</span>])</div></pre></td></tr></table></figure>\n<p>å‡½æ•°åæ¸…æ™°æ˜ç¡®çš„è¡¨è¾¾äº†ä»£ç çš„æ„å›¾ï¼Œå³ä½¿æˆ‘ä»¬æ²¡æœ‰æ·»åŠ ä»»ä½•æ³¨é‡Šï¼Œè°éƒ½æ˜ç™½<code>getEachItemDoubled</code>åšäº†ä»€ä¹ˆã€‚</p>\n<p>è¿™æ ·çš„<code>getEachItemDoubled</code>å‡½æ•°è¯¥æ€ä¹ˆå®šä¹‰ï¼Ÿ</p>\n<p>è€ƒè™‘ä¸‹é¢çš„ä»£ç ã€‚</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">curredMap</span><span class=\"params\">(fn)</span>:</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">p</span><span class=\"params\">(x)</span>:</span></div><div class=\"line\">        <span class=\"keyword\">return</span> map(fn, x)</div><div class=\"line\">\t<span class=\"keyword\">return</span> p</div><div class=\"line\"></div><div class=\"line\">getEachItemDoubled = curredMap(<span class=\"keyword\">lambda</span> x:x*<span class=\"number\">2</span>)</div></pre></td></tr></table></figure>\n<p><strong>curredMap</strong>å’Œmapä¸€æ ·ä¹Ÿæ˜¯ä¸ªé«˜é˜¶å‡½æ•°ï¼Œåœ¨è¿™æ®µä»£ç ä¸­éå¸¸é‡è¦ã€‚å¦‚ä¸Šï¼Œç°åœ¨ä½ å¯ä»¥ç”¨ä½ å¸Œæœ›çš„æ–¹å¼ä½¿ç”¨æ›´è¯­ä¹‰çš„<code>getEachItemDoubled</code>ã€‚</p>\n<p>æœ‰äº†<code>curredMap</code>å‡½æ•°ï¼Œä½ è¿˜å¯ä»¥è¿™æ ·ï¼š</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\"># å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºå°†listæ¯ä¸€ä¸ªå…ƒç´ ä¹˜ä»¥3</span></div><div class=\"line\">getEachItemTripled = curredMap(<span class=\"keyword\">lambda</span> x: x*<span class=\"number\">3</span>)</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºå°†listæ¯ä¸ªå…ƒç´ å­—ç¬¦ä¸²åŒ–</span></div><div class=\"line\">strEachItem = curredMap(<span class=\"keyword\">lambda</span> x: str(x))</div><div class=\"line\"></div><div class=\"line\">a = getEachItemTripled([<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>]) <span class=\"comment\"># [3, 6, 9]</span></div><div class=\"line\">b = strEachItem([<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>]) <span class=\"comment\"># ['1', '2', '3']</span></div></pre></td></tr></table></figure>\n<p>çœ‹åˆ°è¿™ä½ å¤§æ¦‚æ˜ç™½äº†ï¼Œç®€è€Œè¨€ä¹‹ï¼ŒæŸ¯é‡ŒåŒ–å°±æ˜¯å‡½æ•°çš„<strong>å±€éƒ¨è°ƒç”¨</strong>ï¼Œä¹Ÿç§°<strong>éƒ¨åˆ†æ±‚å€¼</strong>ï¼Œä¸‹é¢ä¼šè¿›ä¸€æ­¥è§£é‡Šã€‚</p>\n<h2 id=\"æŸ¯é‡ŒåŒ–çš„æ„ä¹‰\"><a href=\"#æŸ¯é‡ŒåŒ–çš„æ„ä¹‰\" class=\"headerlink\" title=\"æŸ¯é‡ŒåŒ–çš„æ„ä¹‰\"></a>æŸ¯é‡ŒåŒ–çš„æ„ä¹‰</h2><p>ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å¯¹pythonçš„å†…ç½®å‡½æ•°mapåšäº†<strong>éƒ¨åˆ†æ±‚å€¼</strong>å¾—åˆ°äº†æ›´åŠ æŠ½è±¡çš„<code>getEachItemDoubled</code>ã€<code>getEachItemTripled</code>ä»¥åŠ<code>strEachItem</code>ï¼Œå¤šå‚å‡½æ•°mapå˜æˆäº†ä¸€äº›å•å‚å‡½æ•°ã€‚</p>\n<p>åŸç”Ÿmapå‡½æ•°ä¾èµ–ä¸¤ä¸ªå‚æ•°ï¼Œæˆ‘ä»¬æ²¡æœ‰åŠæ³•è¿™æ ·ä½¿ç”¨ï¼š</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">getEachItemDoubled = map(<span class=\"keyword\">lambda</span> x:x*<span class=\"number\">2</span>)</div><div class=\"line\"><span class=\"comment\"># TypeError: map() requires at least two args</span></div></pre></td></tr></table></figure>\n<p>ç¼–è¯‘å™¨ä¼šæŠ›å‡ºTypeErroré”™è¯¯ã€‚ è¿™æ ·çš„è®¾è®¡åœ¨åˆå­¦è€…çœ‹æ¥éå¸¸ç—›è‹¦ï¼Œæˆ‘éœ€è¦è®°ä½æ¯ä¸€ä¸ªå‡½æ•°å¿…é¡»ä¼ é€’å‡ ä¸ªå‚æ•°å—ï¼Ÿ</p>\n<p>æŠŠæœ€åˆçš„ä»£ç å’Œæœ€ç»ˆæŸ¯é‡ŒåŒ–åçš„ä»£ç æ”¾åˆ°ä¸€èµ·ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">a = map(lambda x: x*2, [1,2,3])</div><div class=\"line\"></div><div class=\"line\">a = curredMap(lambda x: x*2)([1,2,3])</div></pre></td></tr></table></figure>\n<p>mapè¢«æˆ‘ä»¬åšäº†é™é˜¶å¤„ç†ï¼Œè¿™æ ·åšæœ‰ä»€ä¹ˆæ„ä¹‰ï¼Ÿ</p>\n<p>å°±ä¸Šé¢çš„ä¾‹å­è€Œè¨€ã€‚</p>\n<ul>\n<li>å¯è¯»æ€§æ›´å¼ºã€‚</li>\n</ul>\n<ul>\n<li>æ¥å£ç®€åŒ–ã€‚</li>\n<li>å¤ç”¨æ€§æ›´é«˜ã€‚</li>\n</ul>\n<p>æœ€é‡è¦çš„æ˜¯ï¼šä½ ä¸éœ€è¦åœ¨è„‘æµ·é‡Œè®°ä½mapå‡½æ•°å¿…é¡»ä¼ é€’ä¸¤ä¸ªå‚æ•°ï¼Œå°½ç®¡æ”¾å¿ƒä½¿ç”¨<code>curredMap</code>ã€‚</p>\n<p>æˆ‘ä»¬ç°åœ¨å¯ä»¥è¿™ä¹ˆç†è§£<strong>å±€éƒ¨è°ƒç”¨</strong>ï¼šmapå‡½æ•°è¦æ±‚ä¸¤ä¸ªå‚æ•°ï¼Œä½†æˆ‘åªç»™äº†å®ƒä¸€ä¸ªå‚æ•°ï¼Œç†åº”è¿”å›ä¸€ä¸ªèƒ½å¤Ÿæ¥æ”¶ç¬¬äºŒä¸ªå‚æ•°çš„å‡½æ•°ï¼Œæ— è®ºæˆ‘ä½•æ—¶æƒ³è¦ä¼ é€’ç¬¬äºŒä¸ªå‚æ•°ï¼Œå®ƒéƒ½èƒ½æ­£å¸¸å·¥ä½œã€‚è¿™å°±æ˜¯æŸ¯é‡ŒåŒ–å‡ºç°çš„æ„ä¹‰ã€‚</p>\n<p>å†ç”¨ä¸€æ®µjsä»£ç æ¥è¯´æ˜ã€‚</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">sum</span>(<span class=\"params\">a, b</span>)</span>&#123;</div><div class=\"line\">  <span class=\"keyword\">return</span> a + b</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">cu</span>(<span class=\"params\">x, y</span>)</span>&#123;</div><div class=\"line\">  <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">fn</span>(<span class=\"params\">z</span>)</span>&#123;</div><div class=\"line\">    <span class=\"keyword\">return</span> x + z</div><div class=\"line\">  &#125;</div><div class=\"line\">  <span class=\"keyword\">if</span>(<span class=\"built_in\">arguments</span>.length === <span class=\"number\">1</span>)&#123;</div><div class=\"line\">    <span class=\"keyword\">return</span> fn</div><div class=\"line\">  &#125; </div><div class=\"line\">  <span class=\"keyword\">return</span> x + y  </div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">sum(<span class=\"number\">1</span>,<span class=\"number\">2</span>)</div><div class=\"line\">curredSum(<span class=\"number\">1</span>)(<span class=\"number\">2</span>)</div></pre></td></tr></table></figure>\n<p>curredSumçœ‹ä¸Šå»å¹¶æ²¡æœ‰æ¯”sumå‡½æ•°å¯è¯»æ€§æ›´å¥½ï¼Œä¹Ÿä¸è§å¾—æ¥å£æ›´ç®€å•ï¼Œä¸¤è€…ä¼¼ä¹æ²¡ä»€ä¹ˆåŒºåˆ«ã€‚</p>\n<p>è€ŒcurredSumçš„çœŸæ­£ä¼˜åŠ¿ä½“ç°åœ¨ä¸‹é¢è¿™ç§æƒ…å½¢ä¸­ã€‚</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">/* æ–¹å¼ä¸€ */</span></div><div class=\"line\">sum(<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>,<span class=\"number\">4</span>)</div><div class=\"line\">sum(<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>,<span class=\"number\">7</span>)</div><div class=\"line\">sum(<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>,<span class=\"number\">11</span>,<span class=\"number\">12</span>)</div><div class=\"line\">sum(<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>,<span class=\"number\">11</span>,<span class=\"number\">12</span>,<span class=\"number\">14</span>)</div><div class=\"line\">sum(<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>,<span class=\"number\">11</span>,<span class=\"number\">12</span>,<span class=\"number\">17</span>)</div><div class=\"line\"><span class=\"comment\">// ...</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">/* æ–¹å¼äºŒ */</span></div><div class=\"line\"><span class=\"keyword\">var</span> sixPlus = curredSum(<span class=\"number\">1</span>+<span class=\"number\">2</span>+<span class=\"number\">3</span>)</div><div class=\"line\">sixPlus(<span class=\"number\">4</span>)</div><div class=\"line\">sixPlus(<span class=\"number\">7</span>)</div><div class=\"line\">sixPlus(<span class=\"number\">11</span>)</div><div class=\"line\"><span class=\"keyword\">var</span> twentyNinePlus = curredSum(<span class=\"number\">1</span>+<span class=\"number\">2</span>+<span class=\"number\">3</span>+<span class=\"number\">11</span>+<span class=\"number\">12</span>)</div><div class=\"line\">twentyNinePlus(<span class=\"number\">14</span>)</div><div class=\"line\">twentyNinePlus(<span class=\"number\">17</span>)</div><div class=\"line\"><span class=\"comment\">// ...</span></div></pre></td></tr></table></figure>\n<p>è‹¥å‚æ•°è¢«å¤šæ¬¡å¤ç”¨ï¼Œå°±åº”è¯¥æŠ½è±¡å‡ºæ¥ï¼Œæ— è®ºæ€ä¹ˆçœ‹ï¼ŒæŸ¯é‡ŒåŒ–åçš„ä»£ç éƒ½æ›´åŠ å®¹æ˜“ç»´æŠ¤å’Œæ‰©å±•ï¼Œå¹¶ä¸”ä¹Ÿä¸å¤±æ˜“è¯»æ€§ã€‚</p>\n<p>æœ€åï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹ramdaä¸­çš„æŸ¯é‡ŒåŒ–ã€‚</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> R = <span class=\"built_in\">require</span>(<span class=\"string\">'ramda'</span>)</div><div class=\"line\"></div><div class=\"line\">R.append(<span class=\"string\">'c'</span>, [<span class=\"string\">'a'</span>,<span class=\"string\">'b'</span>]) <span class=\"comment\">// -&gt; ['a','b','c']</span></div><div class=\"line\"><span class=\"comment\">/* ä¸‹é¢çš„å‡½æ•°ä½œç”¨æ˜¯ä¸ºæ•°ç»„è¿½åŠ ä¸€ä¸ª'c' */</span></div><div class=\"line\"><span class=\"keyword\">var</span> appendC = R.append(<span class=\"string\">'c'</span>)</div><div class=\"line\">appendC([<span class=\"string\">'a'</span>,<span class=\"string\">'b'</span>]) <span class=\"comment\">// -&gt; ['a','b','c']</span></div><div class=\"line\">appendC([<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>]) <span class=\"comment\">// -&gt; [1,2,3,'c']</span></div><div class=\"line\"></div><div class=\"line\">R.remove(<span class=\"number\">1</span>,<span class=\"number\">2</span>,[<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>,<span class=\"number\">4</span>,<span class=\"number\">5</span>]) <span class=\"comment\">// -&gt; [1,4]</span></div><div class=\"line\"><span class=\"comment\">/* ä¸‹é¢è¿™ä¸ªå‡½æ•°çš„ä½œç”¨æ˜¯ä»[1,2,3,4,5]å¼€å§‹ä½ç½®å»é™¤xä¸ªæ•°ï¼Œè¿”å›ä¸€ä¸ªæ–°çš„æ•°ç»„ */</span></div><div class=\"line\"><span class=\"comment\">/* R.__åœ¨è¿™é‡Œä½œä¸ºå ä½ç¬¦ï¼Œè¡¨ç¤ºæŸ¯é‡ŒåŒ–åçš„å‡½æ•°å½¢å‚åº”è¯¥ä¼ é€’çš„ä½ç½® */</span></div><div class=\"line\"><span class=\"keyword\">var</span> removeXFromStart = R.remove(<span class=\"number\">0</span>,R.__,[<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>,<span class=\"number\">4</span>,<span class=\"number\">5</span>])</div><div class=\"line\">removeXFromStart(<span class=\"number\">2</span>) <span class=\"comment\">// -&gt; [3,4,5]</span></div><div class=\"line\">removeXFromStart(<span class=\"number\">4</span>) <span class=\"comment\">// -&gt; [5]</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">/* ä¸‹é¢è¿™ä¸ªæ›´å¤æ‚ä¸€ç‚¹ */</span></div><div class=\"line\"><span class=\"comment\">/* tå‡½æ•°çš„ä½œç”¨æ˜¯å–å‡ºå‚æ•°çš„xå±æ€§å€¼ï¼Œä¹˜2ï¼Œå–å */</span></div><div class=\"line\"><span class=\"keyword\">var</span> t = R.compose(R.negate, x =&gt; x*<span class=\"number\">2</span>, R.prop(<span class=\"string\">'x'</span>))</div><div class=\"line\">t(&#123;</div><div class=\"line\">  <span class=\"attr\">x</span>: <span class=\"number\">100</span>,</div><div class=\"line\">  <span class=\"attr\">y</span>: <span class=\"number\">200</span>,</div><div class=\"line\">  <span class=\"attr\">z</span>: <span class=\"number\">300</span></div><div class=\"line\">&#125;) <span class=\"comment\">// -&gt; -200</span></div><div class=\"line\">t(&#123;</div><div class=\"line\">  <span class=\"attr\">x</span>: <span class=\"number\">1</span>,</div><div class=\"line\">  <span class=\"attr\">y</span>: <span class=\"number\">2</span></div><div class=\"line\">&#125;) <span class=\"comment\">// -&gt; -2</span></div></pre></td></tr></table></figure>\n<p>å¦‚æœä½ ç”¨è¿‡lodashï¼Œä½ ä¸€å®šæ¸…æ¥šä¸Šé¢çš„ä¾‹å­å’Œlodashçš„åŒºåˆ«ï¼Œä½†lodashç”¨æˆ·æ˜¯å¦åº”è¯¥ä¸ºæ­¤å°±è¿‡æ¸¡åˆ°ramdaï¼Œæ¨èä½ çœ‹çœ‹Scott Sauyetå†™çš„<a href=\"http://fr.umio.us/why-ramda/\" target=\"_blank\" rel=\"external\">why ramda</a>ï¼Œä»¥åŠgoogleä¸€ä¸‹ramdaå’Œlodashçš„æ›´å¤šå¯¹æ¯”å†åšå†³å®šã€‚</p>\n<p>å°½ç®¡ä»¥ä¸Šè¯´çš„éƒ½æ˜¯æŸ¯é‡ŒåŒ–ä¸ºå‡½æ•°å¼ç¼–ç¨‹å¸¦æ¥çš„å¥½å¤„ï¼Œæˆ‘è¿˜æ˜¯å¾—è¯´ï¼Œç†æ™ºçš„ç¨‹åºå‘˜è¿˜æ˜¯åº”è¯¥è°¨æ…ä½¿ç”¨è¿™ç§ç¼–ç¨‹æ–¹æ³•ã€‚</p>\n<p>ä¸è¯¥ä½¿ç”¨æŸ¯é‡ŒåŒ–çš„åœºæ™¯ä¹‹ä¸€æ˜¯ï¼šå‡½æ•°çš„å‚æ•°æ€»æ˜¯éœ€è¦å¤šä¸ªåŒæ—¶ä¼ é€’ï¼Œå¦åˆ™å‡½æ•°æœ¬èº«çš„è¯­ä¹‰å°±ä¸æ˜ç¡®ï¼Œæˆ–è€…è¢«ç ´åã€‚ä¾‹å¦‚ä¸€ä¸ªå‡½æ•°å®šä¹‰ä¸ºæ ‡å‡ºåœ°å›¾ä¸Šçš„ç‚¹ï¼Œå¾€å¾€åœ¨ä½¿ç”¨å®ƒçš„æ—¶å€™ç»åº¦å’Œçº¬åº¦ä¼šåŒæ—¶ä¼ å…¥ï¼Œæ— è®ºä½ åªä¼ å…¥ç»åº¦è¿˜æ˜¯çº¬åº¦éƒ½æ˜¾å¾—å¾ˆåˆ«æ‰­ï¼ŒæŸ¯é‡ŒåŒ–è¿™æ ·çš„å‡½æ•°æ²¡æœ‰æ„ä¹‰ï¼Œçº¯ç²¹ç”»è›‡æ·»è¶³ã€‚</p>\n<p>å¦å¤–ï¼Œæˆ‘ä»¬åº”è¯¥æ€è€ƒï¼Œæ—¢ç„¶æŸ¯é‡ŒåŒ–è®©ä¸€åˆ‡é‚£ä¹ˆç¾å¥½ï¼Œå¾ˆå¤šè¯­è¨€è®¾è®¡ä¹‹åˆä¸ºä»€ä¹ˆè®©å‡½æ•°å¯ä»¥å®šä¹‰å¤šä¸ªå½¢å‚ï¼Œä¸ºä»€ä¹ˆåœ¨è¿™ä¹‹ä¸Šæ›´è¡ç”Ÿå‡ºäº†é»˜è®¤å‚æ•°ã€å¯å˜å‚æ•°ã€å…³é”®å­—å‚æ•°ï¼Ÿå‚æ•°å®šä¹‰å¦‚æ­¤çµæ´»æ˜¯å¥½æ˜¯åï¼Ÿ</p>\n<p>pythonç”±äºtupleè¿™ç§æ•°æ®ç±»å‹çš„å­˜åœ¨ï¼Œä½¿å¾—å¤šå‚å‡½æ•°è½»æ˜“çš„æ¥å—ä¸€ä¸ªæ··åˆè¿‡åçš„tupleä½œä¸ºå‚æ•°ï¼Œå¹¶å°†å…¶å±•å¼€ä¸ºå¤šä¸ªå‚æ•°ï¼Œä»¿ä½›å‡½æ•°å®šä¹‰æ—¶çš„å‚æ•°ä¸ªæ•°æ¯«æ— çº¦æŸæ€§ï¼Œå¤šå‚å‡½æ•°ä»ç„¶å¯ä»¥åƒå•å‚å‡½æ•°ä¸€æ ·ä½¿ç”¨ï¼Œè€ƒé‡ä¸€ä¸ªå‡½æ•°åº”è¯¥å®šä¹‰å¤šå‚è¿˜æ˜¯å•å‚åœ¨pythoné‡Œä¼¼ä¹å¹¶ä¸é‡è¦äº†ï¼Œä¸ªäººçˆ±å¥½è¿™æ—¶å€™é«˜äºä¸€åˆ‡ã€‚ä»ç„¶æœ‰å¾ˆå¤šä½¿ç”¨å¤šå‚å‡½æ•°çš„åœºæ™¯ï¼Œå¤§å¤šæ•°äººå¯ä»¥ç†Ÿç»ƒçš„å°†å‚æ•°æå‰ç»„åˆï¼ŒæŸ¯é‡ŒåŒ–åªä¸è¿‡æŠŠæ­¥éª¤åˆ†è§£äº†ã€‚</p>\n<p>åœ¨æˆ‘çœ‹æ¥ï¼Œåº”ä¸åº”è¯¥æŸ¯é‡ŒåŒ–ï¼Œåªéœ€è€ƒé‡ä¸€ç‚¹ï¼Œå±€éƒ¨è°ƒç”¨è¿™ä¸ªå‡½æ•°æ˜¯å¦æ„ä¹‰æ›´æ˜ç¡®ã€‚</p>\n<p>å¼ºè¡ŒæŸ¯é‡ŒåŒ–ä¹Ÿå¯èƒ½æ˜¯ç¾éš¾ã€‚</p>\n","excerpt":"","more":"<p>æœ€è¿‘æŸä¸ªæŠ€æœ¯ç¾¤ä¸­æœ‰äººæ¿€è¿›çš„è¡¨è¾¾ç»ä¸ç”¨<strong>lodash</strong>ï¼Œç§°lodashä½œè€…æ€åº¦å‚²æ…¢ï¼Œè‡ªå·±åªç”¨<strong>ramda</strong>ï¼Œäºæ˜¯æˆ‘å¾ˆå¥½å¥‡ï¼Œç ”ç©¶äº†ä¸€ä¼šramdaï¼Œå¼•ç”³å‡ºä¸‹é¢çš„æ€è€ƒã€‚</p>\n<p>ç²—ç•¥çœ‹ramdaå®˜æ–¹æ–‡æ¡£ä¸ä¼šè§‰å¾—ä¸lodashæœ‰ä»€ä¹ˆä¸åŒï¼Œä½†å®é™…ä¸Šè¿™ä¸¤è€…çš„è®¾è®¡ç†å¿µå¾ˆä¸ä¸€æ ·ï¼Œå¦‚æœæŠŠå¦ä¸€ä¸ªè‘—åçš„ç±»åº“underscoreä¹Ÿæ”¾åˆ°ä¸€èµ·å¯¹æ¯”ï¼Œå¤§å¤šæ•°äººçš„çœ‹æ³•æ˜¯è¿™æ ·çš„ï¼š</p>\n<blockquote>\n<p>underscore &lt; lodash &lt; ramda</p>\n</blockquote>\n<p>ramdaè¢«ä¸€äº›äººè®¤ä¸ºå¼ºäºlodashçš„ä¸€ä¸ªé‡è¦çš„åŸå› å°±æ˜¯å°†æŸ¯é‡ŒåŒ–çš„æ€æƒ³ä½“ç°åœ¨apiè®¾è®¡ä¸­ã€‚</p>\n<p>å®˜æ–¹æè¿°ramdaçš„ä¸»è¦ç‰¹æ€§ä¹Ÿè¯´åˆ°ï¼Œramdaå°±æ˜¯ä¸ºæ­¤è®¾è®¡çš„ï¼š</p>\n<blockquote>\n<ul>\n<li>Ramda emphasizes a purer functional style. Immutability and side-effect free functions are at the heart of its design philosophy. This can help you get the job done with simple, elegant code.</li>\n<li>Ramda functions are automatically curried. This allows you to easily build up new functions from old ones simply by not supplying the final parameters.</li>\n<li>The parameters to Ramda functions are arranged to make it convenient for currying. The data to be operated on is generally supplied last.</li>\n</ul>\n<p>The last two points together make it very easy to build functions as sequences of simpler functions, each of which transforms the data and passes it along to the next. Ramda is designed to support this style of coding.</p>\n</blockquote>\n<h2 id=\"ä»€ä¹ˆæ˜¯æŸ¯é‡ŒåŒ–\"><a href=\"#ä»€ä¹ˆæ˜¯æŸ¯é‡ŒåŒ–\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯æŸ¯é‡ŒåŒ–\"></a>ä»€ä¹ˆæ˜¯æŸ¯é‡ŒåŒ–</h2><p>æŸ¯é‡ŒåŒ–å­˜åœ¨å‡½æ•°å¼ç¼–ç¨‹ä¸­ã€‚åœ¨æ”¯æŒé«˜é˜¶å‡½æ•°ï¼ˆå‚æ•°æˆ–è¿”å›å€¼åŒ…å«å‡½æ•°çš„å‡½æ•°ï¼‰çš„è¯­è¨€é‡Œï¼ˆå¦‚pythonï¼Œjavascriptï¼‰ï¼ŒæŸ¯é‡ŒåŒ–çš„äº§ç”Ÿæ˜¯è‡ªç„¶è€Œç„¶çš„ã€‚</p>\n<p>æˆ‘ä»¬ç”¨å®ä¾‹æ¥è¯´æ˜ï¼Œè§‚å¯Ÿä»¥ä¸‹pythonä»£ç ï¼š</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">a = map(<span class=\"keyword\">lambda</span> x: x*<span class=\"number\">2</span>, [<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>])</div><div class=\"line\">b = map(<span class=\"keyword\">lambda</span> x: x*<span class=\"number\">2</span>, [<span class=\"number\">4</span>,<span class=\"number\">5</span>,<span class=\"number\">6</span>])</div><div class=\"line\">c = map(<span class=\"keyword\">lambda</span> x: x*<span class=\"number\">2</span>, [<span class=\"number\">7</span>,<span class=\"number\">8</span>,<span class=\"number\">9</span>])</div></pre></td></tr></table></figure>\n<p>æŠ½è±¡æ˜¯ç¨‹åºå‘˜çš„åŸºæœ¬ç´ å…»ï¼Œä¸Šé¢çš„ä»£ç lambdaå‡½æ•°å¤šæ¬¡ä½¿ç”¨ï¼Œä¸å¤Ÿä¼˜é›…åˆ‡ä¸æ˜“ç»´æŠ¤ï¼Œæˆ‘ä»¬ä¼šæƒ³åˆ°è¿™æ ·æ”¹è¿›ï¼š</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">double = <span class=\"keyword\">lambda</span> x: x*<span class=\"number\">2</span></div><div class=\"line\"></div><div class=\"line\">a = map(double, [<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>])</div><div class=\"line\">b = map(double, [<span class=\"number\">4</span>,<span class=\"number\">5</span>,<span class=\"number\">6</span>])</div><div class=\"line\">c = map(double, [<span class=\"number\">7</span>,<span class=\"number\">8</span>,<span class=\"number\">9</span>])</div></pre></td></tr></table></figure>\n<p>å¦‚æ­¤ä¸€æ¥ï¼Œå½“ä¸šåŠ¡é€»è¾‘æœ‰å˜ï¼Œæˆ‘ä»¬åªéœ€è¦ä¿®æ”¹doubleå˜é‡ã€‚</p>\n<p>çœ‹ä¸Šå»å·²ç»è¶³å¤Ÿäº†ï¼Œä½†<code>map(double...</code>ä¸å¤Ÿè¯­ä¹‰åŒ–ï¼Œè¯•æƒ³åˆ«äººåœ¨è§£è¯»è¿™æ®µä»£ç çš„æ—¶å€™ä¼šè¿™æ ·æƒ³ï¼š</p>\n<p>â€œéå†è¿™ä¸ªlistï¼Œå°†doubleå‡½æ•°ä½œç”¨åœ¨æ¯ä¸€ä¸ªå…ƒç´ ä¸Šï¼Œè¿”å›ä¸€ä¸ªæ–°çš„listã€‚â€</p>\n<p>è‹¥ä¸æ˜¯doubleå‡½æ•°åå·²ç»è¶³å¤Ÿè¯­ä¹‰åŒ–ï¼Œæˆ‘ä»¬è¿˜å¾—ç¿»çœ‹doubleå‡½æ•°çš„å®šä¹‰ï¼Œçœ‹çœ‹å®ƒåˆ°åº•åšäº†ä»€ä¹ˆã€‚æ˜¯å¦å¯ä»¥å†æŠ½è±¡ä¸€ç‚¹ï¼Œåƒä¸‹é¢è¿™æ ·è°ƒç”¨ï¼š </p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">a = getEachItemDoubled([<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>])</div><div class=\"line\">b = getEachItemDoubled([<span class=\"number\">4</span>,<span class=\"number\">5</span>,<span class=\"number\">6</span>])</div><div class=\"line\">c = getEachItemDoubled([<span class=\"number\">7</span>,<span class=\"number\">8</span>,<span class=\"number\">9</span>])</div></pre></td></tr></table></figure>\n<p>å‡½æ•°åæ¸…æ™°æ˜ç¡®çš„è¡¨è¾¾äº†ä»£ç çš„æ„å›¾ï¼Œå³ä½¿æˆ‘ä»¬æ²¡æœ‰æ·»åŠ ä»»ä½•æ³¨é‡Šï¼Œè°éƒ½æ˜ç™½<code>getEachItemDoubled</code>åšäº†ä»€ä¹ˆã€‚</p>\n<p>è¿™æ ·çš„<code>getEachItemDoubled</code>å‡½æ•°è¯¥æ€ä¹ˆå®šä¹‰ï¼Ÿ</p>\n<p>è€ƒè™‘ä¸‹é¢çš„ä»£ç ã€‚</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">curredMap</span><span class=\"params\">(fn)</span>:</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">p</span><span class=\"params\">(x)</span>:</span></div><div class=\"line\">        <span class=\"keyword\">return</span> map(fn, x)</div><div class=\"line\">\t<span class=\"keyword\">return</span> p</div><div class=\"line\"></div><div class=\"line\">getEachItemDoubled = curredMap(<span class=\"keyword\">lambda</span> x:x*<span class=\"number\">2</span>)</div></pre></td></tr></table></figure>\n<p><strong>curredMap</strong>å’Œmapä¸€æ ·ä¹Ÿæ˜¯ä¸ªé«˜é˜¶å‡½æ•°ï¼Œåœ¨è¿™æ®µä»£ç ä¸­éå¸¸é‡è¦ã€‚å¦‚ä¸Šï¼Œç°åœ¨ä½ å¯ä»¥ç”¨ä½ å¸Œæœ›çš„æ–¹å¼ä½¿ç”¨æ›´è¯­ä¹‰çš„<code>getEachItemDoubled</code>ã€‚</p>\n<p>æœ‰äº†<code>curredMap</code>å‡½æ•°ï¼Œä½ è¿˜å¯ä»¥è¿™æ ·ï¼š</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\"># å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºå°†listæ¯ä¸€ä¸ªå…ƒç´ ä¹˜ä»¥3</span></div><div class=\"line\">getEachItemTripled = curredMap(<span class=\"keyword\">lambda</span> x: x*<span class=\"number\">3</span>)</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºå°†listæ¯ä¸ªå…ƒç´ å­—ç¬¦ä¸²åŒ–</span></div><div class=\"line\">strEachItem = curredMap(<span class=\"keyword\">lambda</span> x: str(x))</div><div class=\"line\"></div><div class=\"line\">a = getEachItemTripled([<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>]) <span class=\"comment\"># [3, 6, 9]</span></div><div class=\"line\">b = strEachItem([<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>]) <span class=\"comment\"># ['1', '2', '3']</span></div></pre></td></tr></table></figure>\n<p>çœ‹åˆ°è¿™ä½ å¤§æ¦‚æ˜ç™½äº†ï¼Œç®€è€Œè¨€ä¹‹ï¼ŒæŸ¯é‡ŒåŒ–å°±æ˜¯å‡½æ•°çš„<strong>å±€éƒ¨è°ƒç”¨</strong>ï¼Œä¹Ÿç§°<strong>éƒ¨åˆ†æ±‚å€¼</strong>ï¼Œä¸‹é¢ä¼šè¿›ä¸€æ­¥è§£é‡Šã€‚</p>\n<h2 id=\"æŸ¯é‡ŒåŒ–çš„æ„ä¹‰\"><a href=\"#æŸ¯é‡ŒåŒ–çš„æ„ä¹‰\" class=\"headerlink\" title=\"æŸ¯é‡ŒåŒ–çš„æ„ä¹‰\"></a>æŸ¯é‡ŒåŒ–çš„æ„ä¹‰</h2><p>ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å¯¹pythonçš„å†…ç½®å‡½æ•°mapåšäº†<strong>éƒ¨åˆ†æ±‚å€¼</strong>å¾—åˆ°äº†æ›´åŠ æŠ½è±¡çš„<code>getEachItemDoubled</code>ã€<code>getEachItemTripled</code>ä»¥åŠ<code>strEachItem</code>ï¼Œå¤šå‚å‡½æ•°mapå˜æˆäº†ä¸€äº›å•å‚å‡½æ•°ã€‚</p>\n<p>åŸç”Ÿmapå‡½æ•°ä¾èµ–ä¸¤ä¸ªå‚æ•°ï¼Œæˆ‘ä»¬æ²¡æœ‰åŠæ³•è¿™æ ·ä½¿ç”¨ï¼š</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">getEachItemDoubled = map(<span class=\"keyword\">lambda</span> x:x*<span class=\"number\">2</span>)</div><div class=\"line\"><span class=\"comment\"># TypeError: map() requires at least two args</span></div></pre></td></tr></table></figure>\n<p>ç¼–è¯‘å™¨ä¼šæŠ›å‡ºTypeErroré”™è¯¯ã€‚ è¿™æ ·çš„è®¾è®¡åœ¨åˆå­¦è€…çœ‹æ¥éå¸¸ç—›è‹¦ï¼Œæˆ‘éœ€è¦è®°ä½æ¯ä¸€ä¸ªå‡½æ•°å¿…é¡»ä¼ é€’å‡ ä¸ªå‚æ•°å—ï¼Ÿ</p>\n<p>æŠŠæœ€åˆçš„ä»£ç å’Œæœ€ç»ˆæŸ¯é‡ŒåŒ–åçš„ä»£ç æ”¾åˆ°ä¸€èµ·ï¼š</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">a = map(lambda x: x*2, [1,2,3])</div><div class=\"line\"></div><div class=\"line\">a = curredMap(lambda x: x*2)([1,2,3])</div></pre></td></tr></table></figure>\n<p>mapè¢«æˆ‘ä»¬åšäº†é™é˜¶å¤„ç†ï¼Œè¿™æ ·åšæœ‰ä»€ä¹ˆæ„ä¹‰ï¼Ÿ</p>\n<p>å°±ä¸Šé¢çš„ä¾‹å­è€Œè¨€ã€‚</p>\n<ul>\n<li>å¯è¯»æ€§æ›´å¼ºã€‚</li>\n</ul>\n<ul>\n<li>æ¥å£ç®€åŒ–ã€‚</li>\n<li>å¤ç”¨æ€§æ›´é«˜ã€‚</li>\n</ul>\n<p>æœ€é‡è¦çš„æ˜¯ï¼šä½ ä¸éœ€è¦åœ¨è„‘æµ·é‡Œè®°ä½mapå‡½æ•°å¿…é¡»ä¼ é€’ä¸¤ä¸ªå‚æ•°ï¼Œå°½ç®¡æ”¾å¿ƒä½¿ç”¨<code>curredMap</code>ã€‚</p>\n<p>æˆ‘ä»¬ç°åœ¨å¯ä»¥è¿™ä¹ˆç†è§£<strong>å±€éƒ¨è°ƒç”¨</strong>ï¼šmapå‡½æ•°è¦æ±‚ä¸¤ä¸ªå‚æ•°ï¼Œä½†æˆ‘åªç»™äº†å®ƒä¸€ä¸ªå‚æ•°ï¼Œç†åº”è¿”å›ä¸€ä¸ªèƒ½å¤Ÿæ¥æ”¶ç¬¬äºŒä¸ªå‚æ•°çš„å‡½æ•°ï¼Œæ— è®ºæˆ‘ä½•æ—¶æƒ³è¦ä¼ é€’ç¬¬äºŒä¸ªå‚æ•°ï¼Œå®ƒéƒ½èƒ½æ­£å¸¸å·¥ä½œã€‚è¿™å°±æ˜¯æŸ¯é‡ŒåŒ–å‡ºç°çš„æ„ä¹‰ã€‚</p>\n<p>å†ç”¨ä¸€æ®µjsä»£ç æ¥è¯´æ˜ã€‚</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">sum</span>(<span class=\"params\">a, b</span>)</span>&#123;</div><div class=\"line\">  <span class=\"keyword\">return</span> a + b</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">cu</span>(<span class=\"params\">x, y</span>)</span>&#123;</div><div class=\"line\">  <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">fn</span>(<span class=\"params\">z</span>)</span>&#123;</div><div class=\"line\">    <span class=\"keyword\">return</span> x + z</div><div class=\"line\">  &#125;</div><div class=\"line\">  <span class=\"keyword\">if</span>(<span class=\"built_in\">arguments</span>.length === <span class=\"number\">1</span>)&#123;</div><div class=\"line\">    <span class=\"keyword\">return</span> fn</div><div class=\"line\">  &#125; </div><div class=\"line\">  <span class=\"keyword\">return</span> x + y  </div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">sum(<span class=\"number\">1</span>,<span class=\"number\">2</span>)</div><div class=\"line\">curredSum(<span class=\"number\">1</span>)(<span class=\"number\">2</span>)</div></pre></td></tr></table></figure>\n<p>curredSumçœ‹ä¸Šå»å¹¶æ²¡æœ‰æ¯”sumå‡½æ•°å¯è¯»æ€§æ›´å¥½ï¼Œä¹Ÿä¸è§å¾—æ¥å£æ›´ç®€å•ï¼Œä¸¤è€…ä¼¼ä¹æ²¡ä»€ä¹ˆåŒºåˆ«ã€‚</p>\n<p>è€ŒcurredSumçš„çœŸæ­£ä¼˜åŠ¿ä½“ç°åœ¨ä¸‹é¢è¿™ç§æƒ…å½¢ä¸­ã€‚</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">/* æ–¹å¼ä¸€ */</span></div><div class=\"line\">sum(<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>,<span class=\"number\">4</span>)</div><div class=\"line\">sum(<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>,<span class=\"number\">7</span>)</div><div class=\"line\">sum(<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>,<span class=\"number\">11</span>,<span class=\"number\">12</span>)</div><div class=\"line\">sum(<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>,<span class=\"number\">11</span>,<span class=\"number\">12</span>,<span class=\"number\">14</span>)</div><div class=\"line\">sum(<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>,<span class=\"number\">11</span>,<span class=\"number\">12</span>,<span class=\"number\">17</span>)</div><div class=\"line\"><span class=\"comment\">// ...</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">/* æ–¹å¼äºŒ */</span></div><div class=\"line\"><span class=\"keyword\">var</span> sixPlus = curredSum(<span class=\"number\">1</span>+<span class=\"number\">2</span>+<span class=\"number\">3</span>)</div><div class=\"line\">sixPlus(<span class=\"number\">4</span>)</div><div class=\"line\">sixPlus(<span class=\"number\">7</span>)</div><div class=\"line\">sixPlus(<span class=\"number\">11</span>)</div><div class=\"line\"><span class=\"keyword\">var</span> twentyNinePlus = curredSum(<span class=\"number\">1</span>+<span class=\"number\">2</span>+<span class=\"number\">3</span>+<span class=\"number\">11</span>+<span class=\"number\">12</span>)</div><div class=\"line\">twentyNinePlus(<span class=\"number\">14</span>)</div><div class=\"line\">twentyNinePlus(<span class=\"number\">17</span>)</div><div class=\"line\"><span class=\"comment\">// ...</span></div></pre></td></tr></table></figure>\n<p>è‹¥å‚æ•°è¢«å¤šæ¬¡å¤ç”¨ï¼Œå°±åº”è¯¥æŠ½è±¡å‡ºæ¥ï¼Œæ— è®ºæ€ä¹ˆçœ‹ï¼ŒæŸ¯é‡ŒåŒ–åçš„ä»£ç éƒ½æ›´åŠ å®¹æ˜“ç»´æŠ¤å’Œæ‰©å±•ï¼Œå¹¶ä¸”ä¹Ÿä¸å¤±æ˜“è¯»æ€§ã€‚</p>\n<p>æœ€åï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹ramdaä¸­çš„æŸ¯é‡ŒåŒ–ã€‚</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> R = <span class=\"built_in\">require</span>(<span class=\"string\">'ramda'</span>)</div><div class=\"line\"></div><div class=\"line\">R.append(<span class=\"string\">'c'</span>, [<span class=\"string\">'a'</span>,<span class=\"string\">'b'</span>]) <span class=\"comment\">// -&gt; ['a','b','c']</span></div><div class=\"line\"><span class=\"comment\">/* ä¸‹é¢çš„å‡½æ•°ä½œç”¨æ˜¯ä¸ºæ•°ç»„è¿½åŠ ä¸€ä¸ª'c' */</span></div><div class=\"line\"><span class=\"keyword\">var</span> appendC = R.append(<span class=\"string\">'c'</span>)</div><div class=\"line\">appendC([<span class=\"string\">'a'</span>,<span class=\"string\">'b'</span>]) <span class=\"comment\">// -&gt; ['a','b','c']</span></div><div class=\"line\">appendC([<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>]) <span class=\"comment\">// -&gt; [1,2,3,'c']</span></div><div class=\"line\"></div><div class=\"line\">R.remove(<span class=\"number\">1</span>,<span class=\"number\">2</span>,[<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>,<span class=\"number\">4</span>,<span class=\"number\">5</span>]) <span class=\"comment\">// -&gt; [1,4]</span></div><div class=\"line\"><span class=\"comment\">/* ä¸‹é¢è¿™ä¸ªå‡½æ•°çš„ä½œç”¨æ˜¯ä»[1,2,3,4,5]å¼€å§‹ä½ç½®å»é™¤xä¸ªæ•°ï¼Œè¿”å›ä¸€ä¸ªæ–°çš„æ•°ç»„ */</span></div><div class=\"line\"><span class=\"comment\">/* R.__åœ¨è¿™é‡Œä½œä¸ºå ä½ç¬¦ï¼Œè¡¨ç¤ºæŸ¯é‡ŒåŒ–åçš„å‡½æ•°å½¢å‚åº”è¯¥ä¼ é€’çš„ä½ç½® */</span></div><div class=\"line\"><span class=\"keyword\">var</span> removeXFromStart = R.remove(<span class=\"number\">0</span>,R.__,[<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>,<span class=\"number\">4</span>,<span class=\"number\">5</span>])</div><div class=\"line\">removeXFromStart(<span class=\"number\">2</span>) <span class=\"comment\">// -&gt; [3,4,5]</span></div><div class=\"line\">removeXFromStart(<span class=\"number\">4</span>) <span class=\"comment\">// -&gt; [5]</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">/* ä¸‹é¢è¿™ä¸ªæ›´å¤æ‚ä¸€ç‚¹ */</span></div><div class=\"line\"><span class=\"comment\">/* tå‡½æ•°çš„ä½œç”¨æ˜¯å–å‡ºå‚æ•°çš„xå±æ€§å€¼ï¼Œä¹˜2ï¼Œå–å */</span></div><div class=\"line\"><span class=\"keyword\">var</span> t = R.compose(R.negate, x =&gt; x*<span class=\"number\">2</span>, R.prop(<span class=\"string\">'x'</span>))</div><div class=\"line\">t(&#123;</div><div class=\"line\">  <span class=\"attr\">x</span>: <span class=\"number\">100</span>,</div><div class=\"line\">  <span class=\"attr\">y</span>: <span class=\"number\">200</span>,</div><div class=\"line\">  <span class=\"attr\">z</span>: <span class=\"number\">300</span></div><div class=\"line\">&#125;) <span class=\"comment\">// -&gt; -200</span></div><div class=\"line\">t(&#123;</div><div class=\"line\">  <span class=\"attr\">x</span>: <span class=\"number\">1</span>,</div><div class=\"line\">  <span class=\"attr\">y</span>: <span class=\"number\">2</span></div><div class=\"line\">&#125;) <span class=\"comment\">// -&gt; -2</span></div></pre></td></tr></table></figure>\n<p>å¦‚æœä½ ç”¨è¿‡lodashï¼Œä½ ä¸€å®šæ¸…æ¥šä¸Šé¢çš„ä¾‹å­å’Œlodashçš„åŒºåˆ«ï¼Œä½†lodashç”¨æˆ·æ˜¯å¦åº”è¯¥ä¸ºæ­¤å°±è¿‡æ¸¡åˆ°ramdaï¼Œæ¨èä½ çœ‹çœ‹Scott Sauyetå†™çš„<a href=\"http://fr.umio.us/why-ramda/\">why ramda</a>ï¼Œä»¥åŠgoogleä¸€ä¸‹ramdaå’Œlodashçš„æ›´å¤šå¯¹æ¯”å†åšå†³å®šã€‚</p>\n<p>å°½ç®¡ä»¥ä¸Šè¯´çš„éƒ½æ˜¯æŸ¯é‡ŒåŒ–ä¸ºå‡½æ•°å¼ç¼–ç¨‹å¸¦æ¥çš„å¥½å¤„ï¼Œæˆ‘è¿˜æ˜¯å¾—è¯´ï¼Œç†æ™ºçš„ç¨‹åºå‘˜è¿˜æ˜¯åº”è¯¥è°¨æ…ä½¿ç”¨è¿™ç§ç¼–ç¨‹æ–¹æ³•ã€‚</p>\n<p>ä¸è¯¥ä½¿ç”¨æŸ¯é‡ŒåŒ–çš„åœºæ™¯ä¹‹ä¸€æ˜¯ï¼šå‡½æ•°çš„å‚æ•°æ€»æ˜¯éœ€è¦å¤šä¸ªåŒæ—¶ä¼ é€’ï¼Œå¦åˆ™å‡½æ•°æœ¬èº«çš„è¯­ä¹‰å°±ä¸æ˜ç¡®ï¼Œæˆ–è€…è¢«ç ´åã€‚ä¾‹å¦‚ä¸€ä¸ªå‡½æ•°å®šä¹‰ä¸ºæ ‡å‡ºåœ°å›¾ä¸Šçš„ç‚¹ï¼Œå¾€å¾€åœ¨ä½¿ç”¨å®ƒçš„æ—¶å€™ç»åº¦å’Œçº¬åº¦ä¼šåŒæ—¶ä¼ å…¥ï¼Œæ— è®ºä½ åªä¼ å…¥ç»åº¦è¿˜æ˜¯çº¬åº¦éƒ½æ˜¾å¾—å¾ˆåˆ«æ‰­ï¼ŒæŸ¯é‡ŒåŒ–è¿™æ ·çš„å‡½æ•°æ²¡æœ‰æ„ä¹‰ï¼Œçº¯ç²¹ç”»è›‡æ·»è¶³ã€‚</p>\n<p>å¦å¤–ï¼Œæˆ‘ä»¬åº”è¯¥æ€è€ƒï¼Œæ—¢ç„¶æŸ¯é‡ŒåŒ–è®©ä¸€åˆ‡é‚£ä¹ˆç¾å¥½ï¼Œå¾ˆå¤šè¯­è¨€è®¾è®¡ä¹‹åˆä¸ºä»€ä¹ˆè®©å‡½æ•°å¯ä»¥å®šä¹‰å¤šä¸ªå½¢å‚ï¼Œä¸ºä»€ä¹ˆåœ¨è¿™ä¹‹ä¸Šæ›´è¡ç”Ÿå‡ºäº†é»˜è®¤å‚æ•°ã€å¯å˜å‚æ•°ã€å…³é”®å­—å‚æ•°ï¼Ÿå‚æ•°å®šä¹‰å¦‚æ­¤çµæ´»æ˜¯å¥½æ˜¯åï¼Ÿ</p>\n<p>pythonç”±äºtupleè¿™ç§æ•°æ®ç±»å‹çš„å­˜åœ¨ï¼Œä½¿å¾—å¤šå‚å‡½æ•°è½»æ˜“çš„æ¥å—ä¸€ä¸ªæ··åˆè¿‡åçš„tupleä½œä¸ºå‚æ•°ï¼Œå¹¶å°†å…¶å±•å¼€ä¸ºå¤šä¸ªå‚æ•°ï¼Œä»¿ä½›å‡½æ•°å®šä¹‰æ—¶çš„å‚æ•°ä¸ªæ•°æ¯«æ— çº¦æŸæ€§ï¼Œå¤šå‚å‡½æ•°ä»ç„¶å¯ä»¥åƒå•å‚å‡½æ•°ä¸€æ ·ä½¿ç”¨ï¼Œè€ƒé‡ä¸€ä¸ªå‡½æ•°åº”è¯¥å®šä¹‰å¤šå‚è¿˜æ˜¯å•å‚åœ¨pythoné‡Œä¼¼ä¹å¹¶ä¸é‡è¦äº†ï¼Œä¸ªäººçˆ±å¥½è¿™æ—¶å€™é«˜äºä¸€åˆ‡ã€‚ä»ç„¶æœ‰å¾ˆå¤šä½¿ç”¨å¤šå‚å‡½æ•°çš„åœºæ™¯ï¼Œå¤§å¤šæ•°äººå¯ä»¥ç†Ÿç»ƒçš„å°†å‚æ•°æå‰ç»„åˆï¼ŒæŸ¯é‡ŒåŒ–åªä¸è¿‡æŠŠæ­¥éª¤åˆ†è§£äº†ã€‚</p>\n<p>åœ¨æˆ‘çœ‹æ¥ï¼Œåº”ä¸åº”è¯¥æŸ¯é‡ŒåŒ–ï¼Œåªéœ€è€ƒé‡ä¸€ç‚¹ï¼Œå±€éƒ¨è°ƒç”¨è¿™ä¸ªå‡½æ•°æ˜¯å¦æ„ä¹‰æ›´æ˜ç¡®ã€‚</p>\n<p>å¼ºè¡ŒæŸ¯é‡ŒåŒ–ä¹Ÿå¯èƒ½æ˜¯ç¾éš¾ã€‚</p>\n"},{"title":"ä»€ä¹ˆæ˜¯æ¨¡å—","date":"2016-11-07T00:48:32.000Z","_content":"\n### å†™åœ¨å‰é¢\n\né˜…è¯»ä¸‹æ–‡å‡å®šä½ åŸºæœ¬äº†è§£ï¼šä½¿ç”¨`mocha`åšå•å…ƒæµ‹è¯•ï¼Œangularjsï¼Œnodejsç¯å¢ƒæ­å»ºä»¥åŠnpmçš„ä½¿ç”¨ã€‚\n\nå…ˆè¯´ç»“è®ºï¼š\n\n* è¢«å‡½æ•°åŒ…è£…ï¼Œæ¯æ¬¡è°ƒç”¨å®ä¾‹åŒ–ä¸€ä¸ªæ–°çš„å¯¹è±¡æˆ–è¿”å›åŒä¸€ä¸ªå¯¹è±¡ï¼ˆå•ä¾‹æ¨¡å¼ä¸‹ï¼Œå‡½æ•°è‡³å°‘éœ€è¦è°ƒç”¨ä¸€æ¬¡ï¼‰\n\n* ä¸Šè¿°å‡½æ•°ä¸­æœ‰å†…éƒ¨å‡½æ•°æš´éœ²å‡ºæ¥ï¼Œä½¿å…¶å†…éƒ¨ä½œç”¨åŸŸå½¢æˆé—­åŒ…ã€‚\n\n\nAngularjsæ˜¯ä¸ªå¾ˆ'æ¨¡å—åŒ–'çš„æ¡†æ¶ï¼Œè¿™é‡Œä¸è°ˆMVCï¼ŒMVVMï¼ŒæŒ‡ä»¤ï¼ŒæœåŠ¡ã€‚è°ˆè°ˆngä¸­çš„ä¾èµ–æ³¨å…¥ï¼Œngå‡ºä¸–æ—¶æœ€ä¸ºäººç§°é“çš„æ¦‚å¿µä¹‹ä¸€ã€‚\n\nåŸºäºä¸Šè¿°ç»“è®ºæˆ‘ä¼šå†™ä¸ªæ¨¡å—æ„é€ å™¨ï¼Œä»¥è¿™ä¸ªä¾‹å­æ¥è¯´æ˜å¦‚ä½•åˆ›å»ºä¸€ä¸ªæ¨¡å—ã€‚\n\nä»¥ä¸‹ngæŒ‡ä»£angularã€‚\n\n### ngä¸­çš„ä¾èµ–æ³¨å…¥\n\nåœ¨ngä¸­ï¼Œå½“æˆ‘ä»¬è¦åˆ›å»ºä¸€ä¸ªä¸ä¾èµ–ä»»ä½•æ¨¡å—çš„æ¨¡å—`foo`ï¼Œæˆ‘ä»¬è¿™æ ·å†™ï¼š\n\n```javascript\nangular.module('foo', [])\n```\n\nå½“æˆ‘ä»¬è¦åˆ›å»ºå¦ä¸€ä¸ªä¾èµ–ä¸Šè¿°`foo`æ¨¡å—çš„å¦ä¸€ä¸ªæ¨¡å—æ—¶æˆ‘ä»¬è¿™æ ·å†™ï¼š\n\n```javascript\nangular.module('another', ['foo'])\n```\n\nè¿™å°±æ˜¯æœ€ç®€å•çš„ä¾èµ–æ³¨å…¥ã€‚\n\nåœ¨ç¬¬ä¸€ä¸ª`foo`æ¨¡å—ä¸­ï¼Œç”±äºangularçš„moduleæ–¹æ³•è¿”å›angularè‡ªèº«ï¼Œæˆ‘ä»¬å¯ä»¥åƒjQueryé‚£æ ·é“¾å¼è°ƒç”¨ï¼Œåœ¨å…¶ååˆ›å»ºæ¨¡å—ä¸­çš„`service`ï¼Œå°±åƒä¸‹é¢è¿™æ ·ï¼š\n\n```javascript\nangular.module('foo', []).service('fooService', [function($scope){}])\n```\n\nå½“`another`å£°æ˜è‡ªå·±ä¾èµ–`foo`æ—¶ï¼Œ`foo`ä¸­çš„service**æ³¨å…¥**äº†`another`ï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œangularå¸®åŠ©æˆ‘ä»¬å®Œæˆäº†ç¯‡å¤´çš„**ç»“è®ºä¸€**ï¼Œæ¨¡å—`another`æ¥ç€åˆ›å»ºcontrolleræ—¶å¯ä»¥ä½¿ç”¨fooä¸­å·²ç»åˆ›å»ºå¥½çš„serviceï¼š\n\n```javascript\nangular.module('another', ['foo']).controller('anotherCtrl', ['fooService', function(fooService){}])\n```\n\næˆ‘ä»¬æ³¨æ„åˆ°ä¸€ä¸ªç»†èŠ‚ï¼Œcontrolleræ–¹æ³•çš„ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ å£°æ˜äº†æ‰€ä¾èµ–çš„æ¨¡å—åï¼Œè€Œæ•°ç»„çš„æœ€åä¸€ä¸ªå…ƒç´ æ˜¯ä¸ªåŒ¿åå‡½æ•°ï¼Œ`fooService`åœ¨è¿™é‡Œè¢«å½“åšå‚æ•°**æ³¨å…¥**äº†ï¼Œæ˜¾ç„¶ï¼Œåœ¨è¿™ä¸ªåŒ¿åå‡½æ•°é‡Œä½ å¯ä»¥è°ƒç”¨fooServiceå®ä¾‹åŒ–åæš´éœ²çš„å…¬å…±apiï¼Œè®¿é—®åˆ°åˆ°åŸå§‹fooServiceé‡Œçš„ç§æœ‰å˜é‡ï¼Œjsç¨‹åºå‘˜ä¸å¯èƒ½ä¸çŸ¥é“ï¼Œè¿™å°±æ˜¯**é—­åŒ…**ã€‚\n\n### æˆ‘ä»¬çš„æ¨¡å—\n\nngé‡Œçš„controllerï¼Œserviceç­‰å¯ä»¥è§†ä¸ºå­æ¨¡å—ï¼Œç®€å•èµ·è§ï¼Œæˆ‘ä»¬çš„æ¨¡å—å»æ‰äº†è¿™äº›æ¦‚å¿µï¼Œä½†ä¿ç•™äº†ä¾èµ–æ³¨å…¥ï¼š\n\n```javascript\nMyModule.module('module1', [], function(){})\n\nMyModule.module('module2', ['module1'], function(module1){})\n\nMyModule.module('module3', ['module1', 'module2'], function(module1, module2){})\n```\n\nä¸Šé¢çš„ä»£ç ä¸­ï¼Œ`MyModule`å®šä¹‰äº†ä¸‰ä¸ªæ¨¡å—ï¼Œmodule1ä¸ä¾èµ–ä»»ä½•æ¨¡å—ï¼Œmodule2ä¾èµ–module1ï¼Œmodule3ä¾èµ–module1å’Œmodule2ã€‚\n\nä¸ºäº†å®ç°ä¸Šè¿°çš„æ¨¡å¼ï¼Œæˆ‘ä»¬æ¥å…ˆå†™ä¸€ç‚¹æµ‹è¯•ã€‚\n\nåˆ›å»ºä¸€ä¸ªç©ºé¡¹ç›®ç›®å½•ï¼Œåœ¨æ ¹ç›®å½•åˆ›å»ºtestæ–‡ä»¶å¤¹ï¼Œå¹¶ä¸”åœ¨testæ–‡ä»¶å¤¹å†…åˆ›å»ºmodule.jsæ–‡ä»¶ï¼Œä¸‹é¢æ˜¯module.jsæ–‡ä»¶çš„å†…å®¹ï¼š\n\n```Javascript\nlet expect = require('chai').expect;\n\ndescribe('My module tests', function() {\n\tlet MyModule;\n\n\tbefore(function(done) {\n\t\tMyModule = require('../index.js')()\n\n\t\tdone()\n\t})\n\n\tit('desc MyModule', function(){\n\t\texpect(MyModule).has.a.property('module')\n\t\texpect(MyModule).has.a.property('getAll')\n\t})\n})\n```\n\nåœ¨æµ‹è¯•ä»£ç é‡Œæˆ‘ä»¬æŒ‡æ˜äº†æ¨¡å—æ„é€ å™¨çš„è·¯å¾„ï¼ˆæ ¹ç›®å½•çš„index.jsï¼‰ï¼Œå®ƒæä¾›äº†ä¸¤ä¸ªæ–¹æ³•ï¼Œ`module`å’Œ`getAll`ï¼Œé¡¾åæ€ä¹‰ï¼Œ`module`æ–¹æ³•å®šä¹‰æ¨¡å—ï¼Œ`getAll`æ–¹æ³•è·å¾—æ‰€æœ‰æ¨¡å—ã€‚\n\nå…ˆæ¥åˆ›å»º`index.js`ï¼Œä½¿æœ€å¼€å§‹çš„æµ‹è¯•ä»£ç é€šè¿‡ï¼š\n\n```javascript\nexports = module.exports = function() {\n\treturn {\n\t\tmodule: function() {\n\n\t\t},\n\t\tgetAll: function() {\n\n\t\t}\n\t}\n}\n```\n\nè¿è¡Œ`mocha`ï¼Œä¸€ç‰‡ç»¿ç¯ã€‚\n\nç°åœ¨å¯ä»¥å®šä¹‰æˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªæ¨¡å—äº†ï¼Œåœ¨æµ‹è¯•ä»£ç ä¸­æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š\n\n```javascript\nit('define module1', function() {\n\tMyModule.module('module1', [], function() {\n\t\t\tlet tmp = 123\n\t\t\treturn {\n\t\t\t\tfoo: tmp\n\t\t\t}\n\t})\n\n\texpect(MyModule.getAll()).has.a.property('module1')\n})\n```\n\nmodule1ä¸ä¾èµ–ä»»ä½•æ¨¡å—ï¼Œæ‰€ä»¥ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸ªç©ºæ•°ç»„ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°å®šä¹‰äº†module1ä½œä¸ºæ¨¡å—è¢«æ³¨å…¥å…¶å®ƒæ¨¡å—æ—¶æä¾›äº†ä»€ä¹ˆï¼Œæ³¨æ„åˆ°è¿™ä¸ªå‡½æ•°ä¸­æœ‰ä¸ªç§æœ‰å˜é‡tmpï¼Œä¸ºäº†è¯æ˜ç¨åè¿™é‡Œå½¢æˆäº†é—­åŒ…ï¼Œæˆ‘ä»¬æŠŠæš´éœ²å‡ºå»çš„fooå±æ€§æŒ‡å‘äº†tmpï¼Œç¨ååœ¨module2ä¸­æˆ‘ä»¬ä¼šå°è¯•è®¿é—®å®ƒã€‚\n\nç°åœ¨è¿è¡Œæµ‹è¯•ä»£ç ï¼Œå½“ç„¶ä¸ä¼šé€šè¿‡ï¼Œæˆ‘ä»¬æ¥ä¸ºè¿™æ®µæµ‹è¯•è„šæœ¬æ›´æ–°index.jsã€‚\n\n```javascript\nexports = module.exports = function() {\n\n\tlet modules = {};\n\n\treturn {\n\t\tmodule: function(name, injects, body) {\n\n\t\t\tmodules[name] = {\n\t\t\t\tdependencies: injects,\n\t\t\t\tbody: body\n\t\t\t};\n\t\t},\n\t\tgetAll: function() {\n\t\t\treturn modules;\n\t\t}\n\t}\n}\n```\n\nå†…éƒ¨çš„ç§æœ‰å˜é‡modulesæ˜¯ä¸ªå“ˆå¸Œåˆ—è¡¨ï¼Œå› ä¸ºæ¨¡å—åæ˜¯**å”¯ä¸€çš„ä¸é‡åçš„å­—ç¬¦ä¸²**ï¼Œæˆ‘ä»¬è‡ªç„¶çš„æƒ³åˆ°ç”¨è¿™æ ·çš„æ•°æ®ç»“æ„å‚¨å­˜å®ƒï¼Œmoduleæ–¹æ³•ç®€å•çš„æŠŠæ¨¡å—å’Œç›¸å…³ä¿¡æ¯æ”¾åˆ°äº†modulesé‡Œï¼Œè€ŒgetAllæ–¹æ³•åˆ™ç›´æ¥è¿”å›äº†modulesã€‚\n\nè¿™æ ·ï¼Œæˆ‘ä»¬é€šè¿‡äº†ç¬¬äºŒæ®µæµ‹è¯•ã€‚\n\nç»§ç»­å¾€ä¸‹ï¼Œåœ¨æµ‹è¯•ä»£ç ä¸­å®šä¹‰ç¬¬äºŒä¸ªæ¨¡å—ï¼š\n\n```javascript\nit('define module2', function() {\n\tMyModule.module('module2', ['module1'], function(module1) {\n\t\texpect(module1.foo).to.equal(123)\n\t\treturn {\n\t\t\ta: 456,\n\t\t\tref: module1\n\t\t}\n\t})\n\texpect(MyModule.getAll()).has.a.property('module2')\n})\n```\n\nmodule1è¢«æ³¨å…¥åˆ°äº†module2ä¸­ï¼Œå¹¶ä¸”åœ¨module2é‡Œæˆ‘ä»¬å°è¯•è®¿é—®module1çš„fooå±æ€§ï¼Œå¦‚æœä¸€åˆ‡é¡ºåˆ©ï¼Œå®ƒåº”è¯¥æ˜¯`123`ã€‚\n\nå®ç°ä¸Šé¢çš„é€»è¾‘æˆ‘ä»¬éœ€è¦å¯¹MyModuleçš„moduleæ–¹æ³•é‡Œçš„ç¬¬äºŒä¸ªå‚æ•°åšä¸€äº›å¤„ç†ï¼Œç°åœ¨æ¥ä¿®æ”¹index.jsï¼š\n\n```Javascript\nexports = module.exports = function() {\n\n\tlet modules = {};\n\n\treturn {\n\t\tmodule: function(name, injects, body) {\n\n\t\t\tfunction enumerateInjects(injects) {\n\t\t\t\tlet tmp = [];\n\n\t\t\t\tfor (let i in injects) {\n\t\t\t\t\tif (modules[injects[i]]) {\n\t\t\t\t\t\ttmp.push(modules[injects[i]].body())\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthrow new Error(`Inject error. No module named ${injects[i]}`);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn tmp;\n\t\t\t}\n\n\t\t\tmodules[name] = {\n\t\t\t\tdependencies: injects,\n\t\t\t\tbody: body\n\t\t\t};\n\n\t\t\tbody.apply(this, enumerateInjects(injects))\n\t\t},\n\t\tgetAll: function() {\n\t\t\treturn modules;\n\t\t}\n\t}\n}\n```\n\nenumerateInjectså‡½æ•°éå†äº†injectså‚æ•°ï¼ŒæŠŠå¯¹åº”æ¨¡å—æ‰§è¡Œï¼Œå¹¶å°†æ‰§è¡Œåçš„ç»“æœæ”¾åˆ°ä¸€ä¸ªæ•°ç»„é‡Œè¿”å›ï¼Œå¹¶ä¸”æˆ‘ä»¬è¿˜é¢å¤–åšäº†ä¸€ç‚¹é”™è¯¯å¤„ç†ï¼ˆå½“æŒ‡å®šè¦ä¾èµ–çš„æ¨¡å—ä¸å­˜åœ¨æ—¶æŠ›å‡ºé”™è¯¯ï¼‰ã€‚åœ¨moduleæ–¹æ³•çš„æœ€åï¼Œæˆ‘ä»¬æŠŠå¾—åˆ°çš„æ•°ç»„ä¼ ç»™äº†bodyå‡½æ•°ï¼Œapplyæ–¹æ³•åœ¨è¿™é‡Œå¾ˆå…³é”®ï¼Œç¬¬äºŒä¸ªå‚æ•°æ•°ç»„è¢«å±•å¼€æˆäº†å¤šä¸ªå‚æ•°ï¼Œäºæ˜¯module2æ‹¿åˆ°äº†module1æ‰§è¡Œåçš„ç»“æœã€‚\n\næ­¤æ—¶å†è¿è¡Œä¸€éæµ‹è¯•è„šæœ¬ï¼Œæ¯”é¢„æ–™çš„è¿˜è¦é¡ºåˆ©ã€‚\n\nçœ‹ä¸Šå»æˆ‘ä»¬çš„æ„é€ å™¨å®Œæˆäº†ï¼Œmodule1é¡ºåˆ©æ³¨å…¥åˆ°äº†module2é‡Œï¼Œå®é™…ä¸Šåˆ°æ­¤ä¸ºæ­¢module1ç¡®å®æ„æˆäº†ä¸€ä¸ªæ¨¡å—ï¼Œå¯ä»¥è¢«æ³¨å…¥åˆ°ä»»ä½•æ¨¡å—ä¸­ã€‚ä½†æˆ‘ä»¬è€ƒè™‘çš„è¿˜ä¸å¤Ÿï¼Œæˆ‘ä»¬åº”è¯¥ç»§ç»­å¾€ä¸‹ï¼Œå°è¯•æ„é€ module3ï¼ŒæŠŠmodule1å’Œmodule2éƒ½æ³¨å…¥è¿›å»çœ‹çœ‹ä¼šå‘ç”Ÿä»€ä¹ˆã€‚\n\nè¡¥å……æµ‹è¯•è„šæœ¬ï¼š\n\n```javascript\nit('define module3', function() {\n\tMyModule.module('module3', ['module1', 'module2'], function(module1, module2) {\n\t\texpect(module1.foo).to.equal(123)\n\t\texpect(module2.a).to.equal(456)\n\t\texpect(module2.ref.foo).to.equal(123)\n\n\t})\n\n\texpect(MyModule.getAll()).has.a.property('module3')\n})\n```\n\nå†æ¬¡è¿è¡Œæµ‹è¯•ï¼Œæ²¡æœ‰é€šè¿‡ã€‚æ§åˆ¶å°æŠ›å‡ºäº†TypeErroré”™è¯¯ï¼Œå‘Šè¯‰æˆ‘ä»¬è¿™é‡Œå¼•ç”¨äº†ä¸å­˜åœ¨çš„å±æ€§ã€‚\n\næ€è€ƒindex.jsé‡Œçš„ä»£ç ï¼Œæˆ‘ä»¬å‡å®šmodule1çš„æ³¨å…¥æ²¡æœ‰é—®é¢˜ï¼ˆäº‹å®ä¸Šç¡®å®æ²¡é—®é¢˜ï¼Œå› ä¸ºå‰é¢å·²ç»ç»è¿‡æ£€éªŒï¼‰ï¼Œå½“æˆ‘ä»¬æŠŠmodule2æ³¨å…¥module3æ—¶enumerateInjectså‡½æ•°åšäº†ä»€ä¹ˆï¼Ÿ\n\nmodule2ä¾èµ–module1ï¼Œä½†éå†è¿‡ç¨‹ä¸­æˆ‘ä»¬å´å¿½ç•¥äº†è¿™ä¸€ç‚¹ï¼Œç›´æ¥æ‰§è¡Œmodule2çš„bodyè€Œä¸è€ƒè™‘å®ƒåœ¨å®šä¹‰æ—¶å£°æ˜çš„ä¾èµ–ï¼Œè‹¥module1æ­¤æ—¶æ²¡æœ‰æ³¨å…¥åˆ°module2é‡Œï¼Œè‡ªç„¶ä¸å¯èƒ½å¾—åˆ°æˆ‘ä»¬é¢„æœŸçš„ç»“æœã€‚\n\nå¯¹enumerateInjectså‡½æ•°åšå¦‚ä¸‹ä¿®æ”¹ï¼š\n\n```Javascript\nfunction enumerateInjects(injects) {\n\tlet tmp = [];\n    for (let i in injects) {\n\t\tif (modules[injects[i]]) {\n\t\t\tif (modules[injects[i]].dependencies.length > 0) {\n\t\t\t\tlet deepEnumerateInjects = enumerateInjects(modules[injects[i]].dependencies);\n\n\t\t\t\ttmp.push(modules[injects[i]].body.apply(null, deepEnumerateInjects))\n\t\t\t} else {\n\t\t\t\ttmp.push(modules[injects[i]].body())\n\t\t\t}\n\t\t} else {\n\t\t\tthrow new Error(`Inject error. No module named ${injects[i]}`);\n        }\n\t}\n\n\treturn tmp;\n}\n```\n\nåœ¨ç¬¬ä¸€ä¸ªifåˆ¤æ–­é‡Œæˆ‘ä»¬æ·»åŠ äº†å¯¹ä¾èµ–çš„ä¾èµ–çš„ä¾èµ–â€¦çš„å¤„ç†ï¼Œæ²¡é”™ï¼Œè¿™æ˜¯ä¸ª**é€’å½’**ï¼Œæ— è®ºæ¨¡å—åµŒå¥—æœ‰å¤šæ·±ï¼Œåœ¨æœ‰é™çš„æ·±åº¦é‡Œæˆ‘ä»¬éƒ½å¯ä»¥å°†å®ƒä¸€ä¸ªä¸ªæ‰¾åˆ°å¹¶æœ€ç»ˆä¼ é€’ç»™å½“å‰æ¨¡å—ã€‚\n\nåˆ°æ­¤ï¼Œæµ‹è¯•è„šæœ¬é¡ºåˆ©è¿è¡Œã€‚æœ€ç»ˆæˆ‘ä»¬çš„module.jså’Œindex.jså¦‚ä¸‹ï¼š\n\n```Javascript\n// module.js\nlet expect = require('chai').expect;\n\ndescribe('My module tests', function() {\n\tlet MyModule;\n\n\tbefore(function(done) {\n\t\tMyModule = require('../index.js')()\n\n\t\tdone()\n\t})\n\n\tit('desc MyModule', function() {\n\t\texpect(MyModule).has.a.property('module')\n\t\texpect(MyModule).has.a.property('getAll')\n\t})\n\n\tit('define module1', function() {\n\t\tMyModule.module('module1', [], function() {\n\t\t\tlet tmp = 123\n\t\t\treturn {\n\t\t\t\tfoo: tmp\n\t\t\t}\n\t\t})\n\n\t\texpect(MyModule.getAll()).has.a.property('module1')\n\t})\n\n\tit('define module2', function() {\n\t\tMyModule.module('module2', ['module1'], function(module1) {\n\t\t\texpect(module1.foo).to.equal(123)\n\n\t\t\treturn {\n\t\t\t\ta: 456,\n\t\t\t\tref: module1\n\t\t\t}\n\t\t})\n\n\t\texpect(MyModule.getAll()).has.a.property('module2')\n\t})\n\n\tit('define module3', function() {\n\t\tMyModule.module('module3', ['module1', 'module2'], function(module1, module2) {\n\t\t\texpect(module1.foo).to.equal(123)\n\t\t\texpect(module2.a).to.equal(456)\n\t\t\texpect(module2.ref.foo).to.equal(123)\n\n\t\t})\n\n\t\texpect(MyModule.getAll()).has.a.property('module3')\n\t})\n\n})\n```\n\n```Javascript\n// index.js\nexports = module.exports = function() {\n\n\tlet modules = {};\n\n\treturn {\n\t\tmodule: function(name, injects, body) {\n\n\t\t\tfunction enumerateInjects(injects) {\n\t\t\t\tlet tmp = [];\n\t\t\t\tfor (let i in injects) {\n\t\t\t\t\tif (modules[injects[i]]) {\n\t\t\t\t\t\tif (modules[injects[i]].dependencies.length > 0) {\n\t\t\t\t\t\t\tlet deepEnumerateInjects = enumerateInjects(modules[injects[i]].dependencies);\n\n\t\t\t\t\t\t\ttmp.push(modules[injects[i]].body.apply(null, deepEnumerateInjects))\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ttmp.push(modules[injects[i]].body())\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthrow new Error(`Inject error. No module named ${injects[i]}`);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn tmp;\n\t\t\t}\n\n\t\t\tmodules[name] = {\n\t\t\t\tdependencies: injects,\n\t\t\t\tbody: body\n\t\t\t};\n\n\t\t\tbody.apply(this, enumerateInjects(injects))\n\t\t},\n\t\tgetAll: function() {\n\t\t\treturn modules;\n\t\t}\n\t}\n}\n```\n\næœ¬æ–‡çš„æœ€åï¼Œæˆ‘ä»¬å®šä¹‰çš„module3å…¶å®å¹¶ä¸æ˜¯ä¸€ä¸ªæ¨¡å—ï¼Œå› ä¸ºå®ƒæ²¡æœ‰æ»¡è¶³ç¯‡å¤´ç»“è®ºé‡Œçš„ç¬¬äºŒæ¡ã€‚å› æ­¤åœ¨åˆ«çš„æ¨¡å—ä¸­æ³¨å…¥å®ƒæ˜¯æ¯«æ— æ„ä¹‰çš„ã€‚\n\nè‰¯å¥½çš„æ¨¡å—å®šä¹‰å’Œç®¡ç†åœ¨åä½œå¼€å‘ä¸­è‡³å…³é‡è¦ï¼Œæ¨¡å—æ¨¡å¼å¹¶æ²¡æœ‰ä»€ä¹ˆæœ€ä½³å®è·µï¼Œæœ‰çš„åªæ˜¯å¯¹ç»éªŒçš„ä¸æ®µæ€»ç»“ï¼Œæœ¬æ–‡è¯´è¿°çš„ä¹Ÿåªæ˜¯æ¨¡å—æ¨¡å¼çš„å‡¤æ¯›éºŸè§’ã€‚\n\næœ¬ç¯‡æ–‡ç« é‡Œçš„ä»£ç ä¸å»ºè®®ç”¨åˆ°ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œå»ºè®®ä½¿ç”¨ä¼˜ç§€çš„æ–¹æ¡ˆå¦‚[require.js](https://github.com/requirejs/requirejs)ã€‚\n\nå®Œæ•´æºç åœ°å€ï¼š[github](https://github.com/cyyyu/inc)\n\n","source":"_posts/ä»€ä¹ˆæ˜¯æ¨¡å—.md","raw":"---\ntitle: ä»€ä¹ˆæ˜¯æ¨¡å—\ndate: 2016-11-07 08:48:32\ntags:\n---\n\n### å†™åœ¨å‰é¢\n\né˜…è¯»ä¸‹æ–‡å‡å®šä½ åŸºæœ¬äº†è§£ï¼šä½¿ç”¨`mocha`åšå•å…ƒæµ‹è¯•ï¼Œangularjsï¼Œnodejsç¯å¢ƒæ­å»ºä»¥åŠnpmçš„ä½¿ç”¨ã€‚\n\nå…ˆè¯´ç»“è®ºï¼š\n\n* è¢«å‡½æ•°åŒ…è£…ï¼Œæ¯æ¬¡è°ƒç”¨å®ä¾‹åŒ–ä¸€ä¸ªæ–°çš„å¯¹è±¡æˆ–è¿”å›åŒä¸€ä¸ªå¯¹è±¡ï¼ˆå•ä¾‹æ¨¡å¼ä¸‹ï¼Œå‡½æ•°è‡³å°‘éœ€è¦è°ƒç”¨ä¸€æ¬¡ï¼‰\n\n* ä¸Šè¿°å‡½æ•°ä¸­æœ‰å†…éƒ¨å‡½æ•°æš´éœ²å‡ºæ¥ï¼Œä½¿å…¶å†…éƒ¨ä½œç”¨åŸŸå½¢æˆé—­åŒ…ã€‚\n\n\nAngularjsæ˜¯ä¸ªå¾ˆ'æ¨¡å—åŒ–'çš„æ¡†æ¶ï¼Œè¿™é‡Œä¸è°ˆMVCï¼ŒMVVMï¼ŒæŒ‡ä»¤ï¼ŒæœåŠ¡ã€‚è°ˆè°ˆngä¸­çš„ä¾èµ–æ³¨å…¥ï¼Œngå‡ºä¸–æ—¶æœ€ä¸ºäººç§°é“çš„æ¦‚å¿µä¹‹ä¸€ã€‚\n\nåŸºäºä¸Šè¿°ç»“è®ºæˆ‘ä¼šå†™ä¸ªæ¨¡å—æ„é€ å™¨ï¼Œä»¥è¿™ä¸ªä¾‹å­æ¥è¯´æ˜å¦‚ä½•åˆ›å»ºä¸€ä¸ªæ¨¡å—ã€‚\n\nä»¥ä¸‹ngæŒ‡ä»£angularã€‚\n\n### ngä¸­çš„ä¾èµ–æ³¨å…¥\n\nåœ¨ngä¸­ï¼Œå½“æˆ‘ä»¬è¦åˆ›å»ºä¸€ä¸ªä¸ä¾èµ–ä»»ä½•æ¨¡å—çš„æ¨¡å—`foo`ï¼Œæˆ‘ä»¬è¿™æ ·å†™ï¼š\n\n```javascript\nangular.module('foo', [])\n```\n\nå½“æˆ‘ä»¬è¦åˆ›å»ºå¦ä¸€ä¸ªä¾èµ–ä¸Šè¿°`foo`æ¨¡å—çš„å¦ä¸€ä¸ªæ¨¡å—æ—¶æˆ‘ä»¬è¿™æ ·å†™ï¼š\n\n```javascript\nangular.module('another', ['foo'])\n```\n\nè¿™å°±æ˜¯æœ€ç®€å•çš„ä¾èµ–æ³¨å…¥ã€‚\n\nåœ¨ç¬¬ä¸€ä¸ª`foo`æ¨¡å—ä¸­ï¼Œç”±äºangularçš„moduleæ–¹æ³•è¿”å›angularè‡ªèº«ï¼Œæˆ‘ä»¬å¯ä»¥åƒjQueryé‚£æ ·é“¾å¼è°ƒç”¨ï¼Œåœ¨å…¶ååˆ›å»ºæ¨¡å—ä¸­çš„`service`ï¼Œå°±åƒä¸‹é¢è¿™æ ·ï¼š\n\n```javascript\nangular.module('foo', []).service('fooService', [function($scope){}])\n```\n\nå½“`another`å£°æ˜è‡ªå·±ä¾èµ–`foo`æ—¶ï¼Œ`foo`ä¸­çš„service**æ³¨å…¥**äº†`another`ï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œangularå¸®åŠ©æˆ‘ä»¬å®Œæˆäº†ç¯‡å¤´çš„**ç»“è®ºä¸€**ï¼Œæ¨¡å—`another`æ¥ç€åˆ›å»ºcontrolleræ—¶å¯ä»¥ä½¿ç”¨fooä¸­å·²ç»åˆ›å»ºå¥½çš„serviceï¼š\n\n```javascript\nangular.module('another', ['foo']).controller('anotherCtrl', ['fooService', function(fooService){}])\n```\n\næˆ‘ä»¬æ³¨æ„åˆ°ä¸€ä¸ªç»†èŠ‚ï¼Œcontrolleræ–¹æ³•çš„ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ å£°æ˜äº†æ‰€ä¾èµ–çš„æ¨¡å—åï¼Œè€Œæ•°ç»„çš„æœ€åä¸€ä¸ªå…ƒç´ æ˜¯ä¸ªåŒ¿åå‡½æ•°ï¼Œ`fooService`åœ¨è¿™é‡Œè¢«å½“åšå‚æ•°**æ³¨å…¥**äº†ï¼Œæ˜¾ç„¶ï¼Œåœ¨è¿™ä¸ªåŒ¿åå‡½æ•°é‡Œä½ å¯ä»¥è°ƒç”¨fooServiceå®ä¾‹åŒ–åæš´éœ²çš„å…¬å…±apiï¼Œè®¿é—®åˆ°åˆ°åŸå§‹fooServiceé‡Œçš„ç§æœ‰å˜é‡ï¼Œjsç¨‹åºå‘˜ä¸å¯èƒ½ä¸çŸ¥é“ï¼Œè¿™å°±æ˜¯**é—­åŒ…**ã€‚\n\n### æˆ‘ä»¬çš„æ¨¡å—\n\nngé‡Œçš„controllerï¼Œserviceç­‰å¯ä»¥è§†ä¸ºå­æ¨¡å—ï¼Œç®€å•èµ·è§ï¼Œæˆ‘ä»¬çš„æ¨¡å—å»æ‰äº†è¿™äº›æ¦‚å¿µï¼Œä½†ä¿ç•™äº†ä¾èµ–æ³¨å…¥ï¼š\n\n```javascript\nMyModule.module('module1', [], function(){})\n\nMyModule.module('module2', ['module1'], function(module1){})\n\nMyModule.module('module3', ['module1', 'module2'], function(module1, module2){})\n```\n\nä¸Šé¢çš„ä»£ç ä¸­ï¼Œ`MyModule`å®šä¹‰äº†ä¸‰ä¸ªæ¨¡å—ï¼Œmodule1ä¸ä¾èµ–ä»»ä½•æ¨¡å—ï¼Œmodule2ä¾èµ–module1ï¼Œmodule3ä¾èµ–module1å’Œmodule2ã€‚\n\nä¸ºäº†å®ç°ä¸Šè¿°çš„æ¨¡å¼ï¼Œæˆ‘ä»¬æ¥å…ˆå†™ä¸€ç‚¹æµ‹è¯•ã€‚\n\nåˆ›å»ºä¸€ä¸ªç©ºé¡¹ç›®ç›®å½•ï¼Œåœ¨æ ¹ç›®å½•åˆ›å»ºtestæ–‡ä»¶å¤¹ï¼Œå¹¶ä¸”åœ¨testæ–‡ä»¶å¤¹å†…åˆ›å»ºmodule.jsæ–‡ä»¶ï¼Œä¸‹é¢æ˜¯module.jsæ–‡ä»¶çš„å†…å®¹ï¼š\n\n```Javascript\nlet expect = require('chai').expect;\n\ndescribe('My module tests', function() {\n\tlet MyModule;\n\n\tbefore(function(done) {\n\t\tMyModule = require('../index.js')()\n\n\t\tdone()\n\t})\n\n\tit('desc MyModule', function(){\n\t\texpect(MyModule).has.a.property('module')\n\t\texpect(MyModule).has.a.property('getAll')\n\t})\n})\n```\n\nåœ¨æµ‹è¯•ä»£ç é‡Œæˆ‘ä»¬æŒ‡æ˜äº†æ¨¡å—æ„é€ å™¨çš„è·¯å¾„ï¼ˆæ ¹ç›®å½•çš„index.jsï¼‰ï¼Œå®ƒæä¾›äº†ä¸¤ä¸ªæ–¹æ³•ï¼Œ`module`å’Œ`getAll`ï¼Œé¡¾åæ€ä¹‰ï¼Œ`module`æ–¹æ³•å®šä¹‰æ¨¡å—ï¼Œ`getAll`æ–¹æ³•è·å¾—æ‰€æœ‰æ¨¡å—ã€‚\n\nå…ˆæ¥åˆ›å»º`index.js`ï¼Œä½¿æœ€å¼€å§‹çš„æµ‹è¯•ä»£ç é€šè¿‡ï¼š\n\n```javascript\nexports = module.exports = function() {\n\treturn {\n\t\tmodule: function() {\n\n\t\t},\n\t\tgetAll: function() {\n\n\t\t}\n\t}\n}\n```\n\nè¿è¡Œ`mocha`ï¼Œä¸€ç‰‡ç»¿ç¯ã€‚\n\nç°åœ¨å¯ä»¥å®šä¹‰æˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªæ¨¡å—äº†ï¼Œåœ¨æµ‹è¯•ä»£ç ä¸­æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š\n\n```javascript\nit('define module1', function() {\n\tMyModule.module('module1', [], function() {\n\t\t\tlet tmp = 123\n\t\t\treturn {\n\t\t\t\tfoo: tmp\n\t\t\t}\n\t})\n\n\texpect(MyModule.getAll()).has.a.property('module1')\n})\n```\n\nmodule1ä¸ä¾èµ–ä»»ä½•æ¨¡å—ï¼Œæ‰€ä»¥ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸ªç©ºæ•°ç»„ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°å®šä¹‰äº†module1ä½œä¸ºæ¨¡å—è¢«æ³¨å…¥å…¶å®ƒæ¨¡å—æ—¶æä¾›äº†ä»€ä¹ˆï¼Œæ³¨æ„åˆ°è¿™ä¸ªå‡½æ•°ä¸­æœ‰ä¸ªç§æœ‰å˜é‡tmpï¼Œä¸ºäº†è¯æ˜ç¨åè¿™é‡Œå½¢æˆäº†é—­åŒ…ï¼Œæˆ‘ä»¬æŠŠæš´éœ²å‡ºå»çš„fooå±æ€§æŒ‡å‘äº†tmpï¼Œç¨ååœ¨module2ä¸­æˆ‘ä»¬ä¼šå°è¯•è®¿é—®å®ƒã€‚\n\nç°åœ¨è¿è¡Œæµ‹è¯•ä»£ç ï¼Œå½“ç„¶ä¸ä¼šé€šè¿‡ï¼Œæˆ‘ä»¬æ¥ä¸ºè¿™æ®µæµ‹è¯•è„šæœ¬æ›´æ–°index.jsã€‚\n\n```javascript\nexports = module.exports = function() {\n\n\tlet modules = {};\n\n\treturn {\n\t\tmodule: function(name, injects, body) {\n\n\t\t\tmodules[name] = {\n\t\t\t\tdependencies: injects,\n\t\t\t\tbody: body\n\t\t\t};\n\t\t},\n\t\tgetAll: function() {\n\t\t\treturn modules;\n\t\t}\n\t}\n}\n```\n\nå†…éƒ¨çš„ç§æœ‰å˜é‡modulesæ˜¯ä¸ªå“ˆå¸Œåˆ—è¡¨ï¼Œå› ä¸ºæ¨¡å—åæ˜¯**å”¯ä¸€çš„ä¸é‡åçš„å­—ç¬¦ä¸²**ï¼Œæˆ‘ä»¬è‡ªç„¶çš„æƒ³åˆ°ç”¨è¿™æ ·çš„æ•°æ®ç»“æ„å‚¨å­˜å®ƒï¼Œmoduleæ–¹æ³•ç®€å•çš„æŠŠæ¨¡å—å’Œç›¸å…³ä¿¡æ¯æ”¾åˆ°äº†modulesé‡Œï¼Œè€ŒgetAllæ–¹æ³•åˆ™ç›´æ¥è¿”å›äº†modulesã€‚\n\nè¿™æ ·ï¼Œæˆ‘ä»¬é€šè¿‡äº†ç¬¬äºŒæ®µæµ‹è¯•ã€‚\n\nç»§ç»­å¾€ä¸‹ï¼Œåœ¨æµ‹è¯•ä»£ç ä¸­å®šä¹‰ç¬¬äºŒä¸ªæ¨¡å—ï¼š\n\n```javascript\nit('define module2', function() {\n\tMyModule.module('module2', ['module1'], function(module1) {\n\t\texpect(module1.foo).to.equal(123)\n\t\treturn {\n\t\t\ta: 456,\n\t\t\tref: module1\n\t\t}\n\t})\n\texpect(MyModule.getAll()).has.a.property('module2')\n})\n```\n\nmodule1è¢«æ³¨å…¥åˆ°äº†module2ä¸­ï¼Œå¹¶ä¸”åœ¨module2é‡Œæˆ‘ä»¬å°è¯•è®¿é—®module1çš„fooå±æ€§ï¼Œå¦‚æœä¸€åˆ‡é¡ºåˆ©ï¼Œå®ƒåº”è¯¥æ˜¯`123`ã€‚\n\nå®ç°ä¸Šé¢çš„é€»è¾‘æˆ‘ä»¬éœ€è¦å¯¹MyModuleçš„moduleæ–¹æ³•é‡Œçš„ç¬¬äºŒä¸ªå‚æ•°åšä¸€äº›å¤„ç†ï¼Œç°åœ¨æ¥ä¿®æ”¹index.jsï¼š\n\n```Javascript\nexports = module.exports = function() {\n\n\tlet modules = {};\n\n\treturn {\n\t\tmodule: function(name, injects, body) {\n\n\t\t\tfunction enumerateInjects(injects) {\n\t\t\t\tlet tmp = [];\n\n\t\t\t\tfor (let i in injects) {\n\t\t\t\t\tif (modules[injects[i]]) {\n\t\t\t\t\t\ttmp.push(modules[injects[i]].body())\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthrow new Error(`Inject error. No module named ${injects[i]}`);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn tmp;\n\t\t\t}\n\n\t\t\tmodules[name] = {\n\t\t\t\tdependencies: injects,\n\t\t\t\tbody: body\n\t\t\t};\n\n\t\t\tbody.apply(this, enumerateInjects(injects))\n\t\t},\n\t\tgetAll: function() {\n\t\t\treturn modules;\n\t\t}\n\t}\n}\n```\n\nenumerateInjectså‡½æ•°éå†äº†injectså‚æ•°ï¼ŒæŠŠå¯¹åº”æ¨¡å—æ‰§è¡Œï¼Œå¹¶å°†æ‰§è¡Œåçš„ç»“æœæ”¾åˆ°ä¸€ä¸ªæ•°ç»„é‡Œè¿”å›ï¼Œå¹¶ä¸”æˆ‘ä»¬è¿˜é¢å¤–åšäº†ä¸€ç‚¹é”™è¯¯å¤„ç†ï¼ˆå½“æŒ‡å®šè¦ä¾èµ–çš„æ¨¡å—ä¸å­˜åœ¨æ—¶æŠ›å‡ºé”™è¯¯ï¼‰ã€‚åœ¨moduleæ–¹æ³•çš„æœ€åï¼Œæˆ‘ä»¬æŠŠå¾—åˆ°çš„æ•°ç»„ä¼ ç»™äº†bodyå‡½æ•°ï¼Œapplyæ–¹æ³•åœ¨è¿™é‡Œå¾ˆå…³é”®ï¼Œç¬¬äºŒä¸ªå‚æ•°æ•°ç»„è¢«å±•å¼€æˆäº†å¤šä¸ªå‚æ•°ï¼Œäºæ˜¯module2æ‹¿åˆ°äº†module1æ‰§è¡Œåçš„ç»“æœã€‚\n\næ­¤æ—¶å†è¿è¡Œä¸€éæµ‹è¯•è„šæœ¬ï¼Œæ¯”é¢„æ–™çš„è¿˜è¦é¡ºåˆ©ã€‚\n\nçœ‹ä¸Šå»æˆ‘ä»¬çš„æ„é€ å™¨å®Œæˆäº†ï¼Œmodule1é¡ºåˆ©æ³¨å…¥åˆ°äº†module2é‡Œï¼Œå®é™…ä¸Šåˆ°æ­¤ä¸ºæ­¢module1ç¡®å®æ„æˆäº†ä¸€ä¸ªæ¨¡å—ï¼Œå¯ä»¥è¢«æ³¨å…¥åˆ°ä»»ä½•æ¨¡å—ä¸­ã€‚ä½†æˆ‘ä»¬è€ƒè™‘çš„è¿˜ä¸å¤Ÿï¼Œæˆ‘ä»¬åº”è¯¥ç»§ç»­å¾€ä¸‹ï¼Œå°è¯•æ„é€ module3ï¼ŒæŠŠmodule1å’Œmodule2éƒ½æ³¨å…¥è¿›å»çœ‹çœ‹ä¼šå‘ç”Ÿä»€ä¹ˆã€‚\n\nè¡¥å……æµ‹è¯•è„šæœ¬ï¼š\n\n```javascript\nit('define module3', function() {\n\tMyModule.module('module3', ['module1', 'module2'], function(module1, module2) {\n\t\texpect(module1.foo).to.equal(123)\n\t\texpect(module2.a).to.equal(456)\n\t\texpect(module2.ref.foo).to.equal(123)\n\n\t})\n\n\texpect(MyModule.getAll()).has.a.property('module3')\n})\n```\n\nå†æ¬¡è¿è¡Œæµ‹è¯•ï¼Œæ²¡æœ‰é€šè¿‡ã€‚æ§åˆ¶å°æŠ›å‡ºäº†TypeErroré”™è¯¯ï¼Œå‘Šè¯‰æˆ‘ä»¬è¿™é‡Œå¼•ç”¨äº†ä¸å­˜åœ¨çš„å±æ€§ã€‚\n\næ€è€ƒindex.jsé‡Œçš„ä»£ç ï¼Œæˆ‘ä»¬å‡å®šmodule1çš„æ³¨å…¥æ²¡æœ‰é—®é¢˜ï¼ˆäº‹å®ä¸Šç¡®å®æ²¡é—®é¢˜ï¼Œå› ä¸ºå‰é¢å·²ç»ç»è¿‡æ£€éªŒï¼‰ï¼Œå½“æˆ‘ä»¬æŠŠmodule2æ³¨å…¥module3æ—¶enumerateInjectså‡½æ•°åšäº†ä»€ä¹ˆï¼Ÿ\n\nmodule2ä¾èµ–module1ï¼Œä½†éå†è¿‡ç¨‹ä¸­æˆ‘ä»¬å´å¿½ç•¥äº†è¿™ä¸€ç‚¹ï¼Œç›´æ¥æ‰§è¡Œmodule2çš„bodyè€Œä¸è€ƒè™‘å®ƒåœ¨å®šä¹‰æ—¶å£°æ˜çš„ä¾èµ–ï¼Œè‹¥module1æ­¤æ—¶æ²¡æœ‰æ³¨å…¥åˆ°module2é‡Œï¼Œè‡ªç„¶ä¸å¯èƒ½å¾—åˆ°æˆ‘ä»¬é¢„æœŸçš„ç»“æœã€‚\n\nå¯¹enumerateInjectså‡½æ•°åšå¦‚ä¸‹ä¿®æ”¹ï¼š\n\n```Javascript\nfunction enumerateInjects(injects) {\n\tlet tmp = [];\n    for (let i in injects) {\n\t\tif (modules[injects[i]]) {\n\t\t\tif (modules[injects[i]].dependencies.length > 0) {\n\t\t\t\tlet deepEnumerateInjects = enumerateInjects(modules[injects[i]].dependencies);\n\n\t\t\t\ttmp.push(modules[injects[i]].body.apply(null, deepEnumerateInjects))\n\t\t\t} else {\n\t\t\t\ttmp.push(modules[injects[i]].body())\n\t\t\t}\n\t\t} else {\n\t\t\tthrow new Error(`Inject error. No module named ${injects[i]}`);\n        }\n\t}\n\n\treturn tmp;\n}\n```\n\nåœ¨ç¬¬ä¸€ä¸ªifåˆ¤æ–­é‡Œæˆ‘ä»¬æ·»åŠ äº†å¯¹ä¾èµ–çš„ä¾èµ–çš„ä¾èµ–â€¦çš„å¤„ç†ï¼Œæ²¡é”™ï¼Œè¿™æ˜¯ä¸ª**é€’å½’**ï¼Œæ— è®ºæ¨¡å—åµŒå¥—æœ‰å¤šæ·±ï¼Œåœ¨æœ‰é™çš„æ·±åº¦é‡Œæˆ‘ä»¬éƒ½å¯ä»¥å°†å®ƒä¸€ä¸ªä¸ªæ‰¾åˆ°å¹¶æœ€ç»ˆä¼ é€’ç»™å½“å‰æ¨¡å—ã€‚\n\nåˆ°æ­¤ï¼Œæµ‹è¯•è„šæœ¬é¡ºåˆ©è¿è¡Œã€‚æœ€ç»ˆæˆ‘ä»¬çš„module.jså’Œindex.jså¦‚ä¸‹ï¼š\n\n```Javascript\n// module.js\nlet expect = require('chai').expect;\n\ndescribe('My module tests', function() {\n\tlet MyModule;\n\n\tbefore(function(done) {\n\t\tMyModule = require('../index.js')()\n\n\t\tdone()\n\t})\n\n\tit('desc MyModule', function() {\n\t\texpect(MyModule).has.a.property('module')\n\t\texpect(MyModule).has.a.property('getAll')\n\t})\n\n\tit('define module1', function() {\n\t\tMyModule.module('module1', [], function() {\n\t\t\tlet tmp = 123\n\t\t\treturn {\n\t\t\t\tfoo: tmp\n\t\t\t}\n\t\t})\n\n\t\texpect(MyModule.getAll()).has.a.property('module1')\n\t})\n\n\tit('define module2', function() {\n\t\tMyModule.module('module2', ['module1'], function(module1) {\n\t\t\texpect(module1.foo).to.equal(123)\n\n\t\t\treturn {\n\t\t\t\ta: 456,\n\t\t\t\tref: module1\n\t\t\t}\n\t\t})\n\n\t\texpect(MyModule.getAll()).has.a.property('module2')\n\t})\n\n\tit('define module3', function() {\n\t\tMyModule.module('module3', ['module1', 'module2'], function(module1, module2) {\n\t\t\texpect(module1.foo).to.equal(123)\n\t\t\texpect(module2.a).to.equal(456)\n\t\t\texpect(module2.ref.foo).to.equal(123)\n\n\t\t})\n\n\t\texpect(MyModule.getAll()).has.a.property('module3')\n\t})\n\n})\n```\n\n```Javascript\n// index.js\nexports = module.exports = function() {\n\n\tlet modules = {};\n\n\treturn {\n\t\tmodule: function(name, injects, body) {\n\n\t\t\tfunction enumerateInjects(injects) {\n\t\t\t\tlet tmp = [];\n\t\t\t\tfor (let i in injects) {\n\t\t\t\t\tif (modules[injects[i]]) {\n\t\t\t\t\t\tif (modules[injects[i]].dependencies.length > 0) {\n\t\t\t\t\t\t\tlet deepEnumerateInjects = enumerateInjects(modules[injects[i]].dependencies);\n\n\t\t\t\t\t\t\ttmp.push(modules[injects[i]].body.apply(null, deepEnumerateInjects))\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ttmp.push(modules[injects[i]].body())\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthrow new Error(`Inject error. No module named ${injects[i]}`);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn tmp;\n\t\t\t}\n\n\t\t\tmodules[name] = {\n\t\t\t\tdependencies: injects,\n\t\t\t\tbody: body\n\t\t\t};\n\n\t\t\tbody.apply(this, enumerateInjects(injects))\n\t\t},\n\t\tgetAll: function() {\n\t\t\treturn modules;\n\t\t}\n\t}\n}\n```\n\næœ¬æ–‡çš„æœ€åï¼Œæˆ‘ä»¬å®šä¹‰çš„module3å…¶å®å¹¶ä¸æ˜¯ä¸€ä¸ªæ¨¡å—ï¼Œå› ä¸ºå®ƒæ²¡æœ‰æ»¡è¶³ç¯‡å¤´ç»“è®ºé‡Œçš„ç¬¬äºŒæ¡ã€‚å› æ­¤åœ¨åˆ«çš„æ¨¡å—ä¸­æ³¨å…¥å®ƒæ˜¯æ¯«æ— æ„ä¹‰çš„ã€‚\n\nè‰¯å¥½çš„æ¨¡å—å®šä¹‰å’Œç®¡ç†åœ¨åä½œå¼€å‘ä¸­è‡³å…³é‡è¦ï¼Œæ¨¡å—æ¨¡å¼å¹¶æ²¡æœ‰ä»€ä¹ˆæœ€ä½³å®è·µï¼Œæœ‰çš„åªæ˜¯å¯¹ç»éªŒçš„ä¸æ®µæ€»ç»“ï¼Œæœ¬æ–‡è¯´è¿°çš„ä¹Ÿåªæ˜¯æ¨¡å—æ¨¡å¼çš„å‡¤æ¯›éºŸè§’ã€‚\n\næœ¬ç¯‡æ–‡ç« é‡Œçš„ä»£ç ä¸å»ºè®®ç”¨åˆ°ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œå»ºè®®ä½¿ç”¨ä¼˜ç§€çš„æ–¹æ¡ˆå¦‚[require.js](https://github.com/requirejs/requirejs)ã€‚\n\nå®Œæ•´æºç åœ°å€ï¼š[github](https://github.com/cyyyu/inc)\n\n","slug":"ä»€ä¹ˆæ˜¯æ¨¡å—","published":1,"updated":"2016-11-16T05:40:00.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ciwu2eolm00064n9kles7403e","content":"<h3 id=\"å†™åœ¨å‰é¢\"><a href=\"#å†™åœ¨å‰é¢\" class=\"headerlink\" title=\"å†™åœ¨å‰é¢\"></a>å†™åœ¨å‰é¢</h3><p>é˜…è¯»ä¸‹æ–‡å‡å®šä½ åŸºæœ¬äº†è§£ï¼šä½¿ç”¨<code>mocha</code>åšå•å…ƒæµ‹è¯•ï¼Œangularjsï¼Œnodejsç¯å¢ƒæ­å»ºä»¥åŠnpmçš„ä½¿ç”¨ã€‚</p>\n<p>å…ˆè¯´ç»“è®ºï¼š</p>\n<ul>\n<li><p>è¢«å‡½æ•°åŒ…è£…ï¼Œæ¯æ¬¡è°ƒç”¨å®ä¾‹åŒ–ä¸€ä¸ªæ–°çš„å¯¹è±¡æˆ–è¿”å›åŒä¸€ä¸ªå¯¹è±¡ï¼ˆå•ä¾‹æ¨¡å¼ä¸‹ï¼Œå‡½æ•°è‡³å°‘éœ€è¦è°ƒç”¨ä¸€æ¬¡ï¼‰</p>\n</li>\n<li><p>ä¸Šè¿°å‡½æ•°ä¸­æœ‰å†…éƒ¨å‡½æ•°æš´éœ²å‡ºæ¥ï¼Œä½¿å…¶å†…éƒ¨ä½œç”¨åŸŸå½¢æˆé—­åŒ…ã€‚</p>\n</li>\n</ul>\n<p>Angularjsæ˜¯ä¸ªå¾ˆâ€™æ¨¡å—åŒ–â€™çš„æ¡†æ¶ï¼Œè¿™é‡Œä¸è°ˆMVCï¼ŒMVVMï¼ŒæŒ‡ä»¤ï¼ŒæœåŠ¡ã€‚è°ˆè°ˆngä¸­çš„ä¾èµ–æ³¨å…¥ï¼Œngå‡ºä¸–æ—¶æœ€ä¸ºäººç§°é“çš„æ¦‚å¿µä¹‹ä¸€ã€‚</p>\n<p>åŸºäºä¸Šè¿°ç»“è®ºæˆ‘ä¼šå†™ä¸ªæ¨¡å—æ„é€ å™¨ï¼Œä»¥è¿™ä¸ªä¾‹å­æ¥è¯´æ˜å¦‚ä½•åˆ›å»ºä¸€ä¸ªæ¨¡å—ã€‚</p>\n<p>ä»¥ä¸‹ngæŒ‡ä»£angularã€‚</p>\n<h3 id=\"ngä¸­çš„ä¾èµ–æ³¨å…¥\"><a href=\"#ngä¸­çš„ä¾èµ–æ³¨å…¥\" class=\"headerlink\" title=\"ngä¸­çš„ä¾èµ–æ³¨å…¥\"></a>ngä¸­çš„ä¾èµ–æ³¨å…¥</h3><p>åœ¨ngä¸­ï¼Œå½“æˆ‘ä»¬è¦åˆ›å»ºä¸€ä¸ªä¸ä¾èµ–ä»»ä½•æ¨¡å—çš„æ¨¡å—<code>foo</code>ï¼Œæˆ‘ä»¬è¿™æ ·å†™ï¼š</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">angular.module(<span class=\"string\">'foo'</span>, [])</div></pre></td></tr></table></figure>\n<p>å½“æˆ‘ä»¬è¦åˆ›å»ºå¦ä¸€ä¸ªä¾èµ–ä¸Šè¿°<code>foo</code>æ¨¡å—çš„å¦ä¸€ä¸ªæ¨¡å—æ—¶æˆ‘ä»¬è¿™æ ·å†™ï¼š</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">angular.module(<span class=\"string\">'another'</span>, [<span class=\"string\">'foo'</span>])</div></pre></td></tr></table></figure>\n<p>è¿™å°±æ˜¯æœ€ç®€å•çš„ä¾èµ–æ³¨å…¥ã€‚</p>\n<p>åœ¨ç¬¬ä¸€ä¸ª<code>foo</code>æ¨¡å—ä¸­ï¼Œç”±äºangularçš„moduleæ–¹æ³•è¿”å›angularè‡ªèº«ï¼Œæˆ‘ä»¬å¯ä»¥åƒjQueryé‚£æ ·é“¾å¼è°ƒç”¨ï¼Œåœ¨å…¶ååˆ›å»ºæ¨¡å—ä¸­çš„<code>service</code>ï¼Œå°±åƒä¸‹é¢è¿™æ ·ï¼š</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">angular.module(<span class=\"string\">'foo'</span>, []).service(<span class=\"string\">'fooService'</span>, [<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">$scope</span>)</span>&#123;&#125;])</div></pre></td></tr></table></figure>\n<p>å½“<code>another</code>å£°æ˜è‡ªå·±ä¾èµ–<code>foo</code>æ—¶ï¼Œ<code>foo</code>ä¸­çš„service<strong>æ³¨å…¥</strong>äº†<code>another</code>ï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œangularå¸®åŠ©æˆ‘ä»¬å®Œæˆäº†ç¯‡å¤´çš„<strong>ç»“è®ºä¸€</strong>ï¼Œæ¨¡å—<code>another</code>æ¥ç€åˆ›å»ºcontrolleræ—¶å¯ä»¥ä½¿ç”¨fooä¸­å·²ç»åˆ›å»ºå¥½çš„serviceï¼š</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">angular.module(<span class=\"string\">'another'</span>, [<span class=\"string\">'foo'</span>]).controller(<span class=\"string\">'anotherCtrl'</span>, [<span class=\"string\">'fooService'</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">fooService</span>)</span>&#123;&#125;])</div></pre></td></tr></table></figure>\n<p>æˆ‘ä»¬æ³¨æ„åˆ°ä¸€ä¸ªç»†èŠ‚ï¼Œcontrolleræ–¹æ³•çš„ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ å£°æ˜äº†æ‰€ä¾èµ–çš„æ¨¡å—åï¼Œè€Œæ•°ç»„çš„æœ€åä¸€ä¸ªå…ƒç´ æ˜¯ä¸ªåŒ¿åå‡½æ•°ï¼Œ<code>fooService</code>åœ¨è¿™é‡Œè¢«å½“åšå‚æ•°<strong>æ³¨å…¥</strong>äº†ï¼Œæ˜¾ç„¶ï¼Œåœ¨è¿™ä¸ªåŒ¿åå‡½æ•°é‡Œä½ å¯ä»¥è°ƒç”¨fooServiceå®ä¾‹åŒ–åæš´éœ²çš„å…¬å…±apiï¼Œè®¿é—®åˆ°åˆ°åŸå§‹fooServiceé‡Œçš„ç§æœ‰å˜é‡ï¼Œjsç¨‹åºå‘˜ä¸å¯èƒ½ä¸çŸ¥é“ï¼Œè¿™å°±æ˜¯<strong>é—­åŒ…</strong>ã€‚</p>\n<h3 id=\"æˆ‘ä»¬çš„æ¨¡å—\"><a href=\"#æˆ‘ä»¬çš„æ¨¡å—\" class=\"headerlink\" title=\"æˆ‘ä»¬çš„æ¨¡å—\"></a>æˆ‘ä»¬çš„æ¨¡å—</h3><p>ngé‡Œçš„controllerï¼Œserviceç­‰å¯ä»¥è§†ä¸ºå­æ¨¡å—ï¼Œç®€å•èµ·è§ï¼Œæˆ‘ä»¬çš„æ¨¡å—å»æ‰äº†è¿™äº›æ¦‚å¿µï¼Œä½†ä¿ç•™äº†ä¾èµ–æ³¨å…¥ï¼š</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">MyModule.module(<span class=\"string\">'module1'</span>, [], <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>)</span>&#123;&#125;)</div><div class=\"line\"></div><div class=\"line\">MyModule.module(<span class=\"string\">'module2'</span>, [<span class=\"string\">'module1'</span>], <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">module1</span>)</span>&#123;&#125;)</div><div class=\"line\"></div><div class=\"line\">MyModule.module(<span class=\"string\">'module3'</span>, [<span class=\"string\">'module1'</span>, <span class=\"string\">'module2'</span>], <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">module1, module2</span>)</span>&#123;&#125;)</div></pre></td></tr></table></figure>\n<p>ä¸Šé¢çš„ä»£ç ä¸­ï¼Œ<code>MyModule</code>å®šä¹‰äº†ä¸‰ä¸ªæ¨¡å—ï¼Œmodule1ä¸ä¾èµ–ä»»ä½•æ¨¡å—ï¼Œmodule2ä¾èµ–module1ï¼Œmodule3ä¾èµ–module1å’Œmodule2ã€‚</p>\n<p>ä¸ºäº†å®ç°ä¸Šè¿°çš„æ¨¡å¼ï¼Œæˆ‘ä»¬æ¥å…ˆå†™ä¸€ç‚¹æµ‹è¯•ã€‚</p>\n<p>åˆ›å»ºä¸€ä¸ªç©ºé¡¹ç›®ç›®å½•ï¼Œåœ¨æ ¹ç›®å½•åˆ›å»ºtestæ–‡ä»¶å¤¹ï¼Œå¹¶ä¸”åœ¨testæ–‡ä»¶å¤¹å†…åˆ›å»ºmodule.jsæ–‡ä»¶ï¼Œä¸‹é¢æ˜¯module.jsæ–‡ä»¶çš„å†…å®¹ï¼š</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">let</span> expect = <span class=\"built_in\">require</span>(<span class=\"string\">'chai'</span>).expect;</div><div class=\"line\"></div><div class=\"line\">describe(<span class=\"string\">'My module tests'</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">\t<span class=\"keyword\">let</span> MyModule;</div><div class=\"line\"></div><div class=\"line\">\tbefore(<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">done</span>) </span>&#123;</div><div class=\"line\">\t\tMyModule = <span class=\"built_in\">require</span>(<span class=\"string\">'../index.js'</span>)()</div><div class=\"line\"></div><div class=\"line\">\t\tdone()</div><div class=\"line\">\t&#125;)</div><div class=\"line\"></div><div class=\"line\">\tit(<span class=\"string\">'desc MyModule'</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>)</span>&#123;</div><div class=\"line\">\t\texpect(MyModule).has.a.property(<span class=\"string\">'module'</span>)</div><div class=\"line\">\t\texpect(MyModule).has.a.property(<span class=\"string\">'getAll'</span>)</div><div class=\"line\">\t&#125;)</div><div class=\"line\">&#125;)</div></pre></td></tr></table></figure>\n<p>åœ¨æµ‹è¯•ä»£ç é‡Œæˆ‘ä»¬æŒ‡æ˜äº†æ¨¡å—æ„é€ å™¨çš„è·¯å¾„ï¼ˆæ ¹ç›®å½•çš„index.jsï¼‰ï¼Œå®ƒæä¾›äº†ä¸¤ä¸ªæ–¹æ³•ï¼Œ<code>module</code>å’Œ<code>getAll</code>ï¼Œé¡¾åæ€ä¹‰ï¼Œ<code>module</code>æ–¹æ³•å®šä¹‰æ¨¡å—ï¼Œ<code>getAll</code>æ–¹æ³•è·å¾—æ‰€æœ‰æ¨¡å—ã€‚</p>\n<p>å…ˆæ¥åˆ›å»º<code>index.js</code>ï¼Œä½¿æœ€å¼€å§‹çš„æµ‹è¯•ä»£ç é€šè¿‡ï¼š</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div></pre></td><td class=\"code\"><pre><div class=\"line\">exports = <span class=\"built_in\">module</span>.exports = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">\t<span class=\"keyword\">return</span> &#123;</div><div class=\"line\">\t\t<span class=\"attr\">module</span>: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\"></div><div class=\"line\">\t\t&#125;,</div><div class=\"line\">\t\t<span class=\"attr\">getAll</span>: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\"></div><div class=\"line\">\t\t&#125;</div><div class=\"line\">\t&#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>è¿è¡Œ<code>mocha</code>ï¼Œä¸€ç‰‡ç»¿ç¯ã€‚</p>\n<p>ç°åœ¨å¯ä»¥å®šä¹‰æˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªæ¨¡å—äº†ï¼Œåœ¨æµ‹è¯•ä»£ç ä¸­æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div></pre></td><td class=\"code\"><pre><div class=\"line\">it(<span class=\"string\">'define module1'</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">\tMyModule.module(<span class=\"string\">'module1'</span>, [], <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">\t\t\t<span class=\"keyword\">let</span> tmp = <span class=\"number\">123</span></div><div class=\"line\">\t\t\t<span class=\"keyword\">return</span> &#123;</div><div class=\"line\">\t\t\t\t<span class=\"attr\">foo</span>: tmp</div><div class=\"line\">\t\t\t&#125;</div><div class=\"line\">\t&#125;)</div><div class=\"line\"></div><div class=\"line\">\texpect(MyModule.getAll()).has.a.property(<span class=\"string\">'module1'</span>)</div><div class=\"line\">&#125;)</div></pre></td></tr></table></figure>\n<p>module1ä¸ä¾èµ–ä»»ä½•æ¨¡å—ï¼Œæ‰€ä»¥ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸ªç©ºæ•°ç»„ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°å®šä¹‰äº†module1ä½œä¸ºæ¨¡å—è¢«æ³¨å…¥å…¶å®ƒæ¨¡å—æ—¶æä¾›äº†ä»€ä¹ˆï¼Œæ³¨æ„åˆ°è¿™ä¸ªå‡½æ•°ä¸­æœ‰ä¸ªç§æœ‰å˜é‡tmpï¼Œä¸ºäº†è¯æ˜ç¨åè¿™é‡Œå½¢æˆäº†é—­åŒ…ï¼Œæˆ‘ä»¬æŠŠæš´éœ²å‡ºå»çš„fooå±æ€§æŒ‡å‘äº†tmpï¼Œç¨ååœ¨module2ä¸­æˆ‘ä»¬ä¼šå°è¯•è®¿é—®å®ƒã€‚</p>\n<p>ç°åœ¨è¿è¡Œæµ‹è¯•ä»£ç ï¼Œå½“ç„¶ä¸ä¼šé€šè¿‡ï¼Œæˆ‘ä»¬æ¥ä¸ºè¿™æ®µæµ‹è¯•è„šæœ¬æ›´æ–°index.jsã€‚</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div></pre></td><td class=\"code\"><pre><div class=\"line\">exports = <span class=\"built_in\">module</span>.exports = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"keyword\">let</span> modules = &#123;&#125;;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"keyword\">return</span> &#123;</div><div class=\"line\">\t\t<span class=\"attr\">module</span>: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">name, injects, body</span>) </span>&#123;</div><div class=\"line\"></div><div class=\"line\">\t\t\tmodules[name] = &#123;</div><div class=\"line\">\t\t\t\t<span class=\"attr\">dependencies</span>: injects,</div><div class=\"line\">\t\t\t\t<span class=\"attr\">body</span>: body</div><div class=\"line\">\t\t\t&#125;;</div><div class=\"line\">\t\t&#125;,</div><div class=\"line\">\t\t<span class=\"attr\">getAll</span>: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">\t\t\t<span class=\"keyword\">return</span> modules;</div><div class=\"line\">\t\t&#125;</div><div class=\"line\">\t&#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>å†…éƒ¨çš„ç§æœ‰å˜é‡modulesæ˜¯ä¸ªå“ˆå¸Œåˆ—è¡¨ï¼Œå› ä¸ºæ¨¡å—åæ˜¯<strong>å”¯ä¸€çš„ä¸é‡åçš„å­—ç¬¦ä¸²</strong>ï¼Œæˆ‘ä»¬è‡ªç„¶çš„æƒ³åˆ°ç”¨è¿™æ ·çš„æ•°æ®ç»“æ„å‚¨å­˜å®ƒï¼Œmoduleæ–¹æ³•ç®€å•çš„æŠŠæ¨¡å—å’Œç›¸å…³ä¿¡æ¯æ”¾åˆ°äº†modulesé‡Œï¼Œè€ŒgetAllæ–¹æ³•åˆ™ç›´æ¥è¿”å›äº†modulesã€‚</p>\n<p>è¿™æ ·ï¼Œæˆ‘ä»¬é€šè¿‡äº†ç¬¬äºŒæ®µæµ‹è¯•ã€‚</p>\n<p>ç»§ç»­å¾€ä¸‹ï¼Œåœ¨æµ‹è¯•ä»£ç ä¸­å®šä¹‰ç¬¬äºŒä¸ªæ¨¡å—ï¼š</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div></pre></td><td class=\"code\"><pre><div class=\"line\">it(<span class=\"string\">'define module2'</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">\tMyModule.module(<span class=\"string\">'module2'</span>, [<span class=\"string\">'module1'</span>], <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">module1</span>) </span>&#123;</div><div class=\"line\">\t\texpect(module1.foo).to.equal(<span class=\"number\">123</span>)</div><div class=\"line\">\t\t<span class=\"keyword\">return</span> &#123;</div><div class=\"line\">\t\t\t<span class=\"attr\">a</span>: <span class=\"number\">456</span>,</div><div class=\"line\">\t\t\t<span class=\"attr\">ref</span>: module1</div><div class=\"line\">\t\t&#125;</div><div class=\"line\">\t&#125;)</div><div class=\"line\">\texpect(MyModule.getAll()).has.a.property(<span class=\"string\">'module2'</span>)</div><div class=\"line\">&#125;)</div></pre></td></tr></table></figure>\n<p>module1è¢«æ³¨å…¥åˆ°äº†module2ä¸­ï¼Œå¹¶ä¸”åœ¨module2é‡Œæˆ‘ä»¬å°è¯•è®¿é—®module1çš„fooå±æ€§ï¼Œå¦‚æœä¸€åˆ‡é¡ºåˆ©ï¼Œå®ƒåº”è¯¥æ˜¯<code>123</code>ã€‚</p>\n<p>å®ç°ä¸Šé¢çš„é€»è¾‘æˆ‘ä»¬éœ€è¦å¯¹MyModuleçš„moduleæ–¹æ³•é‡Œçš„ç¬¬äºŒä¸ªå‚æ•°åšä¸€äº›å¤„ç†ï¼Œç°åœ¨æ¥ä¿®æ”¹index.jsï¼š</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div></pre></td><td class=\"code\"><pre><div class=\"line\">exports = <span class=\"built_in\">module</span>.exports = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"keyword\">let</span> modules = &#123;&#125;;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"keyword\">return</span> &#123;</div><div class=\"line\">\t\t<span class=\"attr\">module</span>: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">name, injects, body</span>) </span>&#123;</div><div class=\"line\"></div><div class=\"line\">\t\t\t<span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">enumerateInjects</span>(<span class=\"params\">injects</span>) </span>&#123;</div><div class=\"line\">\t\t\t\t<span class=\"keyword\">let</span> tmp = [];</div><div class=\"line\"></div><div class=\"line\">\t\t\t\t<span class=\"keyword\">for</span> (<span class=\"keyword\">let</span> i <span class=\"keyword\">in</span> injects) &#123;</div><div class=\"line\">\t\t\t\t\t<span class=\"keyword\">if</span> (modules[injects[i]]) &#123;</div><div class=\"line\">\t\t\t\t\t\ttmp.push(modules[injects[i]].body())</div><div class=\"line\">\t\t\t\t\t&#125; <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">\t\t\t\t\t\t<span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"built_in\">Error</span>(<span class=\"string\">`Inject error. No module named <span class=\"subst\">$&#123;injects[i]&#125;</span>`</span>);</div><div class=\"line\">\t\t\t\t\t&#125;</div><div class=\"line\">\t\t\t\t&#125;</div><div class=\"line\"></div><div class=\"line\">\t\t\t\t<span class=\"keyword\">return</span> tmp;</div><div class=\"line\">\t\t\t&#125;</div><div class=\"line\"></div><div class=\"line\">\t\t\tmodules[name] = &#123;</div><div class=\"line\">\t\t\t\t<span class=\"attr\">dependencies</span>: injects,</div><div class=\"line\">\t\t\t\t<span class=\"attr\">body</span>: body</div><div class=\"line\">\t\t\t&#125;;</div><div class=\"line\"></div><div class=\"line\">\t\t\tbody.apply(<span class=\"keyword\">this</span>, enumerateInjects(injects))</div><div class=\"line\">\t\t&#125;,</div><div class=\"line\">\t\t<span class=\"attr\">getAll</span>: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">\t\t\t<span class=\"keyword\">return</span> modules;</div><div class=\"line\">\t\t&#125;</div><div class=\"line\">\t&#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>enumerateInjectså‡½æ•°éå†äº†injectså‚æ•°ï¼ŒæŠŠå¯¹åº”æ¨¡å—æ‰§è¡Œï¼Œå¹¶å°†æ‰§è¡Œåçš„ç»“æœæ”¾åˆ°ä¸€ä¸ªæ•°ç»„é‡Œè¿”å›ï¼Œå¹¶ä¸”æˆ‘ä»¬è¿˜é¢å¤–åšäº†ä¸€ç‚¹é”™è¯¯å¤„ç†ï¼ˆå½“æŒ‡å®šè¦ä¾èµ–çš„æ¨¡å—ä¸å­˜åœ¨æ—¶æŠ›å‡ºé”™è¯¯ï¼‰ã€‚åœ¨moduleæ–¹æ³•çš„æœ€åï¼Œæˆ‘ä»¬æŠŠå¾—åˆ°çš„æ•°ç»„ä¼ ç»™äº†bodyå‡½æ•°ï¼Œapplyæ–¹æ³•åœ¨è¿™é‡Œå¾ˆå…³é”®ï¼Œç¬¬äºŒä¸ªå‚æ•°æ•°ç»„è¢«å±•å¼€æˆäº†å¤šä¸ªå‚æ•°ï¼Œäºæ˜¯module2æ‹¿åˆ°äº†module1æ‰§è¡Œåçš„ç»“æœã€‚</p>\n<p>æ­¤æ—¶å†è¿è¡Œä¸€éæµ‹è¯•è„šæœ¬ï¼Œæ¯”é¢„æ–™çš„è¿˜è¦é¡ºåˆ©ã€‚</p>\n<p>çœ‹ä¸Šå»æˆ‘ä»¬çš„æ„é€ å™¨å®Œæˆäº†ï¼Œmodule1é¡ºåˆ©æ³¨å…¥åˆ°äº†module2é‡Œï¼Œå®é™…ä¸Šåˆ°æ­¤ä¸ºæ­¢module1ç¡®å®æ„æˆäº†ä¸€ä¸ªæ¨¡å—ï¼Œå¯ä»¥è¢«æ³¨å…¥åˆ°ä»»ä½•æ¨¡å—ä¸­ã€‚ä½†æˆ‘ä»¬è€ƒè™‘çš„è¿˜ä¸å¤Ÿï¼Œæˆ‘ä»¬åº”è¯¥ç»§ç»­å¾€ä¸‹ï¼Œå°è¯•æ„é€ module3ï¼ŒæŠŠmodule1å’Œmodule2éƒ½æ³¨å…¥è¿›å»çœ‹çœ‹ä¼šå‘ç”Ÿä»€ä¹ˆã€‚</p>\n<p>è¡¥å……æµ‹è¯•è„šæœ¬ï¼š</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div></pre></td><td class=\"code\"><pre><div class=\"line\">it(<span class=\"string\">'define module3'</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">\tMyModule.module(<span class=\"string\">'module3'</span>, [<span class=\"string\">'module1'</span>, <span class=\"string\">'module2'</span>], <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">module1, module2</span>) </span>&#123;</div><div class=\"line\">\t\texpect(module1.foo).to.equal(<span class=\"number\">123</span>)</div><div class=\"line\">\t\texpect(module2.a).to.equal(<span class=\"number\">456</span>)</div><div class=\"line\">\t\texpect(module2.ref.foo).to.equal(<span class=\"number\">123</span>)</div><div class=\"line\"></div><div class=\"line\">\t&#125;)</div><div class=\"line\"></div><div class=\"line\">\texpect(MyModule.getAll()).has.a.property(<span class=\"string\">'module3'</span>)</div><div class=\"line\">&#125;)</div></pre></td></tr></table></figure>\n<p>å†æ¬¡è¿è¡Œæµ‹è¯•ï¼Œæ²¡æœ‰é€šè¿‡ã€‚æ§åˆ¶å°æŠ›å‡ºäº†TypeErroré”™è¯¯ï¼Œå‘Šè¯‰æˆ‘ä»¬è¿™é‡Œå¼•ç”¨äº†ä¸å­˜åœ¨çš„å±æ€§ã€‚</p>\n<p>æ€è€ƒindex.jsé‡Œçš„ä»£ç ï¼Œæˆ‘ä»¬å‡å®šmodule1çš„æ³¨å…¥æ²¡æœ‰é—®é¢˜ï¼ˆäº‹å®ä¸Šç¡®å®æ²¡é—®é¢˜ï¼Œå› ä¸ºå‰é¢å·²ç»ç»è¿‡æ£€éªŒï¼‰ï¼Œå½“æˆ‘ä»¬æŠŠmodule2æ³¨å…¥module3æ—¶enumerateInjectså‡½æ•°åšäº†ä»€ä¹ˆï¼Ÿ</p>\n<p>module2ä¾èµ–module1ï¼Œä½†éå†è¿‡ç¨‹ä¸­æˆ‘ä»¬å´å¿½ç•¥äº†è¿™ä¸€ç‚¹ï¼Œç›´æ¥æ‰§è¡Œmodule2çš„bodyè€Œä¸è€ƒè™‘å®ƒåœ¨å®šä¹‰æ—¶å£°æ˜çš„ä¾èµ–ï¼Œè‹¥module1æ­¤æ—¶æ²¡æœ‰æ³¨å…¥åˆ°module2é‡Œï¼Œè‡ªç„¶ä¸å¯èƒ½å¾—åˆ°æˆ‘ä»¬é¢„æœŸçš„ç»“æœã€‚</p>\n<p>å¯¹enumerateInjectså‡½æ•°åšå¦‚ä¸‹ä¿®æ”¹ï¼š</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">enumerateInjects</span>(<span class=\"params\">injects</span>) </span>&#123;</div><div class=\"line\">\t<span class=\"keyword\">let</span> tmp = [];</div><div class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">let</span> i <span class=\"keyword\">in</span> injects) &#123;</div><div class=\"line\">\t\t<span class=\"keyword\">if</span> (modules[injects[i]]) &#123;</div><div class=\"line\">\t\t\t<span class=\"keyword\">if</span> (modules[injects[i]].dependencies.length &gt; <span class=\"number\">0</span>) &#123;</div><div class=\"line\">\t\t\t\t<span class=\"keyword\">let</span> deepEnumerateInjects = enumerateInjects(modules[injects[i]].dependencies);</div><div class=\"line\"></div><div class=\"line\">\t\t\t\ttmp.push(modules[injects[i]].body.apply(<span class=\"literal\">null</span>, deepEnumerateInjects))</div><div class=\"line\">\t\t\t&#125; <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">\t\t\t\ttmp.push(modules[injects[i]].body())</div><div class=\"line\">\t\t\t&#125;</div><div class=\"line\">\t\t&#125; <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">\t\t\t<span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"built_in\">Error</span>(<span class=\"string\">`Inject error. No module named <span class=\"subst\">$&#123;injects[i]&#125;</span>`</span>);</div><div class=\"line\">        &#125;</div><div class=\"line\">\t&#125;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"keyword\">return</span> tmp;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>åœ¨ç¬¬ä¸€ä¸ªifåˆ¤æ–­é‡Œæˆ‘ä»¬æ·»åŠ äº†å¯¹ä¾èµ–çš„ä¾èµ–çš„ä¾èµ–â€¦çš„å¤„ç†ï¼Œæ²¡é”™ï¼Œè¿™æ˜¯ä¸ª<strong>é€’å½’</strong>ï¼Œæ— è®ºæ¨¡å—åµŒå¥—æœ‰å¤šæ·±ï¼Œåœ¨æœ‰é™çš„æ·±åº¦é‡Œæˆ‘ä»¬éƒ½å¯ä»¥å°†å®ƒä¸€ä¸ªä¸ªæ‰¾åˆ°å¹¶æœ€ç»ˆä¼ é€’ç»™å½“å‰æ¨¡å—ã€‚</p>\n<p>åˆ°æ­¤ï¼Œæµ‹è¯•è„šæœ¬é¡ºåˆ©è¿è¡Œã€‚æœ€ç»ˆæˆ‘ä»¬çš„module.jså’Œindex.jså¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">// module.js</span></div><div class=\"line\"><span class=\"keyword\">let</span> expect = <span class=\"built_in\">require</span>(<span class=\"string\">'chai'</span>).expect;</div><div class=\"line\"></div><div class=\"line\">describe(<span class=\"string\">'My module tests'</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">\t<span class=\"keyword\">let</span> MyModule;</div><div class=\"line\"></div><div class=\"line\">\tbefore(<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">done</span>) </span>&#123;</div><div class=\"line\">\t\tMyModule = <span class=\"built_in\">require</span>(<span class=\"string\">'../index.js'</span>)()</div><div class=\"line\"></div><div class=\"line\">\t\tdone()</div><div class=\"line\">\t&#125;)</div><div class=\"line\"></div><div class=\"line\">\tit(<span class=\"string\">'desc MyModule'</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">\t\texpect(MyModule).has.a.property(<span class=\"string\">'module'</span>)</div><div class=\"line\">\t\texpect(MyModule).has.a.property(<span class=\"string\">'getAll'</span>)</div><div class=\"line\">\t&#125;)</div><div class=\"line\"></div><div class=\"line\">\tit(<span class=\"string\">'define module1'</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">\t\tMyModule.module(<span class=\"string\">'module1'</span>, [], <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">\t\t\t<span class=\"keyword\">let</span> tmp = <span class=\"number\">123</span></div><div class=\"line\">\t\t\t<span class=\"keyword\">return</span> &#123;</div><div class=\"line\">\t\t\t\t<span class=\"attr\">foo</span>: tmp</div><div class=\"line\">\t\t\t&#125;</div><div class=\"line\">\t\t&#125;)</div><div class=\"line\"></div><div class=\"line\">\t\texpect(MyModule.getAll()).has.a.property(<span class=\"string\">'module1'</span>)</div><div class=\"line\">\t&#125;)</div><div class=\"line\"></div><div class=\"line\">\tit(<span class=\"string\">'define module2'</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">\t\tMyModule.module(<span class=\"string\">'module2'</span>, [<span class=\"string\">'module1'</span>], <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">module1</span>) </span>&#123;</div><div class=\"line\">\t\t\texpect(module1.foo).to.equal(<span class=\"number\">123</span>)</div><div class=\"line\"></div><div class=\"line\">\t\t\t<span class=\"keyword\">return</span> &#123;</div><div class=\"line\">\t\t\t\t<span class=\"attr\">a</span>: <span class=\"number\">456</span>,</div><div class=\"line\">\t\t\t\t<span class=\"attr\">ref</span>: module1</div><div class=\"line\">\t\t\t&#125;</div><div class=\"line\">\t\t&#125;)</div><div class=\"line\"></div><div class=\"line\">\t\texpect(MyModule.getAll()).has.a.property(<span class=\"string\">'module2'</span>)</div><div class=\"line\">\t&#125;)</div><div class=\"line\"></div><div class=\"line\">\tit(<span class=\"string\">'define module3'</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">\t\tMyModule.module(<span class=\"string\">'module3'</span>, [<span class=\"string\">'module1'</span>, <span class=\"string\">'module2'</span>], <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">module1, module2</span>) </span>&#123;</div><div class=\"line\">\t\t\texpect(module1.foo).to.equal(<span class=\"number\">123</span>)</div><div class=\"line\">\t\t\texpect(module2.a).to.equal(<span class=\"number\">456</span>)</div><div class=\"line\">\t\t\texpect(module2.ref.foo).to.equal(<span class=\"number\">123</span>)</div><div class=\"line\"></div><div class=\"line\">\t\t&#125;)</div><div class=\"line\"></div><div class=\"line\">\t\texpect(MyModule.getAll()).has.a.property(<span class=\"string\">'module3'</span>)</div><div class=\"line\">\t&#125;)</div><div class=\"line\"></div><div class=\"line\">&#125;)</div></pre></td></tr></table></figure>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">// index.js</span></div><div class=\"line\">exports = <span class=\"built_in\">module</span>.exports = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"keyword\">let</span> modules = &#123;&#125;;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"keyword\">return</span> &#123;</div><div class=\"line\">\t\t<span class=\"attr\">module</span>: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">name, injects, body</span>) </span>&#123;</div><div class=\"line\"></div><div class=\"line\">\t\t\t<span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">enumerateInjects</span>(<span class=\"params\">injects</span>) </span>&#123;</div><div class=\"line\">\t\t\t\t<span class=\"keyword\">let</span> tmp = [];</div><div class=\"line\">\t\t\t\t<span class=\"keyword\">for</span> (<span class=\"keyword\">let</span> i <span class=\"keyword\">in</span> injects) &#123;</div><div class=\"line\">\t\t\t\t\t<span class=\"keyword\">if</span> (modules[injects[i]]) &#123;</div><div class=\"line\">\t\t\t\t\t\t<span class=\"keyword\">if</span> (modules[injects[i]].dependencies.length &gt; <span class=\"number\">0</span>) &#123;</div><div class=\"line\">\t\t\t\t\t\t\t<span class=\"keyword\">let</span> deepEnumerateInjects = enumerateInjects(modules[injects[i]].dependencies);</div><div class=\"line\"></div><div class=\"line\">\t\t\t\t\t\t\ttmp.push(modules[injects[i]].body.apply(<span class=\"literal\">null</span>, deepEnumerateInjects))</div><div class=\"line\">\t\t\t\t\t\t&#125; <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">\t\t\t\t\t\t\ttmp.push(modules[injects[i]].body())</div><div class=\"line\">\t\t\t\t\t\t&#125;</div><div class=\"line\">\t\t\t\t\t&#125; <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">\t\t\t\t\t\t<span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"built_in\">Error</span>(<span class=\"string\">`Inject error. No module named <span class=\"subst\">$&#123;injects[i]&#125;</span>`</span>);</div><div class=\"line\">\t\t\t\t\t&#125;</div><div class=\"line\">\t\t\t\t&#125;</div><div class=\"line\"></div><div class=\"line\">\t\t\t\t<span class=\"keyword\">return</span> tmp;</div><div class=\"line\">\t\t\t&#125;</div><div class=\"line\"></div><div class=\"line\">\t\t\tmodules[name] = &#123;</div><div class=\"line\">\t\t\t\t<span class=\"attr\">dependencies</span>: injects,</div><div class=\"line\">\t\t\t\t<span class=\"attr\">body</span>: body</div><div class=\"line\">\t\t\t&#125;;</div><div class=\"line\"></div><div class=\"line\">\t\t\tbody.apply(<span class=\"keyword\">this</span>, enumerateInjects(injects))</div><div class=\"line\">\t\t&#125;,</div><div class=\"line\">\t\t<span class=\"attr\">getAll</span>: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">\t\t\t<span class=\"keyword\">return</span> modules;</div><div class=\"line\">\t\t&#125;</div><div class=\"line\">\t&#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>æœ¬æ–‡çš„æœ€åï¼Œæˆ‘ä»¬å®šä¹‰çš„module3å…¶å®å¹¶ä¸æ˜¯ä¸€ä¸ªæ¨¡å—ï¼Œå› ä¸ºå®ƒæ²¡æœ‰æ»¡è¶³ç¯‡å¤´ç»“è®ºé‡Œçš„ç¬¬äºŒæ¡ã€‚å› æ­¤åœ¨åˆ«çš„æ¨¡å—ä¸­æ³¨å…¥å®ƒæ˜¯æ¯«æ— æ„ä¹‰çš„ã€‚</p>\n<p>è‰¯å¥½çš„æ¨¡å—å®šä¹‰å’Œç®¡ç†åœ¨åä½œå¼€å‘ä¸­è‡³å…³é‡è¦ï¼Œæ¨¡å—æ¨¡å¼å¹¶æ²¡æœ‰ä»€ä¹ˆæœ€ä½³å®è·µï¼Œæœ‰çš„åªæ˜¯å¯¹ç»éªŒçš„ä¸æ®µæ€»ç»“ï¼Œæœ¬æ–‡è¯´è¿°çš„ä¹Ÿåªæ˜¯æ¨¡å—æ¨¡å¼çš„å‡¤æ¯›éºŸè§’ã€‚</p>\n<p>æœ¬ç¯‡æ–‡ç« é‡Œçš„ä»£ç ä¸å»ºè®®ç”¨åˆ°ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œå»ºè®®ä½¿ç”¨ä¼˜ç§€çš„æ–¹æ¡ˆå¦‚<a href=\"https://github.com/requirejs/requirejs\" target=\"_blank\" rel=\"external\">require.js</a>ã€‚</p>\n<p>å®Œæ•´æºç åœ°å€ï¼š<a href=\"https://github.com/cyyyu/inc\" target=\"_blank\" rel=\"external\">github</a></p>\n","excerpt":"","more":"<h3 id=\"å†™åœ¨å‰é¢\"><a href=\"#å†™åœ¨å‰é¢\" class=\"headerlink\" title=\"å†™åœ¨å‰é¢\"></a>å†™åœ¨å‰é¢</h3><p>é˜…è¯»ä¸‹æ–‡å‡å®šä½ åŸºæœ¬äº†è§£ï¼šä½¿ç”¨<code>mocha</code>åšå•å…ƒæµ‹è¯•ï¼Œangularjsï¼Œnodejsç¯å¢ƒæ­å»ºä»¥åŠnpmçš„ä½¿ç”¨ã€‚</p>\n<p>å…ˆè¯´ç»“è®ºï¼š</p>\n<ul>\n<li><p>è¢«å‡½æ•°åŒ…è£…ï¼Œæ¯æ¬¡è°ƒç”¨å®ä¾‹åŒ–ä¸€ä¸ªæ–°çš„å¯¹è±¡æˆ–è¿”å›åŒä¸€ä¸ªå¯¹è±¡ï¼ˆå•ä¾‹æ¨¡å¼ä¸‹ï¼Œå‡½æ•°è‡³å°‘éœ€è¦è°ƒç”¨ä¸€æ¬¡ï¼‰</p>\n</li>\n<li><p>ä¸Šè¿°å‡½æ•°ä¸­æœ‰å†…éƒ¨å‡½æ•°æš´éœ²å‡ºæ¥ï¼Œä½¿å…¶å†…éƒ¨ä½œç”¨åŸŸå½¢æˆé—­åŒ…ã€‚</p>\n</li>\n</ul>\n<p>Angularjsæ˜¯ä¸ªå¾ˆâ€™æ¨¡å—åŒ–â€™çš„æ¡†æ¶ï¼Œè¿™é‡Œä¸è°ˆMVCï¼ŒMVVMï¼ŒæŒ‡ä»¤ï¼ŒæœåŠ¡ã€‚è°ˆè°ˆngä¸­çš„ä¾èµ–æ³¨å…¥ï¼Œngå‡ºä¸–æ—¶æœ€ä¸ºäººç§°é“çš„æ¦‚å¿µä¹‹ä¸€ã€‚</p>\n<p>åŸºäºä¸Šè¿°ç»“è®ºæˆ‘ä¼šå†™ä¸ªæ¨¡å—æ„é€ å™¨ï¼Œä»¥è¿™ä¸ªä¾‹å­æ¥è¯´æ˜å¦‚ä½•åˆ›å»ºä¸€ä¸ªæ¨¡å—ã€‚</p>\n<p>ä»¥ä¸‹ngæŒ‡ä»£angularã€‚</p>\n<h3 id=\"ngä¸­çš„ä¾èµ–æ³¨å…¥\"><a href=\"#ngä¸­çš„ä¾èµ–æ³¨å…¥\" class=\"headerlink\" title=\"ngä¸­çš„ä¾èµ–æ³¨å…¥\"></a>ngä¸­çš„ä¾èµ–æ³¨å…¥</h3><p>åœ¨ngä¸­ï¼Œå½“æˆ‘ä»¬è¦åˆ›å»ºä¸€ä¸ªä¸ä¾èµ–ä»»ä½•æ¨¡å—çš„æ¨¡å—<code>foo</code>ï¼Œæˆ‘ä»¬è¿™æ ·å†™ï¼š</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">angular.module(<span class=\"string\">'foo'</span>, [])</div></pre></td></tr></table></figure>\n<p>å½“æˆ‘ä»¬è¦åˆ›å»ºå¦ä¸€ä¸ªä¾èµ–ä¸Šè¿°<code>foo</code>æ¨¡å—çš„å¦ä¸€ä¸ªæ¨¡å—æ—¶æˆ‘ä»¬è¿™æ ·å†™ï¼š</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">angular.module(<span class=\"string\">'another'</span>, [<span class=\"string\">'foo'</span>])</div></pre></td></tr></table></figure>\n<p>è¿™å°±æ˜¯æœ€ç®€å•çš„ä¾èµ–æ³¨å…¥ã€‚</p>\n<p>åœ¨ç¬¬ä¸€ä¸ª<code>foo</code>æ¨¡å—ä¸­ï¼Œç”±äºangularçš„moduleæ–¹æ³•è¿”å›angularè‡ªèº«ï¼Œæˆ‘ä»¬å¯ä»¥åƒjQueryé‚£æ ·é“¾å¼è°ƒç”¨ï¼Œåœ¨å…¶ååˆ›å»ºæ¨¡å—ä¸­çš„<code>service</code>ï¼Œå°±åƒä¸‹é¢è¿™æ ·ï¼š</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">angular.module(<span class=\"string\">'foo'</span>, []).service(<span class=\"string\">'fooService'</span>, [<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">$scope</span>)</span>&#123;&#125;])</div></pre></td></tr></table></figure>\n<p>å½“<code>another</code>å£°æ˜è‡ªå·±ä¾èµ–<code>foo</code>æ—¶ï¼Œ<code>foo</code>ä¸­çš„service<strong>æ³¨å…¥</strong>äº†<code>another</code>ï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œangularå¸®åŠ©æˆ‘ä»¬å®Œæˆäº†ç¯‡å¤´çš„<strong>ç»“è®ºä¸€</strong>ï¼Œæ¨¡å—<code>another</code>æ¥ç€åˆ›å»ºcontrolleræ—¶å¯ä»¥ä½¿ç”¨fooä¸­å·²ç»åˆ›å»ºå¥½çš„serviceï¼š</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">angular.module(<span class=\"string\">'another'</span>, [<span class=\"string\">'foo'</span>]).controller(<span class=\"string\">'anotherCtrl'</span>, [<span class=\"string\">'fooService'</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">fooService</span>)</span>&#123;&#125;])</div></pre></td></tr></table></figure>\n<p>æˆ‘ä»¬æ³¨æ„åˆ°ä¸€ä¸ªç»†èŠ‚ï¼Œcontrolleræ–¹æ³•çš„ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ å£°æ˜äº†æ‰€ä¾èµ–çš„æ¨¡å—åï¼Œè€Œæ•°ç»„çš„æœ€åä¸€ä¸ªå…ƒç´ æ˜¯ä¸ªåŒ¿åå‡½æ•°ï¼Œ<code>fooService</code>åœ¨è¿™é‡Œè¢«å½“åšå‚æ•°<strong>æ³¨å…¥</strong>äº†ï¼Œæ˜¾ç„¶ï¼Œåœ¨è¿™ä¸ªåŒ¿åå‡½æ•°é‡Œä½ å¯ä»¥è°ƒç”¨fooServiceå®ä¾‹åŒ–åæš´éœ²çš„å…¬å…±apiï¼Œè®¿é—®åˆ°åˆ°åŸå§‹fooServiceé‡Œçš„ç§æœ‰å˜é‡ï¼Œjsç¨‹åºå‘˜ä¸å¯èƒ½ä¸çŸ¥é“ï¼Œè¿™å°±æ˜¯<strong>é—­åŒ…</strong>ã€‚</p>\n<h3 id=\"æˆ‘ä»¬çš„æ¨¡å—\"><a href=\"#æˆ‘ä»¬çš„æ¨¡å—\" class=\"headerlink\" title=\"æˆ‘ä»¬çš„æ¨¡å—\"></a>æˆ‘ä»¬çš„æ¨¡å—</h3><p>ngé‡Œçš„controllerï¼Œserviceç­‰å¯ä»¥è§†ä¸ºå­æ¨¡å—ï¼Œç®€å•èµ·è§ï¼Œæˆ‘ä»¬çš„æ¨¡å—å»æ‰äº†è¿™äº›æ¦‚å¿µï¼Œä½†ä¿ç•™äº†ä¾èµ–æ³¨å…¥ï¼š</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">MyModule.module(<span class=\"string\">'module1'</span>, [], <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>)</span>&#123;&#125;)</div><div class=\"line\"></div><div class=\"line\">MyModule.module(<span class=\"string\">'module2'</span>, [<span class=\"string\">'module1'</span>], <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">module1</span>)</span>&#123;&#125;)</div><div class=\"line\"></div><div class=\"line\">MyModule.module(<span class=\"string\">'module3'</span>, [<span class=\"string\">'module1'</span>, <span class=\"string\">'module2'</span>], <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">module1, module2</span>)</span>&#123;&#125;)</div></pre></td></tr></table></figure>\n<p>ä¸Šé¢çš„ä»£ç ä¸­ï¼Œ<code>MyModule</code>å®šä¹‰äº†ä¸‰ä¸ªæ¨¡å—ï¼Œmodule1ä¸ä¾èµ–ä»»ä½•æ¨¡å—ï¼Œmodule2ä¾èµ–module1ï¼Œmodule3ä¾èµ–module1å’Œmodule2ã€‚</p>\n<p>ä¸ºäº†å®ç°ä¸Šè¿°çš„æ¨¡å¼ï¼Œæˆ‘ä»¬æ¥å…ˆå†™ä¸€ç‚¹æµ‹è¯•ã€‚</p>\n<p>åˆ›å»ºä¸€ä¸ªç©ºé¡¹ç›®ç›®å½•ï¼Œåœ¨æ ¹ç›®å½•åˆ›å»ºtestæ–‡ä»¶å¤¹ï¼Œå¹¶ä¸”åœ¨testæ–‡ä»¶å¤¹å†…åˆ›å»ºmodule.jsæ–‡ä»¶ï¼Œä¸‹é¢æ˜¯module.jsæ–‡ä»¶çš„å†…å®¹ï¼š</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">let</span> expect = <span class=\"built_in\">require</span>(<span class=\"string\">'chai'</span>).expect;</div><div class=\"line\"></div><div class=\"line\">describe(<span class=\"string\">'My module tests'</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">\t<span class=\"keyword\">let</span> MyModule;</div><div class=\"line\"></div><div class=\"line\">\tbefore(<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">done</span>) </span>&#123;</div><div class=\"line\">\t\tMyModule = <span class=\"built_in\">require</span>(<span class=\"string\">'../index.js'</span>)()</div><div class=\"line\"></div><div class=\"line\">\t\tdone()</div><div class=\"line\">\t&#125;)</div><div class=\"line\"></div><div class=\"line\">\tit(<span class=\"string\">'desc MyModule'</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>)</span>&#123;</div><div class=\"line\">\t\texpect(MyModule).has.a.property(<span class=\"string\">'module'</span>)</div><div class=\"line\">\t\texpect(MyModule).has.a.property(<span class=\"string\">'getAll'</span>)</div><div class=\"line\">\t&#125;)</div><div class=\"line\">&#125;)</div></pre></td></tr></table></figure>\n<p>åœ¨æµ‹è¯•ä»£ç é‡Œæˆ‘ä»¬æŒ‡æ˜äº†æ¨¡å—æ„é€ å™¨çš„è·¯å¾„ï¼ˆæ ¹ç›®å½•çš„index.jsï¼‰ï¼Œå®ƒæä¾›äº†ä¸¤ä¸ªæ–¹æ³•ï¼Œ<code>module</code>å’Œ<code>getAll</code>ï¼Œé¡¾åæ€ä¹‰ï¼Œ<code>module</code>æ–¹æ³•å®šä¹‰æ¨¡å—ï¼Œ<code>getAll</code>æ–¹æ³•è·å¾—æ‰€æœ‰æ¨¡å—ã€‚</p>\n<p>å…ˆæ¥åˆ›å»º<code>index.js</code>ï¼Œä½¿æœ€å¼€å§‹çš„æµ‹è¯•ä»£ç é€šè¿‡ï¼š</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div></pre></td><td class=\"code\"><pre><div class=\"line\">exports = <span class=\"built_in\">module</span>.exports = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">\t<span class=\"keyword\">return</span> &#123;</div><div class=\"line\">\t\t<span class=\"attr\">module</span>: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\"></div><div class=\"line\">\t\t&#125;,</div><div class=\"line\">\t\t<span class=\"attr\">getAll</span>: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\"></div><div class=\"line\">\t\t&#125;</div><div class=\"line\">\t&#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>è¿è¡Œ<code>mocha</code>ï¼Œä¸€ç‰‡ç»¿ç¯ã€‚</p>\n<p>ç°åœ¨å¯ä»¥å®šä¹‰æˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªæ¨¡å—äº†ï¼Œåœ¨æµ‹è¯•ä»£ç ä¸­æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div></pre></td><td class=\"code\"><pre><div class=\"line\">it(<span class=\"string\">'define module1'</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">\tMyModule.module(<span class=\"string\">'module1'</span>, [], <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">\t\t\t<span class=\"keyword\">let</span> tmp = <span class=\"number\">123</span></div><div class=\"line\">\t\t\t<span class=\"keyword\">return</span> &#123;</div><div class=\"line\">\t\t\t\t<span class=\"attr\">foo</span>: tmp</div><div class=\"line\">\t\t\t&#125;</div><div class=\"line\">\t&#125;)</div><div class=\"line\"></div><div class=\"line\">\texpect(MyModule.getAll()).has.a.property(<span class=\"string\">'module1'</span>)</div><div class=\"line\">&#125;)</div></pre></td></tr></table></figure>\n<p>module1ä¸ä¾èµ–ä»»ä½•æ¨¡å—ï¼Œæ‰€ä»¥ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸ªç©ºæ•°ç»„ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°å®šä¹‰äº†module1ä½œä¸ºæ¨¡å—è¢«æ³¨å…¥å…¶å®ƒæ¨¡å—æ—¶æä¾›äº†ä»€ä¹ˆï¼Œæ³¨æ„åˆ°è¿™ä¸ªå‡½æ•°ä¸­æœ‰ä¸ªç§æœ‰å˜é‡tmpï¼Œä¸ºäº†è¯æ˜ç¨åè¿™é‡Œå½¢æˆäº†é—­åŒ…ï¼Œæˆ‘ä»¬æŠŠæš´éœ²å‡ºå»çš„fooå±æ€§æŒ‡å‘äº†tmpï¼Œç¨ååœ¨module2ä¸­æˆ‘ä»¬ä¼šå°è¯•è®¿é—®å®ƒã€‚</p>\n<p>ç°åœ¨è¿è¡Œæµ‹è¯•ä»£ç ï¼Œå½“ç„¶ä¸ä¼šé€šè¿‡ï¼Œæˆ‘ä»¬æ¥ä¸ºè¿™æ®µæµ‹è¯•è„šæœ¬æ›´æ–°index.jsã€‚</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div></pre></td><td class=\"code\"><pre><div class=\"line\">exports = <span class=\"built_in\">module</span>.exports = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"keyword\">let</span> modules = &#123;&#125;;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"keyword\">return</span> &#123;</div><div class=\"line\">\t\t<span class=\"attr\">module</span>: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">name, injects, body</span>) </span>&#123;</div><div class=\"line\"></div><div class=\"line\">\t\t\tmodules[name] = &#123;</div><div class=\"line\">\t\t\t\t<span class=\"attr\">dependencies</span>: injects,</div><div class=\"line\">\t\t\t\t<span class=\"attr\">body</span>: body</div><div class=\"line\">\t\t\t&#125;;</div><div class=\"line\">\t\t&#125;,</div><div class=\"line\">\t\t<span class=\"attr\">getAll</span>: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">\t\t\t<span class=\"keyword\">return</span> modules;</div><div class=\"line\">\t\t&#125;</div><div class=\"line\">\t&#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>å†…éƒ¨çš„ç§æœ‰å˜é‡modulesæ˜¯ä¸ªå“ˆå¸Œåˆ—è¡¨ï¼Œå› ä¸ºæ¨¡å—åæ˜¯<strong>å”¯ä¸€çš„ä¸é‡åçš„å­—ç¬¦ä¸²</strong>ï¼Œæˆ‘ä»¬è‡ªç„¶çš„æƒ³åˆ°ç”¨è¿™æ ·çš„æ•°æ®ç»“æ„å‚¨å­˜å®ƒï¼Œmoduleæ–¹æ³•ç®€å•çš„æŠŠæ¨¡å—å’Œç›¸å…³ä¿¡æ¯æ”¾åˆ°äº†modulesé‡Œï¼Œè€ŒgetAllæ–¹æ³•åˆ™ç›´æ¥è¿”å›äº†modulesã€‚</p>\n<p>è¿™æ ·ï¼Œæˆ‘ä»¬é€šè¿‡äº†ç¬¬äºŒæ®µæµ‹è¯•ã€‚</p>\n<p>ç»§ç»­å¾€ä¸‹ï¼Œåœ¨æµ‹è¯•ä»£ç ä¸­å®šä¹‰ç¬¬äºŒä¸ªæ¨¡å—ï¼š</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div></pre></td><td class=\"code\"><pre><div class=\"line\">it(<span class=\"string\">'define module2'</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">\tMyModule.module(<span class=\"string\">'module2'</span>, [<span class=\"string\">'module1'</span>], <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">module1</span>) </span>&#123;</div><div class=\"line\">\t\texpect(module1.foo).to.equal(<span class=\"number\">123</span>)</div><div class=\"line\">\t\t<span class=\"keyword\">return</span> &#123;</div><div class=\"line\">\t\t\t<span class=\"attr\">a</span>: <span class=\"number\">456</span>,</div><div class=\"line\">\t\t\t<span class=\"attr\">ref</span>: module1</div><div class=\"line\">\t\t&#125;</div><div class=\"line\">\t&#125;)</div><div class=\"line\">\texpect(MyModule.getAll()).has.a.property(<span class=\"string\">'module2'</span>)</div><div class=\"line\">&#125;)</div></pre></td></tr></table></figure>\n<p>module1è¢«æ³¨å…¥åˆ°äº†module2ä¸­ï¼Œå¹¶ä¸”åœ¨module2é‡Œæˆ‘ä»¬å°è¯•è®¿é—®module1çš„fooå±æ€§ï¼Œå¦‚æœä¸€åˆ‡é¡ºåˆ©ï¼Œå®ƒåº”è¯¥æ˜¯<code>123</code>ã€‚</p>\n<p>å®ç°ä¸Šé¢çš„é€»è¾‘æˆ‘ä»¬éœ€è¦å¯¹MyModuleçš„moduleæ–¹æ³•é‡Œçš„ç¬¬äºŒä¸ªå‚æ•°åšä¸€äº›å¤„ç†ï¼Œç°åœ¨æ¥ä¿®æ”¹index.jsï¼š</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div></pre></td><td class=\"code\"><pre><div class=\"line\">exports = <span class=\"built_in\">module</span>.exports = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"keyword\">let</span> modules = &#123;&#125;;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"keyword\">return</span> &#123;</div><div class=\"line\">\t\t<span class=\"attr\">module</span>: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">name, injects, body</span>) </span>&#123;</div><div class=\"line\"></div><div class=\"line\">\t\t\t<span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">enumerateInjects</span>(<span class=\"params\">injects</span>) </span>&#123;</div><div class=\"line\">\t\t\t\t<span class=\"keyword\">let</span> tmp = [];</div><div class=\"line\"></div><div class=\"line\">\t\t\t\t<span class=\"keyword\">for</span> (<span class=\"keyword\">let</span> i <span class=\"keyword\">in</span> injects) &#123;</div><div class=\"line\">\t\t\t\t\t<span class=\"keyword\">if</span> (modules[injects[i]]) &#123;</div><div class=\"line\">\t\t\t\t\t\ttmp.push(modules[injects[i]].body())</div><div class=\"line\">\t\t\t\t\t&#125; <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">\t\t\t\t\t\t<span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"built_in\">Error</span>(<span class=\"string\">`Inject error. No module named <span class=\"subst\">$&#123;injects[i]&#125;</span>`</span>);</div><div class=\"line\">\t\t\t\t\t&#125;</div><div class=\"line\">\t\t\t\t&#125;</div><div class=\"line\"></div><div class=\"line\">\t\t\t\t<span class=\"keyword\">return</span> tmp;</div><div class=\"line\">\t\t\t&#125;</div><div class=\"line\"></div><div class=\"line\">\t\t\tmodules[name] = &#123;</div><div class=\"line\">\t\t\t\t<span class=\"attr\">dependencies</span>: injects,</div><div class=\"line\">\t\t\t\t<span class=\"attr\">body</span>: body</div><div class=\"line\">\t\t\t&#125;;</div><div class=\"line\"></div><div class=\"line\">\t\t\tbody.apply(<span class=\"keyword\">this</span>, enumerateInjects(injects))</div><div class=\"line\">\t\t&#125;,</div><div class=\"line\">\t\t<span class=\"attr\">getAll</span>: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">\t\t\t<span class=\"keyword\">return</span> modules;</div><div class=\"line\">\t\t&#125;</div><div class=\"line\">\t&#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>enumerateInjectså‡½æ•°éå†äº†injectså‚æ•°ï¼ŒæŠŠå¯¹åº”æ¨¡å—æ‰§è¡Œï¼Œå¹¶å°†æ‰§è¡Œåçš„ç»“æœæ”¾åˆ°ä¸€ä¸ªæ•°ç»„é‡Œè¿”å›ï¼Œå¹¶ä¸”æˆ‘ä»¬è¿˜é¢å¤–åšäº†ä¸€ç‚¹é”™è¯¯å¤„ç†ï¼ˆå½“æŒ‡å®šè¦ä¾èµ–çš„æ¨¡å—ä¸å­˜åœ¨æ—¶æŠ›å‡ºé”™è¯¯ï¼‰ã€‚åœ¨moduleæ–¹æ³•çš„æœ€åï¼Œæˆ‘ä»¬æŠŠå¾—åˆ°çš„æ•°ç»„ä¼ ç»™äº†bodyå‡½æ•°ï¼Œapplyæ–¹æ³•åœ¨è¿™é‡Œå¾ˆå…³é”®ï¼Œç¬¬äºŒä¸ªå‚æ•°æ•°ç»„è¢«å±•å¼€æˆäº†å¤šä¸ªå‚æ•°ï¼Œäºæ˜¯module2æ‹¿åˆ°äº†module1æ‰§è¡Œåçš„ç»“æœã€‚</p>\n<p>æ­¤æ—¶å†è¿è¡Œä¸€éæµ‹è¯•è„šæœ¬ï¼Œæ¯”é¢„æ–™çš„è¿˜è¦é¡ºåˆ©ã€‚</p>\n<p>çœ‹ä¸Šå»æˆ‘ä»¬çš„æ„é€ å™¨å®Œæˆäº†ï¼Œmodule1é¡ºåˆ©æ³¨å…¥åˆ°äº†module2é‡Œï¼Œå®é™…ä¸Šåˆ°æ­¤ä¸ºæ­¢module1ç¡®å®æ„æˆäº†ä¸€ä¸ªæ¨¡å—ï¼Œå¯ä»¥è¢«æ³¨å…¥åˆ°ä»»ä½•æ¨¡å—ä¸­ã€‚ä½†æˆ‘ä»¬è€ƒè™‘çš„è¿˜ä¸å¤Ÿï¼Œæˆ‘ä»¬åº”è¯¥ç»§ç»­å¾€ä¸‹ï¼Œå°è¯•æ„é€ module3ï¼ŒæŠŠmodule1å’Œmodule2éƒ½æ³¨å…¥è¿›å»çœ‹çœ‹ä¼šå‘ç”Ÿä»€ä¹ˆã€‚</p>\n<p>è¡¥å……æµ‹è¯•è„šæœ¬ï¼š</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div></pre></td><td class=\"code\"><pre><div class=\"line\">it(<span class=\"string\">'define module3'</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">\tMyModule.module(<span class=\"string\">'module3'</span>, [<span class=\"string\">'module1'</span>, <span class=\"string\">'module2'</span>], <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">module1, module2</span>) </span>&#123;</div><div class=\"line\">\t\texpect(module1.foo).to.equal(<span class=\"number\">123</span>)</div><div class=\"line\">\t\texpect(module2.a).to.equal(<span class=\"number\">456</span>)</div><div class=\"line\">\t\texpect(module2.ref.foo).to.equal(<span class=\"number\">123</span>)</div><div class=\"line\"></div><div class=\"line\">\t&#125;)</div><div class=\"line\"></div><div class=\"line\">\texpect(MyModule.getAll()).has.a.property(<span class=\"string\">'module3'</span>)</div><div class=\"line\">&#125;)</div></pre></td></tr></table></figure>\n<p>å†æ¬¡è¿è¡Œæµ‹è¯•ï¼Œæ²¡æœ‰é€šè¿‡ã€‚æ§åˆ¶å°æŠ›å‡ºäº†TypeErroré”™è¯¯ï¼Œå‘Šè¯‰æˆ‘ä»¬è¿™é‡Œå¼•ç”¨äº†ä¸å­˜åœ¨çš„å±æ€§ã€‚</p>\n<p>æ€è€ƒindex.jsé‡Œçš„ä»£ç ï¼Œæˆ‘ä»¬å‡å®šmodule1çš„æ³¨å…¥æ²¡æœ‰é—®é¢˜ï¼ˆäº‹å®ä¸Šç¡®å®æ²¡é—®é¢˜ï¼Œå› ä¸ºå‰é¢å·²ç»ç»è¿‡æ£€éªŒï¼‰ï¼Œå½“æˆ‘ä»¬æŠŠmodule2æ³¨å…¥module3æ—¶enumerateInjectså‡½æ•°åšäº†ä»€ä¹ˆï¼Ÿ</p>\n<p>module2ä¾èµ–module1ï¼Œä½†éå†è¿‡ç¨‹ä¸­æˆ‘ä»¬å´å¿½ç•¥äº†è¿™ä¸€ç‚¹ï¼Œç›´æ¥æ‰§è¡Œmodule2çš„bodyè€Œä¸è€ƒè™‘å®ƒåœ¨å®šä¹‰æ—¶å£°æ˜çš„ä¾èµ–ï¼Œè‹¥module1æ­¤æ—¶æ²¡æœ‰æ³¨å…¥åˆ°module2é‡Œï¼Œè‡ªç„¶ä¸å¯èƒ½å¾—åˆ°æˆ‘ä»¬é¢„æœŸçš„ç»“æœã€‚</p>\n<p>å¯¹enumerateInjectså‡½æ•°åšå¦‚ä¸‹ä¿®æ”¹ï¼š</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">enumerateInjects</span>(<span class=\"params\">injects</span>) </span>&#123;</div><div class=\"line\">\t<span class=\"keyword\">let</span> tmp = [];</div><div class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">let</span> i <span class=\"keyword\">in</span> injects) &#123;</div><div class=\"line\">\t\t<span class=\"keyword\">if</span> (modules[injects[i]]) &#123;</div><div class=\"line\">\t\t\t<span class=\"keyword\">if</span> (modules[injects[i]].dependencies.length &gt; <span class=\"number\">0</span>) &#123;</div><div class=\"line\">\t\t\t\t<span class=\"keyword\">let</span> deepEnumerateInjects = enumerateInjects(modules[injects[i]].dependencies);</div><div class=\"line\"></div><div class=\"line\">\t\t\t\ttmp.push(modules[injects[i]].body.apply(<span class=\"literal\">null</span>, deepEnumerateInjects))</div><div class=\"line\">\t\t\t&#125; <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">\t\t\t\ttmp.push(modules[injects[i]].body())</div><div class=\"line\">\t\t\t&#125;</div><div class=\"line\">\t\t&#125; <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">\t\t\t<span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"built_in\">Error</span>(<span class=\"string\">`Inject error. No module named <span class=\"subst\">$&#123;injects[i]&#125;</span>`</span>);</div><div class=\"line\">        &#125;</div><div class=\"line\">\t&#125;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"keyword\">return</span> tmp;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>åœ¨ç¬¬ä¸€ä¸ªifåˆ¤æ–­é‡Œæˆ‘ä»¬æ·»åŠ äº†å¯¹ä¾èµ–çš„ä¾èµ–çš„ä¾èµ–â€¦çš„å¤„ç†ï¼Œæ²¡é”™ï¼Œè¿™æ˜¯ä¸ª<strong>é€’å½’</strong>ï¼Œæ— è®ºæ¨¡å—åµŒå¥—æœ‰å¤šæ·±ï¼Œåœ¨æœ‰é™çš„æ·±åº¦é‡Œæˆ‘ä»¬éƒ½å¯ä»¥å°†å®ƒä¸€ä¸ªä¸ªæ‰¾åˆ°å¹¶æœ€ç»ˆä¼ é€’ç»™å½“å‰æ¨¡å—ã€‚</p>\n<p>åˆ°æ­¤ï¼Œæµ‹è¯•è„šæœ¬é¡ºåˆ©è¿è¡Œã€‚æœ€ç»ˆæˆ‘ä»¬çš„module.jså’Œindex.jså¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">// module.js</span></div><div class=\"line\"><span class=\"keyword\">let</span> expect = <span class=\"built_in\">require</span>(<span class=\"string\">'chai'</span>).expect;</div><div class=\"line\"></div><div class=\"line\">describe(<span class=\"string\">'My module tests'</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">\t<span class=\"keyword\">let</span> MyModule;</div><div class=\"line\"></div><div class=\"line\">\tbefore(<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">done</span>) </span>&#123;</div><div class=\"line\">\t\tMyModule = <span class=\"built_in\">require</span>(<span class=\"string\">'../index.js'</span>)()</div><div class=\"line\"></div><div class=\"line\">\t\tdone()</div><div class=\"line\">\t&#125;)</div><div class=\"line\"></div><div class=\"line\">\tit(<span class=\"string\">'desc MyModule'</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">\t\texpect(MyModule).has.a.property(<span class=\"string\">'module'</span>)</div><div class=\"line\">\t\texpect(MyModule).has.a.property(<span class=\"string\">'getAll'</span>)</div><div class=\"line\">\t&#125;)</div><div class=\"line\"></div><div class=\"line\">\tit(<span class=\"string\">'define module1'</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">\t\tMyModule.module(<span class=\"string\">'module1'</span>, [], <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">\t\t\t<span class=\"keyword\">let</span> tmp = <span class=\"number\">123</span></div><div class=\"line\">\t\t\t<span class=\"keyword\">return</span> &#123;</div><div class=\"line\">\t\t\t\t<span class=\"attr\">foo</span>: tmp</div><div class=\"line\">\t\t\t&#125;</div><div class=\"line\">\t\t&#125;)</div><div class=\"line\"></div><div class=\"line\">\t\texpect(MyModule.getAll()).has.a.property(<span class=\"string\">'module1'</span>)</div><div class=\"line\">\t&#125;)</div><div class=\"line\"></div><div class=\"line\">\tit(<span class=\"string\">'define module2'</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">\t\tMyModule.module(<span class=\"string\">'module2'</span>, [<span class=\"string\">'module1'</span>], <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">module1</span>) </span>&#123;</div><div class=\"line\">\t\t\texpect(module1.foo).to.equal(<span class=\"number\">123</span>)</div><div class=\"line\"></div><div class=\"line\">\t\t\t<span class=\"keyword\">return</span> &#123;</div><div class=\"line\">\t\t\t\t<span class=\"attr\">a</span>: <span class=\"number\">456</span>,</div><div class=\"line\">\t\t\t\t<span class=\"attr\">ref</span>: module1</div><div class=\"line\">\t\t\t&#125;</div><div class=\"line\">\t\t&#125;)</div><div class=\"line\"></div><div class=\"line\">\t\texpect(MyModule.getAll()).has.a.property(<span class=\"string\">'module2'</span>)</div><div class=\"line\">\t&#125;)</div><div class=\"line\"></div><div class=\"line\">\tit(<span class=\"string\">'define module3'</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">\t\tMyModule.module(<span class=\"string\">'module3'</span>, [<span class=\"string\">'module1'</span>, <span class=\"string\">'module2'</span>], <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">module1, module2</span>) </span>&#123;</div><div class=\"line\">\t\t\texpect(module1.foo).to.equal(<span class=\"number\">123</span>)</div><div class=\"line\">\t\t\texpect(module2.a).to.equal(<span class=\"number\">456</span>)</div><div class=\"line\">\t\t\texpect(module2.ref.foo).to.equal(<span class=\"number\">123</span>)</div><div class=\"line\"></div><div class=\"line\">\t\t&#125;)</div><div class=\"line\"></div><div class=\"line\">\t\texpect(MyModule.getAll()).has.a.property(<span class=\"string\">'module3'</span>)</div><div class=\"line\">\t&#125;)</div><div class=\"line\"></div><div class=\"line\">&#125;)</div></pre></td></tr></table></figure>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">// index.js</span></div><div class=\"line\">exports = <span class=\"built_in\">module</span>.exports = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"keyword\">let</span> modules = &#123;&#125;;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"keyword\">return</span> &#123;</div><div class=\"line\">\t\t<span class=\"attr\">module</span>: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">name, injects, body</span>) </span>&#123;</div><div class=\"line\"></div><div class=\"line\">\t\t\t<span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">enumerateInjects</span>(<span class=\"params\">injects</span>) </span>&#123;</div><div class=\"line\">\t\t\t\t<span class=\"keyword\">let</span> tmp = [];</div><div class=\"line\">\t\t\t\t<span class=\"keyword\">for</span> (<span class=\"keyword\">let</span> i <span class=\"keyword\">in</span> injects) &#123;</div><div class=\"line\">\t\t\t\t\t<span class=\"keyword\">if</span> (modules[injects[i]]) &#123;</div><div class=\"line\">\t\t\t\t\t\t<span class=\"keyword\">if</span> (modules[injects[i]].dependencies.length &gt; <span class=\"number\">0</span>) &#123;</div><div class=\"line\">\t\t\t\t\t\t\t<span class=\"keyword\">let</span> deepEnumerateInjects = enumerateInjects(modules[injects[i]].dependencies);</div><div class=\"line\"></div><div class=\"line\">\t\t\t\t\t\t\ttmp.push(modules[injects[i]].body.apply(<span class=\"literal\">null</span>, deepEnumerateInjects))</div><div class=\"line\">\t\t\t\t\t\t&#125; <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">\t\t\t\t\t\t\ttmp.push(modules[injects[i]].body())</div><div class=\"line\">\t\t\t\t\t\t&#125;</div><div class=\"line\">\t\t\t\t\t&#125; <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">\t\t\t\t\t\t<span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"built_in\">Error</span>(<span class=\"string\">`Inject error. No module named <span class=\"subst\">$&#123;injects[i]&#125;</span>`</span>);</div><div class=\"line\">\t\t\t\t\t&#125;</div><div class=\"line\">\t\t\t\t&#125;</div><div class=\"line\"></div><div class=\"line\">\t\t\t\t<span class=\"keyword\">return</span> tmp;</div><div class=\"line\">\t\t\t&#125;</div><div class=\"line\"></div><div class=\"line\">\t\t\tmodules[name] = &#123;</div><div class=\"line\">\t\t\t\t<span class=\"attr\">dependencies</span>: injects,</div><div class=\"line\">\t\t\t\t<span class=\"attr\">body</span>: body</div><div class=\"line\">\t\t\t&#125;;</div><div class=\"line\"></div><div class=\"line\">\t\t\tbody.apply(<span class=\"keyword\">this</span>, enumerateInjects(injects))</div><div class=\"line\">\t\t&#125;,</div><div class=\"line\">\t\t<span class=\"attr\">getAll</span>: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">\t\t\t<span class=\"keyword\">return</span> modules;</div><div class=\"line\">\t\t&#125;</div><div class=\"line\">\t&#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>æœ¬æ–‡çš„æœ€åï¼Œæˆ‘ä»¬å®šä¹‰çš„module3å…¶å®å¹¶ä¸æ˜¯ä¸€ä¸ªæ¨¡å—ï¼Œå› ä¸ºå®ƒæ²¡æœ‰æ»¡è¶³ç¯‡å¤´ç»“è®ºé‡Œçš„ç¬¬äºŒæ¡ã€‚å› æ­¤åœ¨åˆ«çš„æ¨¡å—ä¸­æ³¨å…¥å®ƒæ˜¯æ¯«æ— æ„ä¹‰çš„ã€‚</p>\n<p>è‰¯å¥½çš„æ¨¡å—å®šä¹‰å’Œç®¡ç†åœ¨åä½œå¼€å‘ä¸­è‡³å…³é‡è¦ï¼Œæ¨¡å—æ¨¡å¼å¹¶æ²¡æœ‰ä»€ä¹ˆæœ€ä½³å®è·µï¼Œæœ‰çš„åªæ˜¯å¯¹ç»éªŒçš„ä¸æ®µæ€»ç»“ï¼Œæœ¬æ–‡è¯´è¿°çš„ä¹Ÿåªæ˜¯æ¨¡å—æ¨¡å¼çš„å‡¤æ¯›éºŸè§’ã€‚</p>\n<p>æœ¬ç¯‡æ–‡ç« é‡Œçš„ä»£ç ä¸å»ºè®®ç”¨åˆ°ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œå»ºè®®ä½¿ç”¨ä¼˜ç§€çš„æ–¹æ¡ˆå¦‚<a href=\"https://github.com/requirejs/requirejs\">require.js</a>ã€‚</p>\n<p>å®Œæ•´æºç åœ°å€ï¼š<a href=\"https://github.com/cyyyu/inc\">github</a></p>\n"},{"title":"redisæ“ä½œä¸­çš„åŸå­æ€§é—®é¢˜","date":"2017-01-23T09:24:57.000Z","_content":"\næœ¬æ–‡æ¶‰åŠçš„ä»£ç å‡åœ¨redis3.2.6ç‰ˆæœ¬ä¸‹æµ‹è¯•ã€‚\n\né—®é¢˜çš„äº§ç”Ÿæ¥è‡ªäºè¿™æ ·çš„éœ€æ±‚ï¼š\n\n1. è·å¾—ä¸€ä»½æ•°æ®A([time, data])\n2. ä»redis**åˆ—è¡¨**ä¸­è¯»å–æ•°æ®B([time, data])\n3. æ¯”è¾ƒAã€Bä¸¤è€…çš„æ—¶é—´é—´éš”ï¼Œå¦‚æœå¤§äºæŸä¸ªå€¼ï¼Œå°†Aæ’å…¥åœ¨Båï¼Œå¦åˆ™ç”¨Açš„æ•°æ®æ›´æ–°B\n4. è‹¥Aè¢«æ’å…¥ï¼Œåˆ™åˆ¤æ–­åˆ—è¡¨çš„é•¿åº¦ï¼Œå¦‚æœå¤§äº100ï¼Œåˆ™åˆ é™¤æœ€æ—§çš„ä¸€ä¸ªæ•°æ®\n\nredisæ”¯æŒç®€å•äº‹åŠ¡ï¼Œæœ€å¼€å§‹è€ƒè™‘è¿™ä¸ªéœ€æ±‚çš„æ—¶å€™æƒ³çš„ä¹Ÿæ˜¯ç”¨äº‹åŠ¡å®ç°å³å¯ï¼Œä½†ä»”ç»†ç ”ç©¶äº†ä¸€ä¼šredisä¸­çš„äº‹åŠ¡ï¼Œå‘ç°çš„ä»¥ä¸‹é—®é¢˜è®©æˆ‘ä¸å¾—ä¸å¦å¤–å¯»æ‰¾æ›´å¥½çš„è§£å†³æ–¹æ¡ˆã€‚\n\n1. ä¸€æ—¦å¼€å§‹æ‰§è¡Œï¼Œäº‹åŠ¡ä¸­å¦‚æœä¸€ä¸ªå‘½ä»¤å‡ºé”™ï¼Œå…¶å®ƒå‘½ä»¤ä»ç„¶ä¼šæ­£å¸¸æ‰§è¡Œï¼Œä¹Ÿå°±æ˜¯è¯´è¿™ç§æƒ…å†µä¸‹ä¸ä¼šå›æ»šã€‚è¿™æ ·è®¾è®¡çš„åŸå› å’Œåˆ©å¼Šæˆ‘æ— æ³•è¯´æ¸…ï¼Œå¯¹æˆ‘è€Œè¨€æ˜¯æ¯”è¾ƒä¸èƒ½æ¥å—ï¼Œå°½ç®¡ä¸¥è°¨çš„ä»£ç èƒ½å¤Ÿé¿å…å¤§éƒ¨åˆ†é”™è¯¯ï¼Œä½†è°èƒ½ä¿è¯æ°¸è¿œæ­£å¸¸è¿è¡Œå‘¢ï¼Œä¸¾ä¸ªä¾‹å­ï¼šå†…å­˜ä¸å¤Ÿäº†æ€ä¹ˆåŠï¼Ÿ\n2. åœ¨è·å–å’Œæ›´æ–°æ“ä½œä¹‹é—´ï¼Œå¤šä¸ªå®¢æˆ·ç«¯æœ‰å¯èƒ½è·å–åˆ°åŒæ ·çš„å€¼ã€‚redisåªä¿è¯å•ä¸ªäº‹åŠ¡å†…éƒ¨å‘½ä»¤çš„åŸå­æ€§ï¼Œå´ä¸èƒ½ä¿è¯äº‹åŠ¡é—´çš„åŸå­æ€§ã€‚\n\n","source":"_drafts/redisæ“ä½œä¸­çš„åŸå­æ€§é—®é¢˜.md","raw":"---\ntitle: redisæ“ä½œä¸­çš„åŸå­æ€§é—®é¢˜\ndate: 2017-01-23 17:24:57\ntags:\n---\n\næœ¬æ–‡æ¶‰åŠçš„ä»£ç å‡åœ¨redis3.2.6ç‰ˆæœ¬ä¸‹æµ‹è¯•ã€‚\n\né—®é¢˜çš„äº§ç”Ÿæ¥è‡ªäºè¿™æ ·çš„éœ€æ±‚ï¼š\n\n1. è·å¾—ä¸€ä»½æ•°æ®A([time, data])\n2. ä»redis**åˆ—è¡¨**ä¸­è¯»å–æ•°æ®B([time, data])\n3. æ¯”è¾ƒAã€Bä¸¤è€…çš„æ—¶é—´é—´éš”ï¼Œå¦‚æœå¤§äºæŸä¸ªå€¼ï¼Œå°†Aæ’å…¥åœ¨Båï¼Œå¦åˆ™ç”¨Açš„æ•°æ®æ›´æ–°B\n4. è‹¥Aè¢«æ’å…¥ï¼Œåˆ™åˆ¤æ–­åˆ—è¡¨çš„é•¿åº¦ï¼Œå¦‚æœå¤§äº100ï¼Œåˆ™åˆ é™¤æœ€æ—§çš„ä¸€ä¸ªæ•°æ®\n\nredisæ”¯æŒç®€å•äº‹åŠ¡ï¼Œæœ€å¼€å§‹è€ƒè™‘è¿™ä¸ªéœ€æ±‚çš„æ—¶å€™æƒ³çš„ä¹Ÿæ˜¯ç”¨äº‹åŠ¡å®ç°å³å¯ï¼Œä½†ä»”ç»†ç ”ç©¶äº†ä¸€ä¼šredisä¸­çš„äº‹åŠ¡ï¼Œå‘ç°çš„ä»¥ä¸‹é—®é¢˜è®©æˆ‘ä¸å¾—ä¸å¦å¤–å¯»æ‰¾æ›´å¥½çš„è§£å†³æ–¹æ¡ˆã€‚\n\n1. ä¸€æ—¦å¼€å§‹æ‰§è¡Œï¼Œäº‹åŠ¡ä¸­å¦‚æœä¸€ä¸ªå‘½ä»¤å‡ºé”™ï¼Œå…¶å®ƒå‘½ä»¤ä»ç„¶ä¼šæ­£å¸¸æ‰§è¡Œï¼Œä¹Ÿå°±æ˜¯è¯´è¿™ç§æƒ…å†µä¸‹ä¸ä¼šå›æ»šã€‚è¿™æ ·è®¾è®¡çš„åŸå› å’Œåˆ©å¼Šæˆ‘æ— æ³•è¯´æ¸…ï¼Œå¯¹æˆ‘è€Œè¨€æ˜¯æ¯”è¾ƒä¸èƒ½æ¥å—ï¼Œå°½ç®¡ä¸¥è°¨çš„ä»£ç èƒ½å¤Ÿé¿å…å¤§éƒ¨åˆ†é”™è¯¯ï¼Œä½†è°èƒ½ä¿è¯æ°¸è¿œæ­£å¸¸è¿è¡Œå‘¢ï¼Œä¸¾ä¸ªä¾‹å­ï¼šå†…å­˜ä¸å¤Ÿäº†æ€ä¹ˆåŠï¼Ÿ\n2. åœ¨è·å–å’Œæ›´æ–°æ“ä½œä¹‹é—´ï¼Œå¤šä¸ªå®¢æˆ·ç«¯æœ‰å¯èƒ½è·å–åˆ°åŒæ ·çš„å€¼ã€‚redisåªä¿è¯å•ä¸ªäº‹åŠ¡å†…éƒ¨å‘½ä»¤çš„åŸå­æ€§ï¼Œå´ä¸èƒ½ä¿è¯äº‹åŠ¡é—´çš„åŸå­æ€§ã€‚\n\n","slug":"redisæ“ä½œä¸­çš„åŸå­æ€§é—®é¢˜","published":0,"updated":"2017-01-24T11:10:47.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ciying3460000w13jg7i41hyi","content":"<p>æœ¬æ–‡æ¶‰åŠçš„ä»£ç å‡åœ¨redis3.2.6ç‰ˆæœ¬ä¸‹æµ‹è¯•ã€‚</p>\n<p>é—®é¢˜çš„äº§ç”Ÿæ¥è‡ªäºè¿™æ ·çš„éœ€æ±‚ï¼š</p>\n<ol>\n<li>è·å¾—ä¸€ä»½æ•°æ®A([time, data])</li>\n<li>ä»redis<strong>åˆ—è¡¨</strong>ä¸­è¯»å–æ•°æ®B([time, data])</li>\n<li>æ¯”è¾ƒAã€Bä¸¤è€…çš„æ—¶é—´é—´éš”ï¼Œå¦‚æœå¤§äºæŸä¸ªå€¼ï¼Œå°†Aæ’å…¥åœ¨Båï¼Œå¦åˆ™ç”¨Açš„æ•°æ®æ›´æ–°B</li>\n<li>è‹¥Aè¢«æ’å…¥ï¼Œåˆ™åˆ¤æ–­åˆ—è¡¨çš„é•¿åº¦ï¼Œå¦‚æœå¤§äº100ï¼Œåˆ™åˆ é™¤æœ€æ—§çš„ä¸€ä¸ªæ•°æ®</li>\n</ol>\n<p>redisæ”¯æŒç®€å•äº‹åŠ¡ï¼Œæœ€å¼€å§‹è€ƒè™‘è¿™ä¸ªéœ€æ±‚çš„æ—¶å€™æƒ³çš„ä¹Ÿæ˜¯ç”¨äº‹åŠ¡å®ç°å³å¯ï¼Œä½†ä»”ç»†ç ”ç©¶äº†ä¸€ä¼šredisä¸­çš„äº‹åŠ¡ï¼Œå‘ç°çš„ä»¥ä¸‹é—®é¢˜è®©æˆ‘ä¸å¾—ä¸å¦å¤–å¯»æ‰¾æ›´å¥½çš„è§£å†³æ–¹æ¡ˆã€‚</p>\n<ol>\n<li>ä¸€æ—¦å¼€å§‹æ‰§è¡Œï¼Œäº‹åŠ¡ä¸­å¦‚æœä¸€ä¸ªå‘½ä»¤å‡ºé”™ï¼Œå…¶å®ƒå‘½ä»¤ä»ç„¶ä¼šæ­£å¸¸æ‰§è¡Œï¼Œä¹Ÿå°±æ˜¯è¯´è¿™ç§æƒ…å†µä¸‹ä¸ä¼šå›æ»šã€‚è¿™æ ·è®¾è®¡çš„åŸå› å’Œåˆ©å¼Šæˆ‘æ— æ³•è¯´æ¸…ï¼Œå¯¹æˆ‘è€Œè¨€æ˜¯æ¯”è¾ƒä¸èƒ½æ¥å—ï¼Œå°½ç®¡ä¸¥è°¨çš„ä»£ç èƒ½å¤Ÿé¿å…å¤§éƒ¨åˆ†é”™è¯¯ï¼Œä½†è°èƒ½ä¿è¯æ°¸è¿œæ­£å¸¸è¿è¡Œå‘¢ï¼Œä¸¾ä¸ªä¾‹å­ï¼šå†…å­˜ä¸å¤Ÿäº†æ€ä¹ˆåŠï¼Ÿ</li>\n<li>åœ¨è·å–å’Œæ›´æ–°æ“ä½œä¹‹é—´ï¼Œå¤šä¸ªå®¢æˆ·ç«¯æœ‰å¯èƒ½è·å–åˆ°åŒæ ·çš„å€¼ã€‚redisåªä¿è¯å•ä¸ªäº‹åŠ¡å†…éƒ¨å‘½ä»¤çš„åŸå­æ€§ï¼Œå´ä¸èƒ½ä¿è¯äº‹åŠ¡é—´çš„åŸå­æ€§ã€‚</li>\n</ol>\n","excerpt":"","more":"<p>æœ¬æ–‡æ¶‰åŠçš„ä»£ç å‡åœ¨redis3.2.6ç‰ˆæœ¬ä¸‹æµ‹è¯•ã€‚</p>\n<p>é—®é¢˜çš„äº§ç”Ÿæ¥è‡ªäºè¿™æ ·çš„éœ€æ±‚ï¼š</p>\n<ol>\n<li>è·å¾—ä¸€ä»½æ•°æ®A([time, data])</li>\n<li>ä»redis<strong>åˆ—è¡¨</strong>ä¸­è¯»å–æ•°æ®B([time, data])</li>\n<li>æ¯”è¾ƒAã€Bä¸¤è€…çš„æ—¶é—´é—´éš”ï¼Œå¦‚æœå¤§äºæŸä¸ªå€¼ï¼Œå°†Aæ’å…¥åœ¨Båï¼Œå¦åˆ™ç”¨Açš„æ•°æ®æ›´æ–°B</li>\n<li>è‹¥Aè¢«æ’å…¥ï¼Œåˆ™åˆ¤æ–­åˆ—è¡¨çš„é•¿åº¦ï¼Œå¦‚æœå¤§äº100ï¼Œåˆ™åˆ é™¤æœ€æ—§çš„ä¸€ä¸ªæ•°æ®</li>\n</ol>\n<p>redisæ”¯æŒç®€å•äº‹åŠ¡ï¼Œæœ€å¼€å§‹è€ƒè™‘è¿™ä¸ªéœ€æ±‚çš„æ—¶å€™æƒ³çš„ä¹Ÿæ˜¯ç”¨äº‹åŠ¡å®ç°å³å¯ï¼Œä½†ä»”ç»†ç ”ç©¶äº†ä¸€ä¼šredisä¸­çš„äº‹åŠ¡ï¼Œå‘ç°çš„ä»¥ä¸‹é—®é¢˜è®©æˆ‘ä¸å¾—ä¸å¦å¤–å¯»æ‰¾æ›´å¥½çš„è§£å†³æ–¹æ¡ˆã€‚</p>\n<ol>\n<li>ä¸€æ—¦å¼€å§‹æ‰§è¡Œï¼Œäº‹åŠ¡ä¸­å¦‚æœä¸€ä¸ªå‘½ä»¤å‡ºé”™ï¼Œå…¶å®ƒå‘½ä»¤ä»ç„¶ä¼šæ­£å¸¸æ‰§è¡Œï¼Œä¹Ÿå°±æ˜¯è¯´è¿™ç§æƒ…å†µä¸‹ä¸ä¼šå›æ»šã€‚è¿™æ ·è®¾è®¡çš„åŸå› å’Œåˆ©å¼Šæˆ‘æ— æ³•è¯´æ¸…ï¼Œå¯¹æˆ‘è€Œè¨€æ˜¯æ¯”è¾ƒä¸èƒ½æ¥å—ï¼Œå°½ç®¡ä¸¥è°¨çš„ä»£ç èƒ½å¤Ÿé¿å…å¤§éƒ¨åˆ†é”™è¯¯ï¼Œä½†è°èƒ½ä¿è¯æ°¸è¿œæ­£å¸¸è¿è¡Œå‘¢ï¼Œä¸¾ä¸ªä¾‹å­ï¼šå†…å­˜ä¸å¤Ÿäº†æ€ä¹ˆåŠï¼Ÿ</li>\n<li>åœ¨è·å–å’Œæ›´æ–°æ“ä½œä¹‹é—´ï¼Œå¤šä¸ªå®¢æˆ·ç«¯æœ‰å¯èƒ½è·å–åˆ°åŒæ ·çš„å€¼ã€‚redisåªä¿è¯å•ä¸ªäº‹åŠ¡å†…éƒ¨å‘½ä»¤çš„åŸå­æ€§ï¼Œå´ä¸èƒ½ä¿è¯äº‹åŠ¡é—´çš„åŸå­æ€§ã€‚</li>\n</ol>\n"},{"title":"ä¸“æ³¨ä¸€ç‚¹","_content":"\n2016å¹´1æœˆ23æ—¥ï¼Œæ­£å¼ä»ç§‘ä¹ç¦»èŒï¼Œå¾ˆè‰°éš¾çš„åšå‡ºè¿™ä¸ªå†³å®šã€‚\n\n","source":"_drafts/ä¸“æ³¨ä¸€ç‚¹.md","raw":"---\ntitle: ä¸“æ³¨ä¸€ç‚¹\ntags:\n---\n\n2016å¹´1æœˆ23æ—¥ï¼Œæ­£å¼ä»ç§‘ä¹ç¦»èŒï¼Œå¾ˆè‰°éš¾çš„åšå‡ºè¿™ä¸ªå†³å®šã€‚\n\n","slug":"ä¸“æ³¨ä¸€ç‚¹","published":0,"date":"2017-01-24T11:11:27.000Z","updated":"2017-01-26T02:59:08.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ciying34a0001w13jf40g6h73","content":"<p>2016å¹´1æœˆ23æ—¥ï¼Œæ­£å¼ä»ç§‘ä¹ç¦»èŒï¼Œå¾ˆè‰°éš¾çš„åšå‡ºè¿™ä¸ªå†³å®šã€‚</p>\n","excerpt":"","more":"<p>2016å¹´1æœˆ23æ—¥ï¼Œæ­£å¼ä»ç§‘ä¹ç¦»èŒï¼Œå¾ˆè‰°éš¾çš„åšå‡ºè¿™ä¸ªå†³å®šã€‚</p>\n"},{"title":"é¢è¯•ä¸­çš„é—®é¢˜","date":"2017-01-29T12:31:42.000Z","_content":"\n\nå¹´å‰å‘äº†ä¸ªæ±‚èŒè´´ï¼Œä¸€å‘¨ä»¥æ¥é™†ç»­æœ‰å¾ˆå¤šå…¬å¸å¯¹æˆ‘è¡¨ç¤ºæ„Ÿå…´è¶£ï¼Œé¢è¯•å’Œç¬”è¯•ä¹Ÿä¸å°‘ï¼Œå…¶ä¸­æœ‰é“ç¬”è¯•é¢˜å¤§æ¦‚æ˜¯è¿™æ ·çš„ã€‚\n\n```\næŠŠä»¥ä¸‹æ•°æ®ç»„æˆä¸ªæ ‘æ‰“å°å‡ºæ¥ï¼Œåƒnpm listå‘½ä»¤ä¸€æ ·ã€‚\nlet testData = [\n    {id:1, name: 'i1'}, \n    {id:2, name:'i2', parentId: 1},\n    {id:4, name:'i4', parentId: 3},\n    {id:3, name:'i3', parentId: 2},\n    {id:8, name:'i8', parentId: 7}\n]\n```\n\nç¬”è¯•è¿‡ç¨‹ä¸ç´¯è¿°ï¼Œæ˜¯ä¸€å®¶æ¯”è¾ƒå–œæ¬¢çš„å…¬å¸ï¼Œè€Œå½“æ—¶æ¯”è¾ƒç´§å¼ ï¼Œæ—¶é—´ç´§è¿«ï¼Œåªå‘é¢è¯•å®˜é˜è¿°äº†æ€è·¯ï¼Œå‹‰å¼ºè¿‡å…³ï¼Œå´æ²¡æœ‰å†™å‡ºè‡ªå·±æ»¡æ„çš„ç­”æ¡ˆã€‚äº‹åæƒ³æƒ³å…¶å®è¿™é¢˜å¹¶ä¸éš¾ï¼Œè¿™é‡Œåšä¸ªç®€å•æ€»ç»“ï¼Œç­”æ¡ˆå¹¶ä¸ä¸€å®šæ˜¯æœ€å¥½çš„ã€‚\n\nä¸€çœ¼æ³¨æ„åˆ°i8æ˜¯ä¸ªæ¸¸ç¦»åœ¨å¤–çš„å¶å­ï¼Œæ‰€ä»¥è¿˜è¦å¤„ç†ä¸åœ¨æ ‘å†…çš„æƒ…å†µï¼Œè¿™é‡Œåé¢å†è¯´åˆ°ã€‚è¿™é¢˜æœ€å¤§çš„é—®é¢˜æ˜¯i4è¿™ä¸ªå¶å­çš„çˆ¶çº§æ˜¯i3ï¼Œè‹¥æŒ‰é¡ºåºéå†çš„è¯i3è¿˜åœ¨i4ä¹‹åéå†åˆ°ï¼Œå°±æ— æ³•å°†i4æŒ‚åœ¨i3ä¸‹ã€‚å’Œé¢è¯•å®˜äº¤æµäº†ä¸‹ï¼Œç»™æˆ‘çš„æç¤ºæ˜¯ç”¨ä¸ªå…¨å±€ç¼“å­˜å°±å¥½äº†ï¼Œå½“æ—¶ä¹Ÿç¡®å®æ˜¯è¿™ä¹ˆåšçš„ï¼Œä½†æ€»è§‰å¾—åº”è¯¥æœ‰æ›´ä¼˜é›…çš„å¤„ç†åŠæ³•ã€‚\n\nå¯¹äºä¸Šè¿°é—®é¢˜æˆ‘ç°åœ¨çš„æ€è·¯æ˜¯ç”¨é€’å½’å³å¯ï¼Œå¯¹äºæ— æ³•æ‰¾åˆ°çˆ¶çº§çš„å¶å­å…ƒç´ ï¼Œæ”¾åˆ°éå†å¯¹è±¡çš„å°¾éƒ¨å†å¤„ç†ï¼Œå°±ä¸éœ€è¦å…¨å±€ç¼“å­˜äº†ã€‚\n\nä¸‹é¢è¯´è¯´å®ç°ã€‚\n\né¦–å…ˆæœ€ç»ˆå¾—åˆ°çš„æ ‘çš„ç»“æ„æˆ‘å®šä¹‰å¦‚ä¸‹ã€‚\n\n```javascript\n{\n  id: xxx,\n  name: xxx,\n  child: {...}\n}\n```\n\nç”±äºæ­¤é¢˜ä¸€çœ¼çœ‹å»åªæ˜¯ä¸ªå•é¡µæ ‘ï¼Œå°±å…¨å½“å•é¡µæ ‘å¤„ç†ï¼Œæš‚ä¸è€ƒè™‘å¤šå‰æ ‘çš„æƒ…å†µã€‚\n\nå…ˆå®ç°ä¸»å‡½æ•°ã€‚\n\n```javascript\nfunction main(parent, arr) {\n\tlet child = arr.shift();\n\t\n\tif(!child) return parent;\n\n\tif(!child.parentId) { // no parent, set as root.\n\t\tif(!parent.id) { // only one root.\n\t\t\tparent = child;\n\t\t}\n\t} else { // got a child.\n\t\tlet ok = setChild(parent, child);\n\t\tif(!ok) { // parent not found.\n\t\t\tif(!ok) {\n\t\t\t\tarr.push(child);\n\t\t\t}\n\t\t}\n\t}\n\n\treturn main(parent, arr);\n}\n```\n\nä¸»å‡½æ•°åŸºæœ¬å®ç°äº†æˆ‘è¯´çš„æ€è·¯ï¼Œé¦–å…ˆå°†æ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´ æå–å‡ºæ¥ï¼Œç„¶åå®šä¹‰ç»ˆæ­¢æ¡ä»¶ï¼ˆå³ï¼šæå–å…ƒç´ å¤±è´¥ï¼‰ï¼Œæ¥ç€æ ¹æ®æå–å‡ºçš„å…ƒç´ è®¾å®šä¸ºæ ¹å…ƒç´ ï¼ˆæ²¡æœ‰æ‰¾åˆ°parentIdï¼‰æˆ–è®¾å®šä¸ºå¶å­ï¼ˆæ‰¾åˆ°parentIdï¼‰ï¼Œç„¶åé€’å½’è°ƒç”¨è‡ªèº«ã€‚\n\nå…¶ä¸­setChildå‡½æ•°çš„å®ç°å¦‚ä¸‹ã€‚\n\n```Javascript\nfunction setChild(parent, child) {\n\tlet finded = false; // flag.\n\tif(parent.id === child.parentId) {\n\t\tparent.child = child;\n\t\tfinded = true;\n\t} else if(parent.child) {\n\t\tfinded = setChild(parent.child, child);\n\t}\n\treturn finded;\n}\n```\n\nsetChildåŒæ ·ä¹Ÿæ˜¯ç”¨é€’å½’å®ç°ï¼Œè¿”å›trueæˆ–falseè¡¨ç¤ºå­å…ƒç´ è®¾ç½®æˆåŠŸæˆ–å¤±è´¥ã€‚\n\nä¸è¿‡ç°åœ¨å°è¯•è¿è¡Œ`main({}, testData)`ä¼šé€ æˆå†…å­˜æº¢å‡ºï¼Œå› ä¸ºi8å§‹ç»ˆæ‰¾ä¸åˆ°çˆ¶çº§ï¼Œä½¿å¾—é€’å½’æ°¸è¿œæ— æ³•ç»ˆæ­¢ã€‚æ‰€ä»¥æˆ‘ä»¬å¾—æ”¹é€ ä¸‹mainå‡½æ•°ï¼Œæ·»åŠ åˆé€‚çš„é”™è¯¯å¤„ç†ã€‚æ”¹é€ å¦‚ä¸‹ã€‚\n\n```javascript\nfunction main(parent, arr, depth) {\n\tlet child = arr.shift();\n\tdepth = depth || 0;\n\n\tif(!child) return parent;\n\n\tif(!child.parentId) { // no parent, set as root.\n\t\tif(!parent.id) { // only one root.\n\t\t\tparent = child;\n\t\t}\n\t} else { // got a child.\n\t\tlet ok = setChild(parent, child);\n\t\tif(!ok) { // parent not found.\n\t\t\tif(depth < 10) {\n\t\t\t\tarr.push(child);\n\t\t\t\tdepth++;\n\t\t\t} else { // ending\n\t\t\t\tconsole.log('These children have no parents: ', arr.concat(child))\n\t\t\t}\n\t\t}\n\t}\n\n\treturn main(parent, arr, ++depth);\n}\n```\n\næ›´æ–°åçš„mainå‡½æ•°åŠ ä¸Šäº†ç¬¬ä¸‰ä¸ªå‚æ•°depthï¼Œå¯é€‰ï¼Œä¸”åˆå§‹ä¸º0ï¼Œæ¯æ¬¡é€’å½’è‡ªå¢1ï¼Œ10æ¬¡é€’å½’åç»ˆæ­¢ï¼Œå¹¶æ‰“å°ä»æœªæ‰¾åˆ°çˆ¶çº§çš„å…ƒç´ ã€‚å®Œæˆåçš„ä»£ç è¿è¡Œ`console.log(main({}, data))`ï¼Œç»“æœå¦‚ä¸‹ã€‚\n\n```Javascript\nThese children have no parents:  [ { id: 8, name: 'i8', parentId: 7 } ]\n{ id: 1,\n  name: 'i1',\n  child: \n   { id: 2,\n     name: 'i2',\n     parentId: 1,\n     child: { id: 3, name: 'i3', parentId: 2, child: [Object] } } }\n```\n\nçœ‹æ ·å­æ ‘å·²ç»ç”Ÿæˆäº†ã€‚æœ€ååŠ ä¸Šä¸ªprintTreeå‡½æ•°ï¼Œæ ¼å¼åŒ–è¾“å‡ºã€‚\n\n```Javascript\nfunction printTree(tree, depth) {\n\tdepth = depth || 0;\n\tlet i = depth,\n\t\tstr = '';\n\twhile(i--) {\n\t\tstr += '--'\n\t}\n\tconsole.log(str + 'name: ' + tree.name);\n\tif(tree.child) {\n\t\tprintTree(tree.child, ++depth);\n\t}\n}\n```\n\nç„¶åè¿è¡Œã€‚\n\n```javascript\nlet tree = main({}, data);\nprintTree(tree);\n```\n\nè¾“å‡ºã€‚\n\n```javascript\nThese children have no parents:  [ { id: 8, name: 'i8', parentId: 7 } ]\nname: i1\n--name: i2\n----name: i3\n------name: i4\n```\n\nè‡³æ­¤ï¼Œç”¨äº†ä¸‰ä¸ªé€’å½’å‡½æ•°ï¼Œå°½ç®¡å®ç°ä¸Šè¿˜æœ‰ä¸€äº›é—®é¢˜ï¼ˆé€’å½’æ·±åº¦æ§åˆ¶ï¼Œå¤šå‰æ ‘å…¼å®¹ç­‰ï¼‰ï¼Œæ­¤é¢˜ç®—æ˜¯è§£å‡ºæ¥äº†ã€‚","source":"_posts/é¢è¯•ä¸­çš„é—®é¢˜.md","raw":"---\ntitle: é¢è¯•ä¸­çš„é—®é¢˜\ndate: 2017-01-29 20:31:42\ntags:\n---\n\n\nå¹´å‰å‘äº†ä¸ªæ±‚èŒè´´ï¼Œä¸€å‘¨ä»¥æ¥é™†ç»­æœ‰å¾ˆå¤šå…¬å¸å¯¹æˆ‘è¡¨ç¤ºæ„Ÿå…´è¶£ï¼Œé¢è¯•å’Œç¬”è¯•ä¹Ÿä¸å°‘ï¼Œå…¶ä¸­æœ‰é“ç¬”è¯•é¢˜å¤§æ¦‚æ˜¯è¿™æ ·çš„ã€‚\n\n```\næŠŠä»¥ä¸‹æ•°æ®ç»„æˆä¸ªæ ‘æ‰“å°å‡ºæ¥ï¼Œåƒnpm listå‘½ä»¤ä¸€æ ·ã€‚\nlet testData = [\n    {id:1, name: 'i1'}, \n    {id:2, name:'i2', parentId: 1},\n    {id:4, name:'i4', parentId: 3},\n    {id:3, name:'i3', parentId: 2},\n    {id:8, name:'i8', parentId: 7}\n]\n```\n\nç¬”è¯•è¿‡ç¨‹ä¸ç´¯è¿°ï¼Œæ˜¯ä¸€å®¶æ¯”è¾ƒå–œæ¬¢çš„å…¬å¸ï¼Œè€Œå½“æ—¶æ¯”è¾ƒç´§å¼ ï¼Œæ—¶é—´ç´§è¿«ï¼Œåªå‘é¢è¯•å®˜é˜è¿°äº†æ€è·¯ï¼Œå‹‰å¼ºè¿‡å…³ï¼Œå´æ²¡æœ‰å†™å‡ºè‡ªå·±æ»¡æ„çš„ç­”æ¡ˆã€‚äº‹åæƒ³æƒ³å…¶å®è¿™é¢˜å¹¶ä¸éš¾ï¼Œè¿™é‡Œåšä¸ªç®€å•æ€»ç»“ï¼Œç­”æ¡ˆå¹¶ä¸ä¸€å®šæ˜¯æœ€å¥½çš„ã€‚\n\nä¸€çœ¼æ³¨æ„åˆ°i8æ˜¯ä¸ªæ¸¸ç¦»åœ¨å¤–çš„å¶å­ï¼Œæ‰€ä»¥è¿˜è¦å¤„ç†ä¸åœ¨æ ‘å†…çš„æƒ…å†µï¼Œè¿™é‡Œåé¢å†è¯´åˆ°ã€‚è¿™é¢˜æœ€å¤§çš„é—®é¢˜æ˜¯i4è¿™ä¸ªå¶å­çš„çˆ¶çº§æ˜¯i3ï¼Œè‹¥æŒ‰é¡ºåºéå†çš„è¯i3è¿˜åœ¨i4ä¹‹åéå†åˆ°ï¼Œå°±æ— æ³•å°†i4æŒ‚åœ¨i3ä¸‹ã€‚å’Œé¢è¯•å®˜äº¤æµäº†ä¸‹ï¼Œç»™æˆ‘çš„æç¤ºæ˜¯ç”¨ä¸ªå…¨å±€ç¼“å­˜å°±å¥½äº†ï¼Œå½“æ—¶ä¹Ÿç¡®å®æ˜¯è¿™ä¹ˆåšçš„ï¼Œä½†æ€»è§‰å¾—åº”è¯¥æœ‰æ›´ä¼˜é›…çš„å¤„ç†åŠæ³•ã€‚\n\nå¯¹äºä¸Šè¿°é—®é¢˜æˆ‘ç°åœ¨çš„æ€è·¯æ˜¯ç”¨é€’å½’å³å¯ï¼Œå¯¹äºæ— æ³•æ‰¾åˆ°çˆ¶çº§çš„å¶å­å…ƒç´ ï¼Œæ”¾åˆ°éå†å¯¹è±¡çš„å°¾éƒ¨å†å¤„ç†ï¼Œå°±ä¸éœ€è¦å…¨å±€ç¼“å­˜äº†ã€‚\n\nä¸‹é¢è¯´è¯´å®ç°ã€‚\n\né¦–å…ˆæœ€ç»ˆå¾—åˆ°çš„æ ‘çš„ç»“æ„æˆ‘å®šä¹‰å¦‚ä¸‹ã€‚\n\n```javascript\n{\n  id: xxx,\n  name: xxx,\n  child: {...}\n}\n```\n\nç”±äºæ­¤é¢˜ä¸€çœ¼çœ‹å»åªæ˜¯ä¸ªå•é¡µæ ‘ï¼Œå°±å…¨å½“å•é¡µæ ‘å¤„ç†ï¼Œæš‚ä¸è€ƒè™‘å¤šå‰æ ‘çš„æƒ…å†µã€‚\n\nå…ˆå®ç°ä¸»å‡½æ•°ã€‚\n\n```javascript\nfunction main(parent, arr) {\n\tlet child = arr.shift();\n\t\n\tif(!child) return parent;\n\n\tif(!child.parentId) { // no parent, set as root.\n\t\tif(!parent.id) { // only one root.\n\t\t\tparent = child;\n\t\t}\n\t} else { // got a child.\n\t\tlet ok = setChild(parent, child);\n\t\tif(!ok) { // parent not found.\n\t\t\tif(!ok) {\n\t\t\t\tarr.push(child);\n\t\t\t}\n\t\t}\n\t}\n\n\treturn main(parent, arr);\n}\n```\n\nä¸»å‡½æ•°åŸºæœ¬å®ç°äº†æˆ‘è¯´çš„æ€è·¯ï¼Œé¦–å…ˆå°†æ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´ æå–å‡ºæ¥ï¼Œç„¶åå®šä¹‰ç»ˆæ­¢æ¡ä»¶ï¼ˆå³ï¼šæå–å…ƒç´ å¤±è´¥ï¼‰ï¼Œæ¥ç€æ ¹æ®æå–å‡ºçš„å…ƒç´ è®¾å®šä¸ºæ ¹å…ƒç´ ï¼ˆæ²¡æœ‰æ‰¾åˆ°parentIdï¼‰æˆ–è®¾å®šä¸ºå¶å­ï¼ˆæ‰¾åˆ°parentIdï¼‰ï¼Œç„¶åé€’å½’è°ƒç”¨è‡ªèº«ã€‚\n\nå…¶ä¸­setChildå‡½æ•°çš„å®ç°å¦‚ä¸‹ã€‚\n\n```Javascript\nfunction setChild(parent, child) {\n\tlet finded = false; // flag.\n\tif(parent.id === child.parentId) {\n\t\tparent.child = child;\n\t\tfinded = true;\n\t} else if(parent.child) {\n\t\tfinded = setChild(parent.child, child);\n\t}\n\treturn finded;\n}\n```\n\nsetChildåŒæ ·ä¹Ÿæ˜¯ç”¨é€’å½’å®ç°ï¼Œè¿”å›trueæˆ–falseè¡¨ç¤ºå­å…ƒç´ è®¾ç½®æˆåŠŸæˆ–å¤±è´¥ã€‚\n\nä¸è¿‡ç°åœ¨å°è¯•è¿è¡Œ`main({}, testData)`ä¼šé€ æˆå†…å­˜æº¢å‡ºï¼Œå› ä¸ºi8å§‹ç»ˆæ‰¾ä¸åˆ°çˆ¶çº§ï¼Œä½¿å¾—é€’å½’æ°¸è¿œæ— æ³•ç»ˆæ­¢ã€‚æ‰€ä»¥æˆ‘ä»¬å¾—æ”¹é€ ä¸‹mainå‡½æ•°ï¼Œæ·»åŠ åˆé€‚çš„é”™è¯¯å¤„ç†ã€‚æ”¹é€ å¦‚ä¸‹ã€‚\n\n```javascript\nfunction main(parent, arr, depth) {\n\tlet child = arr.shift();\n\tdepth = depth || 0;\n\n\tif(!child) return parent;\n\n\tif(!child.parentId) { // no parent, set as root.\n\t\tif(!parent.id) { // only one root.\n\t\t\tparent = child;\n\t\t}\n\t} else { // got a child.\n\t\tlet ok = setChild(parent, child);\n\t\tif(!ok) { // parent not found.\n\t\t\tif(depth < 10) {\n\t\t\t\tarr.push(child);\n\t\t\t\tdepth++;\n\t\t\t} else { // ending\n\t\t\t\tconsole.log('These children have no parents: ', arr.concat(child))\n\t\t\t}\n\t\t}\n\t}\n\n\treturn main(parent, arr, ++depth);\n}\n```\n\næ›´æ–°åçš„mainå‡½æ•°åŠ ä¸Šäº†ç¬¬ä¸‰ä¸ªå‚æ•°depthï¼Œå¯é€‰ï¼Œä¸”åˆå§‹ä¸º0ï¼Œæ¯æ¬¡é€’å½’è‡ªå¢1ï¼Œ10æ¬¡é€’å½’åç»ˆæ­¢ï¼Œå¹¶æ‰“å°ä»æœªæ‰¾åˆ°çˆ¶çº§çš„å…ƒç´ ã€‚å®Œæˆåçš„ä»£ç è¿è¡Œ`console.log(main({}, data))`ï¼Œç»“æœå¦‚ä¸‹ã€‚\n\n```Javascript\nThese children have no parents:  [ { id: 8, name: 'i8', parentId: 7 } ]\n{ id: 1,\n  name: 'i1',\n  child: \n   { id: 2,\n     name: 'i2',\n     parentId: 1,\n     child: { id: 3, name: 'i3', parentId: 2, child: [Object] } } }\n```\n\nçœ‹æ ·å­æ ‘å·²ç»ç”Ÿæˆäº†ã€‚æœ€ååŠ ä¸Šä¸ªprintTreeå‡½æ•°ï¼Œæ ¼å¼åŒ–è¾“å‡ºã€‚\n\n```Javascript\nfunction printTree(tree, depth) {\n\tdepth = depth || 0;\n\tlet i = depth,\n\t\tstr = '';\n\twhile(i--) {\n\t\tstr += '--'\n\t}\n\tconsole.log(str + 'name: ' + tree.name);\n\tif(tree.child) {\n\t\tprintTree(tree.child, ++depth);\n\t}\n}\n```\n\nç„¶åè¿è¡Œã€‚\n\n```javascript\nlet tree = main({}, data);\nprintTree(tree);\n```\n\nè¾“å‡ºã€‚\n\n```javascript\nThese children have no parents:  [ { id: 8, name: 'i8', parentId: 7 } ]\nname: i1\n--name: i2\n----name: i3\n------name: i4\n```\n\nè‡³æ­¤ï¼Œç”¨äº†ä¸‰ä¸ªé€’å½’å‡½æ•°ï¼Œå°½ç®¡å®ç°ä¸Šè¿˜æœ‰ä¸€äº›é—®é¢˜ï¼ˆé€’å½’æ·±åº¦æ§åˆ¶ï¼Œå¤šå‰æ ‘å…¼å®¹ç­‰ï¼‰ï¼Œæ­¤é¢˜ç®—æ˜¯è§£å‡ºæ¥äº†ã€‚","slug":"é¢è¯•ä¸­çš„é—®é¢˜","published":1,"updated":"2017-01-29T12:31:42.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ciying34o0002w13jq24fxii9","content":"<p>å¹´å‰å‘äº†ä¸ªæ±‚èŒè´´ï¼Œä¸€å‘¨ä»¥æ¥é™†ç»­æœ‰å¾ˆå¤šå…¬å¸å¯¹æˆ‘è¡¨ç¤ºæ„Ÿå…´è¶£ï¼Œé¢è¯•å’Œç¬”è¯•ä¹Ÿä¸å°‘ï¼Œå…¶ä¸­æœ‰é“ç¬”è¯•é¢˜å¤§æ¦‚æ˜¯è¿™æ ·çš„ã€‚</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\">æŠŠä»¥ä¸‹æ•°æ®ç»„æˆä¸ªæ ‘æ‰“å°å‡ºæ¥ï¼Œåƒnpm listå‘½ä»¤ä¸€æ ·ã€‚</div><div class=\"line\">let testData = [</div><div class=\"line\">    &#123;id:1, name: &apos;i1&apos;&#125;, </div><div class=\"line\">    &#123;id:2, name:&apos;i2&apos;, parentId: 1&#125;,</div><div class=\"line\">    &#123;id:4, name:&apos;i4&apos;, parentId: 3&#125;,</div><div class=\"line\">    &#123;id:3, name:&apos;i3&apos;, parentId: 2&#125;,</div><div class=\"line\">    &#123;id:8, name:&apos;i8&apos;, parentId: 7&#125;</div><div class=\"line\">]</div></pre></td></tr></table></figure>\n<p>ç¬”è¯•è¿‡ç¨‹ä¸ç´¯è¿°ï¼Œæ˜¯ä¸€å®¶æ¯”è¾ƒå–œæ¬¢çš„å…¬å¸ï¼Œè€Œå½“æ—¶æ¯”è¾ƒç´§å¼ ï¼Œæ—¶é—´ç´§è¿«ï¼Œåªå‘é¢è¯•å®˜é˜è¿°äº†æ€è·¯ï¼Œå‹‰å¼ºè¿‡å…³ï¼Œå´æ²¡æœ‰å†™å‡ºè‡ªå·±æ»¡æ„çš„ç­”æ¡ˆã€‚äº‹åæƒ³æƒ³å…¶å®è¿™é¢˜å¹¶ä¸éš¾ï¼Œè¿™é‡Œåšä¸ªç®€å•æ€»ç»“ï¼Œç­”æ¡ˆå¹¶ä¸ä¸€å®šæ˜¯æœ€å¥½çš„ã€‚</p>\n<p>ä¸€çœ¼æ³¨æ„åˆ°i8æ˜¯ä¸ªæ¸¸ç¦»åœ¨å¤–çš„å¶å­ï¼Œæ‰€ä»¥è¿˜è¦å¤„ç†ä¸åœ¨æ ‘å†…çš„æƒ…å†µï¼Œè¿™é‡Œåé¢å†è¯´åˆ°ã€‚è¿™é¢˜æœ€å¤§çš„é—®é¢˜æ˜¯i4è¿™ä¸ªå¶å­çš„çˆ¶çº§æ˜¯i3ï¼Œè‹¥æŒ‰é¡ºåºéå†çš„è¯i3è¿˜åœ¨i4ä¹‹åéå†åˆ°ï¼Œå°±æ— æ³•å°†i4æŒ‚åœ¨i3ä¸‹ã€‚å’Œé¢è¯•å®˜äº¤æµäº†ä¸‹ï¼Œç»™æˆ‘çš„æç¤ºæ˜¯ç”¨ä¸ªå…¨å±€ç¼“å­˜å°±å¥½äº†ï¼Œå½“æ—¶ä¹Ÿç¡®å®æ˜¯è¿™ä¹ˆåšçš„ï¼Œä½†æ€»è§‰å¾—åº”è¯¥æœ‰æ›´ä¼˜é›…çš„å¤„ç†åŠæ³•ã€‚</p>\n<p>å¯¹äºä¸Šè¿°é—®é¢˜æˆ‘ç°åœ¨çš„æ€è·¯æ˜¯ç”¨é€’å½’å³å¯ï¼Œå¯¹äºæ— æ³•æ‰¾åˆ°çˆ¶çº§çš„å¶å­å…ƒç´ ï¼Œæ”¾åˆ°éå†å¯¹è±¡çš„å°¾éƒ¨å†å¤„ç†ï¼Œå°±ä¸éœ€è¦å…¨å±€ç¼“å­˜äº†ã€‚</p>\n<p>ä¸‹é¢è¯´è¯´å®ç°ã€‚</p>\n<p>é¦–å…ˆæœ€ç»ˆå¾—åˆ°çš„æ ‘çš„ç»“æ„æˆ‘å®šä¹‰å¦‚ä¸‹ã€‚</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">&#123;</div><div class=\"line\">  <span class=\"attr\">id</span>: xxx,</div><div class=\"line\">  <span class=\"attr\">name</span>: xxx,</div><div class=\"line\">  <span class=\"attr\">child</span>: &#123;...&#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>ç”±äºæ­¤é¢˜ä¸€çœ¼çœ‹å»åªæ˜¯ä¸ªå•é¡µæ ‘ï¼Œå°±å…¨å½“å•é¡µæ ‘å¤„ç†ï¼Œæš‚ä¸è€ƒè™‘å¤šå‰æ ‘çš„æƒ…å†µã€‚</p>\n<p>å…ˆå®ç°ä¸»å‡½æ•°ã€‚</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">main</span>(<span class=\"params\">parent, arr</span>) </span>&#123;</div><div class=\"line\">\t<span class=\"keyword\">let</span> child = arr.shift();</div><div class=\"line\">\t</div><div class=\"line\">\t<span class=\"keyword\">if</span>(!child) <span class=\"keyword\">return</span> parent;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"keyword\">if</span>(!child.parentId) &#123; <span class=\"comment\">// no parent, set as root.</span></div><div class=\"line\">\t\t<span class=\"keyword\">if</span>(!parent.id) &#123; <span class=\"comment\">// only one root.</span></div><div class=\"line\">\t\t\tparent = child;</div><div class=\"line\">\t\t&#125;</div><div class=\"line\">\t&#125; <span class=\"keyword\">else</span> &#123; <span class=\"comment\">// got a child.</span></div><div class=\"line\">\t\t<span class=\"keyword\">let</span> ok = setChild(parent, child);</div><div class=\"line\">\t\t<span class=\"keyword\">if</span>(!ok) &#123; <span class=\"comment\">// parent not found.</span></div><div class=\"line\">\t\t\t<span class=\"keyword\">if</span>(!ok) &#123;</div><div class=\"line\">\t\t\t\tarr.push(child);</div><div class=\"line\">\t\t\t&#125;</div><div class=\"line\">\t\t&#125;</div><div class=\"line\">\t&#125;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"keyword\">return</span> main(parent, arr);</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>ä¸»å‡½æ•°åŸºæœ¬å®ç°äº†æˆ‘è¯´çš„æ€è·¯ï¼Œé¦–å…ˆå°†æ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´ æå–å‡ºæ¥ï¼Œç„¶åå®šä¹‰ç»ˆæ­¢æ¡ä»¶ï¼ˆå³ï¼šæå–å…ƒç´ å¤±è´¥ï¼‰ï¼Œæ¥ç€æ ¹æ®æå–å‡ºçš„å…ƒç´ è®¾å®šä¸ºæ ¹å…ƒç´ ï¼ˆæ²¡æœ‰æ‰¾åˆ°parentIdï¼‰æˆ–è®¾å®šä¸ºå¶å­ï¼ˆæ‰¾åˆ°parentIdï¼‰ï¼Œç„¶åé€’å½’è°ƒç”¨è‡ªèº«ã€‚</p>\n<p>å…¶ä¸­setChildå‡½æ•°çš„å®ç°å¦‚ä¸‹ã€‚</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">setChild</span>(<span class=\"params\">parent, child</span>) </span>&#123;</div><div class=\"line\">\t<span class=\"keyword\">let</span> finded = <span class=\"literal\">false</span>; <span class=\"comment\">// flag.</span></div><div class=\"line\">\t<span class=\"keyword\">if</span>(parent.id === child.parentId) &#123;</div><div class=\"line\">\t\tparent.child = child;</div><div class=\"line\">\t\tfinded = <span class=\"literal\">true</span>;</div><div class=\"line\">\t&#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span>(parent.child) &#123;</div><div class=\"line\">\t\tfinded = setChild(parent.child, child);</div><div class=\"line\">\t&#125;</div><div class=\"line\">\t<span class=\"keyword\">return</span> finded;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>setChildåŒæ ·ä¹Ÿæ˜¯ç”¨é€’å½’å®ç°ï¼Œè¿”å›trueæˆ–falseè¡¨ç¤ºå­å…ƒç´ è®¾ç½®æˆåŠŸæˆ–å¤±è´¥ã€‚</p>\n<p>ä¸è¿‡ç°åœ¨å°è¯•è¿è¡Œ<code>main({}, testData)</code>ä¼šé€ æˆå†…å­˜æº¢å‡ºï¼Œå› ä¸ºi8å§‹ç»ˆæ‰¾ä¸åˆ°çˆ¶çº§ï¼Œä½¿å¾—é€’å½’æ°¸è¿œæ— æ³•ç»ˆæ­¢ã€‚æ‰€ä»¥æˆ‘ä»¬å¾—æ”¹é€ ä¸‹mainå‡½æ•°ï¼Œæ·»åŠ åˆé€‚çš„é”™è¯¯å¤„ç†ã€‚æ”¹é€ å¦‚ä¸‹ã€‚</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">main</span>(<span class=\"params\">parent, arr, depth</span>) </span>&#123;</div><div class=\"line\">\t<span class=\"keyword\">let</span> child = arr.shift();</div><div class=\"line\">\tdepth = depth || <span class=\"number\">0</span>;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"keyword\">if</span>(!child) <span class=\"keyword\">return</span> parent;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"keyword\">if</span>(!child.parentId) &#123; <span class=\"comment\">// no parent, set as root.</span></div><div class=\"line\">\t\t<span class=\"keyword\">if</span>(!parent.id) &#123; <span class=\"comment\">// only one root.</span></div><div class=\"line\">\t\t\tparent = child;</div><div class=\"line\">\t\t&#125;</div><div class=\"line\">\t&#125; <span class=\"keyword\">else</span> &#123; <span class=\"comment\">// got a child.</span></div><div class=\"line\">\t\t<span class=\"keyword\">let</span> ok = setChild(parent, child);</div><div class=\"line\">\t\t<span class=\"keyword\">if</span>(!ok) &#123; <span class=\"comment\">// parent not found.</span></div><div class=\"line\">\t\t\t<span class=\"keyword\">if</span>(depth &lt; <span class=\"number\">10</span>) &#123;</div><div class=\"line\">\t\t\t\tarr.push(child);</div><div class=\"line\">\t\t\t\tdepth++;</div><div class=\"line\">\t\t\t&#125; <span class=\"keyword\">else</span> &#123; <span class=\"comment\">// ending</span></div><div class=\"line\">\t\t\t\t<span class=\"built_in\">console</span>.log(<span class=\"string\">'These children have no parents: '</span>, arr.concat(child))</div><div class=\"line\">\t\t\t&#125;</div><div class=\"line\">\t\t&#125;</div><div class=\"line\">\t&#125;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"keyword\">return</span> main(parent, arr, ++depth);</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>æ›´æ–°åçš„mainå‡½æ•°åŠ ä¸Šäº†ç¬¬ä¸‰ä¸ªå‚æ•°depthï¼Œå¯é€‰ï¼Œä¸”åˆå§‹ä¸º0ï¼Œæ¯æ¬¡é€’å½’è‡ªå¢1ï¼Œ10æ¬¡é€’å½’åç»ˆæ­¢ï¼Œå¹¶æ‰“å°ä»æœªæ‰¾åˆ°çˆ¶çº§çš„å…ƒç´ ã€‚å®Œæˆåçš„ä»£ç è¿è¡Œ<code>console.log(main({}, data))</code>ï¼Œç»“æœå¦‚ä¸‹ã€‚</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\">These children have no parents:  [ &#123; <span class=\"attr\">id</span>: <span class=\"number\">8</span>, <span class=\"attr\">name</span>: <span class=\"string\">'i8'</span>, <span class=\"attr\">parentId</span>: <span class=\"number\">7</span> &#125; ]</div><div class=\"line\">&#123; <span class=\"attr\">id</span>: <span class=\"number\">1</span>,</div><div class=\"line\">  <span class=\"attr\">name</span>: <span class=\"string\">'i1'</span>,</div><div class=\"line\">  <span class=\"attr\">child</span>: </div><div class=\"line\">   &#123; <span class=\"attr\">id</span>: <span class=\"number\">2</span>,</div><div class=\"line\">     <span class=\"attr\">name</span>: <span class=\"string\">'i2'</span>,</div><div class=\"line\">     <span class=\"attr\">parentId</span>: <span class=\"number\">1</span>,</div><div class=\"line\">     <span class=\"attr\">child</span>: &#123; <span class=\"attr\">id</span>: <span class=\"number\">3</span>, <span class=\"attr\">name</span>: <span class=\"string\">'i3'</span>, <span class=\"attr\">parentId</span>: <span class=\"number\">2</span>, <span class=\"attr\">child</span>: [<span class=\"built_in\">Object</span>] &#125; &#125; &#125;</div></pre></td></tr></table></figure>\n<p>çœ‹æ ·å­æ ‘å·²ç»ç”Ÿæˆäº†ã€‚æœ€ååŠ ä¸Šä¸ªprintTreeå‡½æ•°ï¼Œæ ¼å¼åŒ–è¾“å‡ºã€‚</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">printTree</span>(<span class=\"params\">tree, depth</span>) </span>&#123;</div><div class=\"line\">\tdepth = depth || <span class=\"number\">0</span>;</div><div class=\"line\">\t<span class=\"keyword\">let</span> i = depth,</div><div class=\"line\">\t\tstr = <span class=\"string\">''</span>;</div><div class=\"line\">\t<span class=\"keyword\">while</span>(i--) &#123;</div><div class=\"line\">\t\tstr += <span class=\"string\">'--'</span></div><div class=\"line\">\t&#125;</div><div class=\"line\">\t<span class=\"built_in\">console</span>.log(str + <span class=\"string\">'name: '</span> + tree.name);</div><div class=\"line\">\t<span class=\"keyword\">if</span>(tree.child) &#123;</div><div class=\"line\">\t\tprintTree(tree.child, ++depth);</div><div class=\"line\">\t&#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>ç„¶åè¿è¡Œã€‚</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">let</span> tree = main(&#123;&#125;, data);</div><div class=\"line\">printTree(tree);</div></pre></td></tr></table></figure>\n<p>è¾“å‡ºã€‚</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">These children have no parents:  [ &#123; <span class=\"attr\">id</span>: <span class=\"number\">8</span>, <span class=\"attr\">name</span>: <span class=\"string\">'i8'</span>, <span class=\"attr\">parentId</span>: <span class=\"number\">7</span> &#125; ]</div><div class=\"line\">name: i1</div><div class=\"line\">--name: i2</div><div class=\"line\">----name: i3</div><div class=\"line\">------name: i4</div></pre></td></tr></table></figure>\n<p>è‡³æ­¤ï¼Œç”¨äº†ä¸‰ä¸ªé€’å½’å‡½æ•°ï¼Œå°½ç®¡å®ç°ä¸Šè¿˜æœ‰ä¸€äº›é—®é¢˜ï¼ˆé€’å½’æ·±åº¦æ§åˆ¶ï¼Œå¤šå‰æ ‘å…¼å®¹ç­‰ï¼‰ï¼Œæ­¤é¢˜ç®—æ˜¯è§£å‡ºæ¥äº†ã€‚</p>\n","excerpt":"","more":"<p>å¹´å‰å‘äº†ä¸ªæ±‚èŒè´´ï¼Œä¸€å‘¨ä»¥æ¥é™†ç»­æœ‰å¾ˆå¤šå…¬å¸å¯¹æˆ‘è¡¨ç¤ºæ„Ÿå…´è¶£ï¼Œé¢è¯•å’Œç¬”è¯•ä¹Ÿä¸å°‘ï¼Œå…¶ä¸­æœ‰é“ç¬”è¯•é¢˜å¤§æ¦‚æ˜¯è¿™æ ·çš„ã€‚</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\">æŠŠä»¥ä¸‹æ•°æ®ç»„æˆä¸ªæ ‘æ‰“å°å‡ºæ¥ï¼Œåƒnpm listå‘½ä»¤ä¸€æ ·ã€‚</div><div class=\"line\">let testData = [</div><div class=\"line\">    &#123;id:1, name: &apos;i1&apos;&#125;, </div><div class=\"line\">    &#123;id:2, name:&apos;i2&apos;, parentId: 1&#125;,</div><div class=\"line\">    &#123;id:4, name:&apos;i4&apos;, parentId: 3&#125;,</div><div class=\"line\">    &#123;id:3, name:&apos;i3&apos;, parentId: 2&#125;,</div><div class=\"line\">    &#123;id:8, name:&apos;i8&apos;, parentId: 7&#125;</div><div class=\"line\">]</div></pre></td></tr></table></figure>\n<p>ç¬”è¯•è¿‡ç¨‹ä¸ç´¯è¿°ï¼Œæ˜¯ä¸€å®¶æ¯”è¾ƒå–œæ¬¢çš„å…¬å¸ï¼Œè€Œå½“æ—¶æ¯”è¾ƒç´§å¼ ï¼Œæ—¶é—´ç´§è¿«ï¼Œåªå‘é¢è¯•å®˜é˜è¿°äº†æ€è·¯ï¼Œå‹‰å¼ºè¿‡å…³ï¼Œå´æ²¡æœ‰å†™å‡ºè‡ªå·±æ»¡æ„çš„ç­”æ¡ˆã€‚äº‹åæƒ³æƒ³å…¶å®è¿™é¢˜å¹¶ä¸éš¾ï¼Œè¿™é‡Œåšä¸ªç®€å•æ€»ç»“ï¼Œç­”æ¡ˆå¹¶ä¸ä¸€å®šæ˜¯æœ€å¥½çš„ã€‚</p>\n<p>ä¸€çœ¼æ³¨æ„åˆ°i8æ˜¯ä¸ªæ¸¸ç¦»åœ¨å¤–çš„å¶å­ï¼Œæ‰€ä»¥è¿˜è¦å¤„ç†ä¸åœ¨æ ‘å†…çš„æƒ…å†µï¼Œè¿™é‡Œåé¢å†è¯´åˆ°ã€‚è¿™é¢˜æœ€å¤§çš„é—®é¢˜æ˜¯i4è¿™ä¸ªå¶å­çš„çˆ¶çº§æ˜¯i3ï¼Œè‹¥æŒ‰é¡ºåºéå†çš„è¯i3è¿˜åœ¨i4ä¹‹åéå†åˆ°ï¼Œå°±æ— æ³•å°†i4æŒ‚åœ¨i3ä¸‹ã€‚å’Œé¢è¯•å®˜äº¤æµäº†ä¸‹ï¼Œç»™æˆ‘çš„æç¤ºæ˜¯ç”¨ä¸ªå…¨å±€ç¼“å­˜å°±å¥½äº†ï¼Œå½“æ—¶ä¹Ÿç¡®å®æ˜¯è¿™ä¹ˆåšçš„ï¼Œä½†æ€»è§‰å¾—åº”è¯¥æœ‰æ›´ä¼˜é›…çš„å¤„ç†åŠæ³•ã€‚</p>\n<p>å¯¹äºä¸Šè¿°é—®é¢˜æˆ‘ç°åœ¨çš„æ€è·¯æ˜¯ç”¨é€’å½’å³å¯ï¼Œå¯¹äºæ— æ³•æ‰¾åˆ°çˆ¶çº§çš„å¶å­å…ƒç´ ï¼Œæ”¾åˆ°éå†å¯¹è±¡çš„å°¾éƒ¨å†å¤„ç†ï¼Œå°±ä¸éœ€è¦å…¨å±€ç¼“å­˜äº†ã€‚</p>\n<p>ä¸‹é¢è¯´è¯´å®ç°ã€‚</p>\n<p>é¦–å…ˆæœ€ç»ˆå¾—åˆ°çš„æ ‘çš„ç»“æ„æˆ‘å®šä¹‰å¦‚ä¸‹ã€‚</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">&#123;</div><div class=\"line\">  <span class=\"attr\">id</span>: xxx,</div><div class=\"line\">  <span class=\"attr\">name</span>: xxx,</div><div class=\"line\">  <span class=\"attr\">child</span>: &#123;...&#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>ç”±äºæ­¤é¢˜ä¸€çœ¼çœ‹å»åªæ˜¯ä¸ªå•é¡µæ ‘ï¼Œå°±å…¨å½“å•é¡µæ ‘å¤„ç†ï¼Œæš‚ä¸è€ƒè™‘å¤šå‰æ ‘çš„æƒ…å†µã€‚</p>\n<p>å…ˆå®ç°ä¸»å‡½æ•°ã€‚</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">main</span>(<span class=\"params\">parent, arr</span>) </span>&#123;</div><div class=\"line\">\t<span class=\"keyword\">let</span> child = arr.shift();</div><div class=\"line\">\t</div><div class=\"line\">\t<span class=\"keyword\">if</span>(!child) <span class=\"keyword\">return</span> parent;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"keyword\">if</span>(!child.parentId) &#123; <span class=\"comment\">// no parent, set as root.</span></div><div class=\"line\">\t\t<span class=\"keyword\">if</span>(!parent.id) &#123; <span class=\"comment\">// only one root.</span></div><div class=\"line\">\t\t\tparent = child;</div><div class=\"line\">\t\t&#125;</div><div class=\"line\">\t&#125; <span class=\"keyword\">else</span> &#123; <span class=\"comment\">// got a child.</span></div><div class=\"line\">\t\t<span class=\"keyword\">let</span> ok = setChild(parent, child);</div><div class=\"line\">\t\t<span class=\"keyword\">if</span>(!ok) &#123; <span class=\"comment\">// parent not found.</span></div><div class=\"line\">\t\t\t<span class=\"keyword\">if</span>(!ok) &#123;</div><div class=\"line\">\t\t\t\tarr.push(child);</div><div class=\"line\">\t\t\t&#125;</div><div class=\"line\">\t\t&#125;</div><div class=\"line\">\t&#125;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"keyword\">return</span> main(parent, arr);</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>ä¸»å‡½æ•°åŸºæœ¬å®ç°äº†æˆ‘è¯´çš„æ€è·¯ï¼Œé¦–å…ˆå°†æ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´ æå–å‡ºæ¥ï¼Œç„¶åå®šä¹‰ç»ˆæ­¢æ¡ä»¶ï¼ˆå³ï¼šæå–å…ƒç´ å¤±è´¥ï¼‰ï¼Œæ¥ç€æ ¹æ®æå–å‡ºçš„å…ƒç´ è®¾å®šä¸ºæ ¹å…ƒç´ ï¼ˆæ²¡æœ‰æ‰¾åˆ°parentIdï¼‰æˆ–è®¾å®šä¸ºå¶å­ï¼ˆæ‰¾åˆ°parentIdï¼‰ï¼Œç„¶åé€’å½’è°ƒç”¨è‡ªèº«ã€‚</p>\n<p>å…¶ä¸­setChildå‡½æ•°çš„å®ç°å¦‚ä¸‹ã€‚</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">setChild</span>(<span class=\"params\">parent, child</span>) </span>&#123;</div><div class=\"line\">\t<span class=\"keyword\">let</span> finded = <span class=\"literal\">false</span>; <span class=\"comment\">// flag.</span></div><div class=\"line\">\t<span class=\"keyword\">if</span>(parent.id === child.parentId) &#123;</div><div class=\"line\">\t\tparent.child = child;</div><div class=\"line\">\t\tfinded = <span class=\"literal\">true</span>;</div><div class=\"line\">\t&#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span>(parent.child) &#123;</div><div class=\"line\">\t\tfinded = setChild(parent.child, child);</div><div class=\"line\">\t&#125;</div><div class=\"line\">\t<span class=\"keyword\">return</span> finded;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>setChildåŒæ ·ä¹Ÿæ˜¯ç”¨é€’å½’å®ç°ï¼Œè¿”å›trueæˆ–falseè¡¨ç¤ºå­å…ƒç´ è®¾ç½®æˆåŠŸæˆ–å¤±è´¥ã€‚</p>\n<p>ä¸è¿‡ç°åœ¨å°è¯•è¿è¡Œ<code>main({}, testData)</code>ä¼šé€ æˆå†…å­˜æº¢å‡ºï¼Œå› ä¸ºi8å§‹ç»ˆæ‰¾ä¸åˆ°çˆ¶çº§ï¼Œä½¿å¾—é€’å½’æ°¸è¿œæ— æ³•ç»ˆæ­¢ã€‚æ‰€ä»¥æˆ‘ä»¬å¾—æ”¹é€ ä¸‹mainå‡½æ•°ï¼Œæ·»åŠ åˆé€‚çš„é”™è¯¯å¤„ç†ã€‚æ”¹é€ å¦‚ä¸‹ã€‚</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">main</span>(<span class=\"params\">parent, arr, depth</span>) </span>&#123;</div><div class=\"line\">\t<span class=\"keyword\">let</span> child = arr.shift();</div><div class=\"line\">\tdepth = depth || <span class=\"number\">0</span>;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"keyword\">if</span>(!child) <span class=\"keyword\">return</span> parent;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"keyword\">if</span>(!child.parentId) &#123; <span class=\"comment\">// no parent, set as root.</span></div><div class=\"line\">\t\t<span class=\"keyword\">if</span>(!parent.id) &#123; <span class=\"comment\">// only one root.</span></div><div class=\"line\">\t\t\tparent = child;</div><div class=\"line\">\t\t&#125;</div><div class=\"line\">\t&#125; <span class=\"keyword\">else</span> &#123; <span class=\"comment\">// got a child.</span></div><div class=\"line\">\t\t<span class=\"keyword\">let</span> ok = setChild(parent, child);</div><div class=\"line\">\t\t<span class=\"keyword\">if</span>(!ok) &#123; <span class=\"comment\">// parent not found.</span></div><div class=\"line\">\t\t\t<span class=\"keyword\">if</span>(depth &lt; <span class=\"number\">10</span>) &#123;</div><div class=\"line\">\t\t\t\tarr.push(child);</div><div class=\"line\">\t\t\t\tdepth++;</div><div class=\"line\">\t\t\t&#125; <span class=\"keyword\">else</span> &#123; <span class=\"comment\">// ending</span></div><div class=\"line\">\t\t\t\t<span class=\"built_in\">console</span>.log(<span class=\"string\">'These children have no parents: '</span>, arr.concat(child))</div><div class=\"line\">\t\t\t&#125;</div><div class=\"line\">\t\t&#125;</div><div class=\"line\">\t&#125;</div><div class=\"line\"></div><div class=\"line\">\t<span class=\"keyword\">return</span> main(parent, arr, ++depth);</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>æ›´æ–°åçš„mainå‡½æ•°åŠ ä¸Šäº†ç¬¬ä¸‰ä¸ªå‚æ•°depthï¼Œå¯é€‰ï¼Œä¸”åˆå§‹ä¸º0ï¼Œæ¯æ¬¡é€’å½’è‡ªå¢1ï¼Œ10æ¬¡é€’å½’åç»ˆæ­¢ï¼Œå¹¶æ‰“å°ä»æœªæ‰¾åˆ°çˆ¶çº§çš„å…ƒç´ ã€‚å®Œæˆåçš„ä»£ç è¿è¡Œ<code>console.log(main({}, data))</code>ï¼Œç»“æœå¦‚ä¸‹ã€‚</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\">These children have no parents:  [ &#123; <span class=\"attr\">id</span>: <span class=\"number\">8</span>, <span class=\"attr\">name</span>: <span class=\"string\">'i8'</span>, <span class=\"attr\">parentId</span>: <span class=\"number\">7</span> &#125; ]</div><div class=\"line\">&#123; <span class=\"attr\">id</span>: <span class=\"number\">1</span>,</div><div class=\"line\">  <span class=\"attr\">name</span>: <span class=\"string\">'i1'</span>,</div><div class=\"line\">  <span class=\"attr\">child</span>: </div><div class=\"line\">   &#123; <span class=\"attr\">id</span>: <span class=\"number\">2</span>,</div><div class=\"line\">     <span class=\"attr\">name</span>: <span class=\"string\">'i2'</span>,</div><div class=\"line\">     <span class=\"attr\">parentId</span>: <span class=\"number\">1</span>,</div><div class=\"line\">     <span class=\"attr\">child</span>: &#123; <span class=\"attr\">id</span>: <span class=\"number\">3</span>, <span class=\"attr\">name</span>: <span class=\"string\">'i3'</span>, <span class=\"attr\">parentId</span>: <span class=\"number\">2</span>, <span class=\"attr\">child</span>: [<span class=\"built_in\">Object</span>] &#125; &#125; &#125;</div></pre></td></tr></table></figure>\n<p>çœ‹æ ·å­æ ‘å·²ç»ç”Ÿæˆäº†ã€‚æœ€ååŠ ä¸Šä¸ªprintTreeå‡½æ•°ï¼Œæ ¼å¼åŒ–è¾“å‡ºã€‚</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">printTree</span>(<span class=\"params\">tree, depth</span>) </span>&#123;</div><div class=\"line\">\tdepth = depth || <span class=\"number\">0</span>;</div><div class=\"line\">\t<span class=\"keyword\">let</span> i = depth,</div><div class=\"line\">\t\tstr = <span class=\"string\">''</span>;</div><div class=\"line\">\t<span class=\"keyword\">while</span>(i--) &#123;</div><div class=\"line\">\t\tstr += <span class=\"string\">'--'</span></div><div class=\"line\">\t&#125;</div><div class=\"line\">\t<span class=\"built_in\">console</span>.log(str + <span class=\"string\">'name: '</span> + tree.name);</div><div class=\"line\">\t<span class=\"keyword\">if</span>(tree.child) &#123;</div><div class=\"line\">\t\tprintTree(tree.child, ++depth);</div><div class=\"line\">\t&#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<p>ç„¶åè¿è¡Œã€‚</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">let</span> tree = main(&#123;&#125;, data);</div><div class=\"line\">printTree(tree);</div></pre></td></tr></table></figure>\n<p>è¾“å‡ºã€‚</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">These children have no parents:  [ &#123; <span class=\"attr\">id</span>: <span class=\"number\">8</span>, <span class=\"attr\">name</span>: <span class=\"string\">'i8'</span>, <span class=\"attr\">parentId</span>: <span class=\"number\">7</span> &#125; ]</div><div class=\"line\">name: i1</div><div class=\"line\">--name: i2</div><div class=\"line\">----name: i3</div><div class=\"line\">------name: i4</div></pre></td></tr></table></figure>\n<p>è‡³æ­¤ï¼Œç”¨äº†ä¸‰ä¸ªé€’å½’å‡½æ•°ï¼Œå°½ç®¡å®ç°ä¸Šè¿˜æœ‰ä¸€äº›é—®é¢˜ï¼ˆé€’å½’æ·±åº¦æ§åˆ¶ï¼Œå¤šå‰æ ‘å…¼å®¹ç­‰ï¼‰ï¼Œæ­¤é¢˜ç®—æ˜¯è§£å‡ºæ¥äº†ã€‚</p>\n"}],"PostAsset":[],"PostCategory":[],"PostTag":[],"Tag":[]}}